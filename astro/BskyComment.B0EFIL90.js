import{p as je,c as tt,i as R,s as I,e as $e,a as at,o as rt,b as st}from"./props.CL67senT.js";import{h as De,E as ot,F as nt,G as Fe,I as it,S as lt,J as ct,K as dt,w as Ie,L as Oe,M as pt,A as e,N as ut,O as vt,P as ft,q as He,t as x,x as te,l,r as i,m as h,Q as M,n as U,R as pe,o as j,D as Z,p as y,y as Me,z as C,B as xe,T as we,U as ht,C as Te}from"./render.Btt0sWqP.js";import{c as mt,g as Pe,O as gt,d as Ve,a as yt,L as bt,C as wt,W as xt,P as _t,X as kt,b as Ct}from"./xrpc.BTJAN-gF.js";function St(s,a){return s==null?null:String(s)}function Rt(s,a,t,r){var c=s.__style;if(De||c!==a){var d=St(a);(!De||d!==s.getAttribute("style"))&&(d==null?s.removeAttribute("style"):s.style.cssText=d),s.__style=a}return r}function Ue(s,a){return s===a||s?.[lt]===a}function jt(s={},a,t,r){return ot(()=>{var c,d;return nt(()=>{c=d,d=[],Fe(()=>{s!==t(...d)&&(a(s,...d),c&&Ue(t(...c),s)&&a(null,...c))})}),()=>{it(()=>{d&&Ue(t(...d),s)&&a(null,...d)})}}),s}function $t(s){return function(...a){var t=a[0];return t.stopPropagation(),s?.apply(this,a)}}function We(s=!1){const a=ct,t=a.l.u;if(!t)return;let r=()=>ut(a.s);if(s){let c=0,d={};const o=vt(()=>{let _=!1;const w=a.s;for(const S in w)w[S]!==d[S]&&(d[S]=w[S],_=!0);return _&&c++,c});r=()=>e(o)}t.b.length&&dt(()=>{Ne(a,r),Oe(t.b)}),Ie(()=>{const c=Fe(()=>t.m.map(pt));return()=>{for(const d of c)typeof d=="function"&&d()}}),t.a.length&&Ie(()=>{Ne(a,r),Oe(t.a)})}function Ne(s,a){if(s.l.s)for(const t of s.l.s)e(t);a()}ft();const Pt=s=>typeof s=="object"?s.handle.bind(s):s,Ee=/\bapplication\/json\b/;class ue{handler;proxy;constructor({handler:a,proxy:t=null}){this.handler=Pt(a),this.proxy=t}clone({handler:a=this.handler,proxy:t=this.proxy}={}){return new ue({handler:a,proxy:t})}get(a,t={}){return this.#e("get",a,t)}post(a,t={}){return this.#e("post",a,t)}async call(a,t={}){}async#e(a,t,{signal:r,as:c="json",headers:d,input:o,params:_}){const w=o&&(o instanceof Blob||ArrayBuffer.isView(o)||o instanceof ArrayBuffer||o instanceof ReadableStream),S=`/xrpc/${t}`+Lt(_),$=await this.handler(S,{method:a,signal:r,body:o&&!w?JSON.stringify(o):o,headers:Bt(d,{"content-type":o&&!w?"application/json":null,"atproto-proxy":At(this.proxy)}),duplex:o instanceof ReadableStream?"half":void 0});{const T=$.status,W=$.headers,O=W.get("content-type");if(T!==200){let P;if(O!=null&&Ee.test(O))try{const V=await $.json();Dt(V)&&(P=V)}catch{}else await $.body?.cancel();return{ok:!1,status:T,headers:W,data:P??{error:"UnknownXRPCError",message:`Request failed with status code ${T}`}}}{let P;switch(c){case"json":{if(O!=null&&Ee.test(O))P=await $.json();else throw await $.body?.cancel(),new TypeError(`Invalid response content-type (got ${O})`);break}case null:{P=null,await $.body?.cancel();break}case"blob":{P=await $.blob();break}case"bytes":{P=new Uint8Array(await $.arrayBuffer());break}case"stream":{P=$.body;break}}return{ok:!0,status:T,headers:W,data:P}}}}}const Lt=s=>{let a;for(const t in s){const r=s[t];if(r!==void 0)if(a??=new URLSearchParams,Array.isArray(r))for(let c=0,d=r.length;c<d;c++){const o=r[c];a.append(t,""+o)}else a.set(t,""+r)}return a?"?"+a.toString():""},At=s=>s!=null?`${s.did}${s.serviceId}`:null,Bt=(s,a)=>{let t;for(const r in a){const c=a[r];c!==null&&(t??=new Headers(s),t.has(r)||t.set(r,c))}return t??s},Dt=s=>{if(typeof s!="object"||s==null)return!1;const a=typeof s.error,t=typeof s.message;return a==="string"&&(t==="undefined"||t==="string")},de=s=>{if(s instanceof Promise)return s.then(de);if(s.ok)return s.data;throw new It(s)};class It extends Error{error;description;status;headers;constructor({status:a,headers:t=new Headers,data:r}){super(`${r.error} > ${r.message??"(unspecified description)"}`),this.name="ClientResponseError",this.error=r.error,this.description=r.message,this.status=a,this.headers=t}}class ze{session;#e;#t;constructor(a){this.session=a,this.#e=mt(a.dpopKey,!1)}get sub(){return this.session.info.sub}getSession(a){const t=Pe(this.session.info.sub,a);return t.then(r=>{this.session=r}).finally(()=>{this.#t=void 0}),this.#t=t}async signOut(){const a=this.session.info.sub;try{const{dpopKey:t,info:r,token:c}=await Pe(a,{allowStale:!0});await new gt(r.server,t).revoke(c.refresh??c.access)}finally{Ve(a)}}async handle(a,t){await this.#t;const r=new Headers(t?.headers);let c=this.session,d=new URL(a,c.info.aud);r.set("authorization",`${c.token.type} ${c.token.access}`);let o=await this.#e(d.href,{...t,headers:r});if(!Ot(o))return o;try{this.#t?c=await this.#t:c=await this.getSession()}catch{return o}return t?.body instanceof ReadableStream?o:(d=new URL(a,c.info.aud),r.set("authorization",`${c.token.type} ${c.token.access}`),await this.#e(d.href,{...t,headers:r}))}}const Ot=s=>{if(s.status!==401)return!1;const a=s.headers.get("www-authenticate");return a!=null&&(a.startsWith("Bearer ")||a.startsWith("DPoP "))&&a.includes('error="invalid_token"')};var Tt=x('<button class="block overflow-hidden border border-outline/20 cursor-zoom-in text-left w-full h-full"><img class="w-full h-full object-cover max-h-[300px]" loading="lazy"></button>'),Ut=x('<div class="mt-2 grid gap-2"></div>'),Nt=x('<div class="ml-4 pl-4 border-l-2 border-outline/20 space-y-2"></div>'),Et=x('<div class="relative w-screen h-screen flex items-center justify-center p-4"><img alt="Zoomed view" class="max-w-full max-h-full object-contain shadow-2xl"> <button aria-label="Close Zoom" class="absolute top-4 right-4 text-white bg-black/50 p-2 rounded-full hover:bg-black/80 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>'),zt=x('<div class="flex flex-col gap-2"><div class="flex gap-4 p-4 hover:bg-surface-variant/30 transition-colors"><a target="_blank" rel="noopener noreferrer"><img class="w-10 h-10 object-cover rounded-full"></a> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1 flex-wrap"><span class="font-bold text-on-surface truncate"> </span> <a target="_blank" rel="noopener noreferrer" class="text-sm text-secondary truncate hover:underline"> </a> <span class="text-xs text-outline">•</span> <a target="_blank" rel="noopener noreferrer" class="text-xs text-secondary hover:underline"> </a></div> <div class="text-on-surface/90 whitespace-pre-wrap break-words text-sm leading-relaxed"> </div> <!> <div class="mt-3 flex gap-6"><button class="flex items-center gap-1.5 text-xs font-medium text-secondary hover:text-primary transition-colors bg-transparent p-0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#888888" d="M5.763 17H20V5H4v13.385zm.692 2L2 22.5V4a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1z"></path></svg> </button> <div class="flex items-center gap-1.5 text-xs text-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#888888" d="M16.5 3C19.538 3 22 5.5 22 9c0 7-7.5 11-10 12.5C9.5 20 2 16 2 9c0-3.5 2.5-6 5.5-6C9.36 3 11 4 12 5c1-1 2.64-2 4.5-2m-3.566 15.604a27 27 0 0 0 2.42-1.701C18.335 14.533 20 11.943 20 9c0-2.36-1.537-4-3.5-4c-1.076 0-2.24.57-3.086 1.414L12 7.828l-1.414-1.414C9.74 5.57 8.576 5 7.5 5C5.56 5 4 6.657 4 9c0 2.944 1.666 5.533 4.645 7.903c.745.593 1.54 1.146 2.421 1.7c.299.189.595.37.934.572c.339-.202.635-.383.934-.571"></path></svg> </div></div></div></div> <!></div> <dialog class="backdrop:bg-black/90 bg-transparent p-0 m-auto max-w-screen max-h-screen overflow-hidden outline-none svelte-1hco0ix"><!></dialog>',1);function qe(s,a){He(a,!1);let t=je(a,"comment",8),r=je(a,"depth",8,0);const c=tt();function d(v){return new Date(v).toLocaleString()}function o(){c("reply",{post:t().post})}function _(v){c("reply",v.detail)}let w=M(),S=M(null);function $(v){C(S,v),e(w).showModal()}function T(){e(w).close(),C(S,null)}We();var W=zt(),O=te(W),P=l(O),V=l(P),L=l(V);i(V);var ve=h(V,2),ae=l(ve),re=l(ae),se=l(re,!0);i(re);var q=h(re,2),fe=l(q);i(q);var K=h(q,4),_e=l(K,!0);i(K),i(ae);var oe=h(ae,2),ke=l(oe,!0);i(oe);var he=h(oe,2);{var Ce=v=>{var b=Ut();$e(b,5,()=>t().post.embed.images,at,(B,z)=>{var F=Tt(),Y=l(F);i(F),U(()=>{I(Y,"src",e(z).thumb),I(Y,"alt",e(z).alt)}),Z("click",F,()=>$(e(z).fullsize)),y(B,F)}),i(b),U(B=>Rt(b,B),[()=>`grid-template-columns: repeat(${Math.min(t().post.embed.images.length,2)}, 1fr)`],pe),y(v,b)};R(he,v=>{t().post.embed&&t().post.embed.$type==="app.bsky.embed.images#view"&&v(Ce)})}var me=h(he,2),G=l(me),n=h(l(G));i(G);var p=h(G,2),m=h(l(p));i(p),i(me),i(ve),i(P);var g=h(P,2);{var f=v=>{var b=Nt();$e(b,5,()=>t().replies,B=>B.post.uri,(B,z)=>{var F=xe(),Y=te(F);{var Se=ne=>{var D=xe(),H=te(D);const Q=pe(()=>r()+1);qe(H,{get comment(){return e(z)},get depth(){return e(Q)},$$events:{reply:_}}),y(ne,D)};R(Y,ne=>{e(z).$type==="app.bsky.feed.defs#threadViewPost"&&ne(Se)})}y(B,F)}),i(b),y(v,b)};R(g,v=>{t().replies&&t().replies.length>0&&v(f)})}i(O);var u=h(O,2),N=l(u);{var E=v=>{var b=Et(),B=l(b),z=h(B,2);i(b),U(()=>I(B,"src",e(S))),Z("click",z,$t(T)),y(v,b)};R(N,v=>{e(S)&&v(E)})}i(u),jt(u,v=>C(w,v),()=>e(w)),U((v,b)=>{I(V,"href",`https://bsky.app/profile/${t().post.author.handle}`),I(L,"src",t().post.author.avatar||"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"),I(L,"alt",t().post.author.handle),j(se,t().post.author.displayName||t().post.author.handle),I(q,"href",`https://bsky.app/profile/${t().post.author.handle}`),j(fe,`@${t().post.author.handle??""}`),I(K,"href",v),j(_e,b),j(ke,t().post.record.text),j(n,` ${t().post.replyCount||0}`),j(m,` ${t().post.likeCount||0}`)},[()=>`https://bsky.app/profile/${t().post.author.handle}/post/${t().post.uri.split("/").pop()}`,()=>d(t().post.record.createdAt)],pe),Z("click",G,o),Z("click",u,T),y(s,W),Me()}var Ft=x('<div class="flex items-center gap-1 text-sm"><a target="_blank" rel="noopener noreferrer" class="underline flex items-center justify-center gap-2"><span>View thread</span></a> · <span class="flex items-center gap-1"> </span> · <span class="flex items-center gap-1"> </span></div>'),Ht=x('<div class="flex items-center justify-between gap-4 p-4 border border-outline/20 bg-surface-variant/10"><div class="flex items-center gap-3"><img class="w-10 h-10 object-cover rounded-full"> <div class="flex flex-col"><span class="font-bold text-sm"> </span> <span class="text-xs text-secondary"> </span></div></div> <button class="text-sm px-3 py-1.5 border border-outline/30 hover:bg-surface-variant/20 transition-colors">Logout</button></div>'),Mt=x('<button class="w-full sm:w-auto bg-primary text-on-primary px-6 py-2.5 font-medium transition-transform active:scale-95 flex items-center justify-center gap-2"><span>Login with Bluesky to comment</span> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-80"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line></svg></button>'),Vt=x('<button disabled class="w-full sm:w-auto bg-surface-variant text-on-surface/50 px-6 py-2.5 font-medium cursor-not-allowed flex items-center justify-center gap-2"><span>Login unavailable (Domain mismatch)</span></button>'),Wt=x('<div class="py-12 flex justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),qt=x('<div class="bg-error/10 text-error p-4 flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg> <span> </span></div>'),Jt=x('<div class="flex items-center justify-between text-sm bg-surface-variant/20 px-3 py-2 border-l-4 border-primary"><span class="text-secondary">Replying to <span class="font-bold text-on-surface"> </span></span> <button class="p-1 hover:bg-surface-variant" aria-label="Cancel reply"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>'),Xt=x('<span class="text-xs text-secondary"> </span>'),Zt=x('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> <span>Posting...</span>',1),Kt=x('<span> </span> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>',1),Gt=x('<div class="space-y-2"><!> <div class="relative"><textarea class="w-full bg-surface-variant/5 border border-outline/20 p-4 focus:ring-1 focus:ring-primary/50 focus:border-primary outline-none transition-all resize-none min-h-[120px] text-on-surface placeholder:text-secondary/50"></textarea> <div class="flex justify-between mt-2 items-center gap-3"><div class="flex items-center gap-1 text-sm"><a target="_blank" rel="noopener noreferrer" class="underline flex items-center justify-center gap-2"><span>View thread</span></a> · <span class="flex items-center gap-1"> </span> · <span class="flex items-center gap-1"> </span></div> <div><!> <button class="bg-primary hover:bg-primary-hover text-on-primary px-6 py-2 font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2"><!></button></div></div></div></div>'),Yt=x('<div class="text-center py-12"><p>No comments yet. Be the first to share your thoughts!</p></div>'),Qt=x('<div class="space-y-6"><!> <div class="space-y-4"><!></div></div>'),ea=x('<p class="text-center opacity-50 py-8">No comment thread found for this post.</p>'),ta=x('<div><div class="mb-6"><div class="gap-4 flex justify-between"><!> <!></div></div> <!></div>');function oa(s,a){He(a,!1);let t=je(a,"at_uri",8),r=M(null),c=M(!0),d=M(null),o=M(null),_=null,w=M(""),S=M(!1),$=M(!1);const T={"kururin.cc":{metadata:"https://kururin.cc/bsky-oauth-kururin.json",redirect:"https://kururin.cc/oauth/callback"},"icealtria.github.io":{metadata:"https://icealtria.github.io/bsky-oauth.json",redirect:"https://icealtria.github.io/oauth/callback"}};async function W(){try{const n=window.location.hostname,p=T[n]||T.localhost;!T[n]&&n!=="localhost"&&!n.endsWith(".ts.net")&&console.warn("Unknown domain for OAuth:",n),p&&(yt({metadata:{client_id:p.metadata,redirect_uri:p.redirect},identityResolver:new bt({handleResolver:new kt({serviceUrl:"https://public.api.bsky.app"}),didDocumentResolver:new wt({methods:{plc:new _t,web:new xt}})})}),C($,!0));let m=localStorage.getItem("bsky_last_did");if(!m)try{const g=localStorage.getItem("atcute-oauth:sessions");if(g){const f=JSON.parse(g),u=Object.keys(f);u.length>0&&(m=u[0],localStorage.setItem("bsky_last_did",m))}}catch(g){console.warn("Failed to parse sessions storage",g)}if(m)try{C(o,await Pe(m,{allowStale:!0})),console.log("[Init] Session resumed, creating agent...");const g=new ze(e(o));_=new ue({handler:g});const f=await de(_.get("com.atproto.server.getSession"));console.log("[Init] User profile loaded:",f);try{const u=await de(_.get("app.bsky.actor.getProfile",{params:{actor:f.did}}));we(o,e(o).avatar=u.avatar),we(o,e(o).displayName=u.displayName)}catch(u){console.warn("Failed to fetch full profile",u)}we(o,e(o).did=f.did),we(o,e(o).handle=f.handle)}catch(g){console.warn("Failed to resume session or fetch profile",g),localStorage.removeItem("bsky_last_did"),C(o,null),_=null}_||(_=new ue({handler:(g,f)=>{const u=new URL(g,"https://public.api.bsky.app");return fetch(u,f)}})),await O()}catch(n){C(d,n.message)}finally{C(c,!1)}}async function O(){if(!(!t()||!_))try{const n=await de(_.get("app.bsky.feed.getPostThread",{params:{uri:t()}}));C(r,n.thread)}catch(n){console.error(n),n.error!=="NotFound"&&C(d,"Failed to load comments: "+n.message)}}async function P(){const n=window.prompt("Enter your Bluesky handle (e.g. user.bsky.social):");if(n)try{localStorage.setItem("oauth_return_path",window.location.href);const p=await Ct({target:{type:"account",identifier:n},scope:"atproto"});await new Promise(m=>setTimeout(m,500)),window.location.assign(p)}catch(p){alert("Login failed: "+p.message)}}async function V(){if(e(o)){try{await new ze(e(o)).signOut()}catch(n){console.warn("Sign out failed",n)}Ve(e(o).did),localStorage.removeItem("bsky_last_did"),C(o,null),_=new ue({handler:(n,p)=>{const m=new URL(n,"https://public.api.bsky.app");return fetch(m,p)}})}}let L=M(null);function ve(n){C(L,n.detail.post);const p=document.querySelector("textarea");p&&(p.focus(),p.scrollIntoView({behavior:"smooth",block:"center"}))}function ae(){C(L,null)}async function re(){if(!e(o)||!_||!e(r)||!e(w).trim())return;let n={uri:e(r).post.uri,cid:e(r).post.cid},p={uri:e(r).post.uri,cid:e(r).post.cid};e(L)&&(p={uri:e(L).uri,cid:e(L).cid}),C(S,!0);try{const m=e(o).did||e(o).sub;if(!m)throw new Error("User DID not found in session");await de(_.post("com.atproto.repo.createRecord",{input:{repo:m,collection:"app.bsky.feed.post",record:{$type:"app.bsky.feed.post",text:e(w),createdAt:new Date().toISOString(),reply:{root:n,parent:p}}}})),C(w,""),C(L,null),await O()}catch(m){alert("Failed to post: "+m.message)}finally{C(S,!1)}}rt(()=>{new URLSearchParams(window.location.hash.slice(1)).has("code"),W()}),We();var se=ta(),q=l(se),fe=l(q),K=l(fe);{var _e=n=>{var p=Ft(),m=l(p),g=h(m,2),f=l(g,!0);i(g);var u=h(g,2),N=l(u,!0);i(u),i(p),U(E=>{I(m,"href",`https://bsky.app/profile/${e(r).post.author.did??""}/post/${E??""}`),j(f,e(r).post.replyCount>1?`${e(r).post.replyCount} Comments`:`${e(r).post.replyCount} Comment`),j(N,e(r).post.likeCount>1?`${e(r).post.likeCount} Likes`:`${e(r).post.likeCount} Like`)},[()=>e(r).post.uri.split("/").pop()],pe),y(n,p)};R(K,n=>{e(r)&&!e(o)&&n(_e)})}var oe=h(K,2);{var ke=n=>{var p=Ht(),m=l(p),g=l(m),f=h(g,2),u=l(f),N=l(u,!0);i(u);var E=h(u,2),v=l(E);i(E),i(f),i(m);var b=h(m,2);i(p),U(()=>{I(g,"src",e(o).avatar||"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"),I(g,"alt",e(o).handle),j(N,e(o).displayName||e(o).handle),j(v,`@${e(o).handle??""}`)}),Z("click",b,V),y(n,p)},he=(n,p)=>{{var m=f=>{var u=Mt();Z("click",u,P),y(f,u)},g=f=>{var u=Vt();y(f,u)};R(n,f=>{e($)?f(m):f(g,!1)},p)}};R(oe,n=>{e(o)?n(ke):n(he,!1)})}i(fe),i(q);var Ce=h(q,2);{var me=n=>{var p=Wt();y(n,p)},G=(n,p)=>{{var m=f=>{var u=qt(),N=h(l(u),2),E=l(N,!0);i(N),i(u),U(()=>j(E,e(d))),y(f,u)},g=(f,u)=>{{var N=v=>{var b=Qt(),B=l(b);{var z=D=>{var H=Gt(),Q=l(H);{var ie=k=>{var A=Jt(),X=l(A),be=h(l(X)),Qe=l(be);i(be),i(X);var et=h(X,2);i(A),U(()=>j(Qe,`@${e(L).author.handle??""}`)),Z("click",et,ae),y(k,A)};R(Q,k=>{e(L)&&k(ie)})}var le=h(Q,2),J=l(le);ht(J);var ge=h(J,2),ce=l(ge),ee=l(ce),Re=h(ee,2),Je=l(Re,!0);i(Re);var Le=h(Re,2),Xe=l(Le,!0);i(Le),i(ce);var Ae=h(ce,2),Be=l(Ae);{var Ze=k=>{var A=Xt(),X=l(A);i(A),U(()=>j(X,`${e(w).length??""} chars`)),y(k,A)};R(Be,k=>{e(w).length>0&&k(Ze)})}var ye=h(Be,2),Ke=l(ye);{var Ge=k=>{var A=Zt();Te(2),y(k,A)},Ye=k=>{var A=Kt(),X=te(A),be=l(X);i(X),Te(2),U(()=>j(be,`Post ${(e(L)?"Reply":"Comment")??""}`)),y(k,A)};R(Ke,k=>{e(S)?k(Ge):k(Ye,!1)})}i(ye),i(Ae),i(ge),i(le),i(H),U((k,A)=>{I(J,"placeholder",e(L)?`Reply to @${e(L).author.handle}...`:"Write a comment..."),J.disabled=e(S),I(ee,"href",`https://bsky.app/profile/${e(r).post.author.did??""}/post/${k??""}`),j(Je,e(r).post.replyCount>1?`${e(r).post.replyCount} Comments`:`${e(r).post.replyCount} Comment`),j(Xe,e(r).post.likeCount>1?`${e(r).post.likeCount} Likes`:`${e(r).post.likeCount} Like`),ye.disabled=A},[()=>e(r).post.uri.split("/").pop(),()=>e(S)||!e(w).trim()],pe),st(J,()=>e(w),k=>C(w,k)),Z("click",ye,re),y(D,H)};R(B,D=>{e(o)&&D(z)})}var F=h(B,2),Y=l(F);{var Se=D=>{var H=Yt();y(D,H)},ne=D=>{var H=xe(),Q=te(H);$e(Q,1,()=>e(r).replies,ie=>ie.post.uri,(ie,le)=>{var J=xe(),ge=te(J);{var ce=ee=>{qe(ee,{get comment(){return e(le)},$$events:{reply:ve}})};R(ge,ee=>{e(le).$type==="app.bsky.feed.defs#threadViewPost"&&ee(ce)})}y(ie,J)}),y(D,H)};R(Y,D=>{!e(r).replies||e(r).replies.length===0?D(Se):D(ne,!1)})}i(F),i(b),y(v,b)},E=v=>{var b=ea();y(v,b)};R(f,v=>{e(r)?v(N):v(E,!1)},u)}};R(n,f=>{e(d)?f(m):f(g,!1)},p)}};R(Ce,n=>{e(c)?n(me):n(G,!1)})}i(se),y(s,se),Me()}export{oa as default};
