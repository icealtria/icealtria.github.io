import{e as Vc,b as Z1,h as Tr,a as js,E as Zc,H as Yc,r as Jc,s as Y1,c as ro,d as no,f as Vs,p as io,g as Zs,U as Wc,i as Xc,j as t0,k as e0,l as so,m as r0,n as n0,o as i0,q as s0,L as a0,t as o0,u as c0,v as l0,w as Ys,x as mi,y as Ki,z as ao,A as oe,B as h0,C as u0,D as Js,F as J1,G as f0,I as g0,J as y0,R as p0,K as oo,P as d0,M as A0,S as w0,N as b0,O as m0,Q as co,T as E0,V as k0,W as B0,X as I0,Y as v0,Z as en,_ as S0,$ as C0,a0 as Pi,a1 as W1,a2 as Di,a3 as X1,a4 as t3,a5 as Ei,a6 as e3,a7 as r3,a8 as x0,a9 as lo,aa as gs,ab as U0,ac as ys,ad as K0}from"./render.BG-VAdj1.js";/* empty css                      */const P0="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(P0);Vc();function D0(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ho=!1;function Q0(){ho||(ho=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const t of n.target.elements)t.__on_r?.()})},{capture:!0}))}function R0(n,t,e=!1){Tr&&js();var r=n,i=null,s=null,a=Wc,o=e?Zc:0,c=!1;const h=(u,g=!0)=>{c=!0,l(g,u)},l=(u,g)=>{if(a===(a=u))return;let y=!1;if(Tr){const A=r.data===Yc;!!a===A&&(r=Jc(),Y1(r),ro(!1),y=!0)}a?(i?no(i):g&&(i=Vs(()=>g(r))),s&&io(s,()=>{s=null})):(s?no(s):g&&(s=Vs(()=>g(r))),i&&io(i,()=>{i=null})),y&&ro(!0)};Z1(()=>{c=!1,t(h),c||l(null,null)},o),Tr&&(r=Zs)}function _0(n,t,e,r,i){var s=n,a="",o;Z1(()=>{if(a===(a=t()??"")){Tr&&js();return}o!==void 0&&(i0(o),o=void 0),a!==""&&(o=Vs(()=>{if(Tr){Zs.data;for(var c=js(),h=c;c!==null&&(c.nodeType!==8||c.data!=="");)h=c,c=Xc(c);if(c===null)throw t0(),e0;so(Zs,h),s=Y1(c);return}var l=a+"",u=r0(l);so(n0(u),u.lastChild),s.before(u)}))})}function T0(n){if(Tr){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var r=n.value;Ws(n,"value",null),n.value=r}if(n.hasAttribute("checked")){var i=n.checked;Ws(n,"checked",null),n.checked=i}}};n.__on_r=e,s0(e),Q0()}}function L0(n,t){var e=n.__attributes??={};e.value===(e.value=t??void 0)||n.value===t&&(t!==0||n.nodeName!=="PROGRESS")||(n.value=t)}function Ws(n,t,e,r){var i=n.__attributes??={};Tr&&(i[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||i[t]!==(i[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[a0]=e),e==null?n.removeAttribute(t):typeof e!="string"&&M0(n).includes(t)?n[t]=e:n.setAttribute(t,e))}var uo=new Map;function M0(n){var t=uo.get(n.nodeName);if(t)return t;uo.set(n.nodeName,t=[]);for(var e,r=n,i=Element.prototype;i!==r;){e=c0(r);for(var s in e)e[s].set&&t.push(s);r=o0(r)}return t}function N0(n){return function(...t){var e=t[0];return e.preventDefault(),n?.apply(this,t)}}function z0(n=!1){const t=mi,e=t.l.u;if(!e)return;let r=()=>u0(t.s);if(n){let i=0,s={};const a=Js(()=>{let o=!1;const c=t.s;for(const h in c)c[h]!==s[h]&&(s[h]=c[h],o=!0);return o&&i++,i});r=()=>oe(a)}e.b.length&&l0(()=>{fo(t,r),ao(e.b)}),Ys(()=>{const i=Ki(()=>e.m.map(h0));return()=>{for(const s of i)typeof s=="function"&&s()}}),e.a.length&&Ys(()=>{fo(t,r),ao(e.a)})}function fo(n,t){if(n.l.s)for(const e of n.l.s)oe(e);t()}function H0(n){mi===null&&D0(),J1&&mi.l!==null?O0(mi).m.push(n):Ys(()=>{const t=Ki(n);if(typeof t=="function")return t})}function O0(n){var t=n.l;return t.u??={a:[],b:[],m:[]}}let ii=!1;function F0(n){var t=ii;try{return ii=!1,[n(),ii]}finally{ii=t}}function go(n){for(var t=co,e=co;t!==null&&!(t.f&(y0|p0));)t=t.parent;try{return oo(t),n()}finally{oo(e)}}function Hn(n,t,e,r){var i=(e&E0)!==0,s=!J1||(e&d0)!==0,a=(e&A0)!==0,o=(e&S0)!==0,c=!1,h;a?[h,c]=F0(()=>n[t]):h=n[t];var l=w0 in n||b0 in n,u=f0(n,t)?.set??(l&&a&&t in n?P=>n[t]=P:void 0),g=r,y=!0,A=!1,p=()=>(A=!0,y&&(y=!1,o?g=Ki(r):g=r),g);h===void 0&&r!==void 0&&(u&&s&&k0(),h=p(),u&&u(h));var w;if(s)w=()=>{var P=n[t];return P===void 0?p():(y=!0,A=!1,P)};else{var k=go(()=>(i?Js:m0)(()=>n[t]));k.f|=g0,w=()=>{var P=oe(k);return P!==void 0&&(g=void 0),P===void 0?g:P}}if(!(e&B0))return w;if(u){var v=n.$$legacy;return function(P,B){return arguments.length>0?((!s||!B||v||c)&&u(B?w():P),P):w()}}var m=!1,E=!1,U=C0(h),K=go(()=>Js(()=>{var P=w(),B=oe(U);return m?(m=!1,E=!0,B):(E=!1,U.v=P)}));return i||(K.equals=I0),function(P,B){if(arguments.length>0){const b=B?oe(K):s&&a?v0(P):P;return K.equals(b)||(m=!0,en(U,b),A&&g!==void 0&&(g=b),Ki(()=>oe(K))),P}return oe(K)}}/*! OpenPGP.js v6.0.1 - 2024-11-21 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */const Ot=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G0(n,t){return t.forEach(function(e){e&&typeof e!="string"&&!Array.isArray(e)&&Object.keys(e).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}})}),Object.freeze(n)}const rn=Symbol("doneWritingPromise"),n3=Symbol("doneWritingResolve"),i3=Symbol("doneWritingReject"),mn=Symbol("readingIndex");class fe extends Array{constructor(){super(),Object.setPrototypeOf(this,fe.prototype),this[rn]=new Promise((t,e)=>{this[n3]=t,this[i3]=e}),this[rn].catch(()=>{})}}function Ct(n){return n&&n.getReader&&Array.isArray(n)}function Kn(n){if(!Ct(n)){const t=n.getWriter(),e=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),e.call(t)},t}this.stream=n}function ne(n){if(Ct(n))return"array";if(Ot.ReadableStream&&Ot.ReadableStream.prototype.isPrototypeOf(n))return"web";if(n&&!(Ot.ReadableStream&&n instanceof Ot.ReadableStream)&&typeof n._read=="function"&&typeof n._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!n||!n.getReader)&&"web-like"}function Xi(n){return Uint8Array.prototype.isPrototypeOf(n)}function s3(n){if(n.length===1)return n[0];let t=0;for(let i=0;i<n.length;i++){if(!Xi(n[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=n[i].length}const e=new Uint8Array(t);let r=0;return n.forEach(function(i){e.set(i,r),r+=i.length}),e}fe.prototype.getReader=function(){return this[mn]===void 0&&(this[mn]=0),{read:async()=>(await this[rn],this[mn]===this.length?{value:void 0,done:!0}:{value:this[this[mn]++],done:!1})}},fe.prototype.readToEnd=async function(n){await this[rn];const t=n(this.slice(this[mn]));return this.length=0,t},fe.prototype.clone=function(){const n=new fe;return n[rn]=this[rn].then(()=>{n.push(...this)}),n},Kn.prototype.write=async function(n){this.stream.push(n)},Kn.prototype.close=async function(){this.stream[n3]()},Kn.prototype.abort=async function(n){return this.stream[i3](n),n},Kn.prototype.releaseLock=function(){},typeof Ot.process=="object"&&Ot.process.versions;const yo=new WeakSet,ft=Symbol("externalBuffer");function Ie(n){if(this.stream=n,n[ft]&&(this[ft]=n[ft].slice()),Ct(n)){const e=n.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(ne(n)){const e=n.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{e.closed.catch(function(){}),e.releaseLock()},void(this._cancel=e.cancel.bind(e))}let t=!1;this._read=async()=>t||yo.has(n)?{value:void 0,done:!0}:(t=!0,{value:n,done:!1}),this._releaseLock=()=>{if(t)try{yo.add(n)}catch{}}}function Ca(n){return ne(n)?n:new ReadableStream({start(t){t.enqueue(n),t.close()}})}function a3(n){if(ne(n))return n;const t=new fe;return(async()=>{const e=le(t);await e.write(n),await e.close()})(),t}function Wt(n){return n.some(t=>ne(t)&&!Ct(t))?function(t){t=t.map(Ca);const e=c3(async function(s){await Promise.all(i.map(a=>Xs(a,s)))});let r=Promise.resolve();const i=t.map((s,a)=>Er(s,(o,c)=>(r=r.then(()=>Mr(o,e.writable,{preventClose:a!==t.length-1})),r)));return e.readable}(n):n.some(t=>Ct(t))?function(t){const e=new fe;let r=Promise.resolve();return t.forEach((i,s)=>(r=r.then(()=>Mr(i,e,{preventClose:s!==t.length-1})),r)),e}(n):typeof n[0]=="string"?n.join(""):s3(n)}async function Mr(n,t,{preventClose:e=!1,preventAbort:r=!1,preventCancel:i=!1}={}){if(ne(n)&&!Ct(n)){n=Ca(n);try{if(n[ft]){const o=le(t);for(let c=0;c<n[ft].length;c++)await o.ready,await o.write(n[ft][c]);o.releaseLock()}await n.pipeTo(t,{preventClose:e,preventAbort:r,preventCancel:i})}catch{}return}const s=tr(n=a3(n)),a=le(t);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){e||await a.close();break}await a.write(c)}}catch(o){r||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function o3(n,t){const e=new TransformStream(t);return Mr(n,e.writable),e.readable}function c3(n){let t,e,r,i=!1,s=!1;return{readable:new ReadableStream({start(a){r=a},pull(){t?t():i=!0},async cancel(a){s=!0,n&&await n(a),e&&e(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");r.enqueue(a),i?i=!1:(await new Promise((o,c)=>{t=o,e=c}),t=null,e=null)},close:r.close.bind(r),abort:r.error.bind(r)})}}function Et(n,t=()=>{},e=()=>{}){if(Ct(n)){const s=new fe;return(async()=>{const a=le(s);try{const o=await Ut(n),c=t(o),h=e();let l;l=c!==void 0&&h!==void 0?Wt([c,h]):c!==void 0?c:h,await a.write(l),await a.close()}catch(o){await a.abort(o)}})(),s}if(ne(n))return o3(n,{async transform(s,a){try{const o=await t(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await e();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const r=t(n),i=e();return r!==void 0&&i!==void 0?Wt([r,i]):r!==void 0?r:i}function Er(n,t){if(ne(n)&&!Ct(n)){let r;const i=new TransformStream({start(o){r=o}}),s=Mr(n,i.writable),a=c3(async function(o){r.error(o),await s,await new Promise(setTimeout)});return t(i.readable,a.writable),a.readable}n=a3(n);const e=new fe;return t(n,e),e}function ts(n,t){let e;const r=Er(n,(i,s)=>{const a=tr(i);a.remainder=()=>(a.releaseLock(),Mr(i,s),r),e=t(a)});return e}function Nr(n){if(Ct(n))return n.clone();if(ne(n)){const t=function(e){if(Ct(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(ne(e)){const r=Ca(e).tee();return r[0][ft]=r[1][ft]=e[ft],r}return[Tt(e),Tt(e)]}(n);return l3(n,t[0]),t[1]}return Tt(n)}function On(n){return Ct(n)?Nr(n):ne(n)?new ReadableStream({start(t){const e=Er(n,async(r,i)=>{const s=tr(r),a=le(i);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){try{t.close()}catch{}return void await a.close()}try{t.enqueue(c)}catch{}await a.write(c)}}catch(o){t.error(o),await a.abort(o)}});l3(n,e)}}):Tt(n)}function l3(n,t){Object.entries(Object.getOwnPropertyDescriptors(n.constructor.prototype)).forEach(([e,r])=>{e!=="constructor"&&(r.value?r.value=r.value.bind(t):r.get=r.get.bind(t),Object.defineProperty(n,e,r))})}function Tt(n,t=0,e=1/0){if(Ct(n))throw Error("Not implemented");if(ne(n)){if(t>=0&&e>=0){let r=0;return o3(n,{transform(i,s){r<e?(r+i.length>=t&&s.enqueue(Tt(i,Math.max(t-r,0),e-r)),r+=i.length):s.terminate()}})}if(t<0&&(e<0||e===1/0)){let r=[];return Et(n,i=>{i.length>=-t?r=[i]:r.push(i)},()=>Tt(Wt(r),t,e))}if(t===0&&e<0){let r;return Et(n,i=>{const s=r?Wt([r,i]):i;if(s.length>=-e)return r=Tt(s,e),Tt(s,t,e);r=s})}return console.warn(`stream.slice(input, ${t}, ${e}) not implemented efficiently.`),kr(async()=>Tt(await Ut(n),t,e))}return n[ft]&&(n=Wt(n[ft].concat([n]))),Xi(n)?n.subarray(t,e===1/0?n.length:e):n.slice(t,e)}async function Ut(n,t=Wt){return Ct(n)?n.readToEnd(t):ne(n)?tr(n).readToEnd(t):n}async function Xs(n,t){if(ne(n)){if(n.cancel){const e=await n.cancel(t);return await new Promise(setTimeout),e}if(n.destroy)return n.destroy(t),await new Promise(setTimeout),t}}function kr(n){const t=new fe;return(async()=>{const e=le(t);try{await e.write(await n()),await e.close()}catch(r){await e.abort(r)}})(),t}function tr(n){return new Ie(n)}function le(n){return new Kn(n)}Ie.prototype.read=async function(){return this[ft]&&this[ft].length?{done:!1,value:this[ft].shift()}:this._read()},Ie.prototype.releaseLock=function(){this[ft]&&(this.stream[ft]=this[ft]),this._releaseLock()},Ie.prototype.cancel=function(n){return this._cancel(n)},Ie.prototype.readLine=async function(){let n,t=[];for(;!n;){let{done:e,value:r}=await this.read();if(r+="",e)return t.length?Wt(t):void 0;const i=r.indexOf(`
`)+1;i&&(n=Wt(t.concat(r.substr(0,i))),t=[]),i!==r.length&&t.push(r.substr(i))}return this.unshift(...t),n},Ie.prototype.readByte=async function(){const{done:n,value:t}=await this.read();if(n)return;const e=t[0];return this.unshift(Tt(t,1)),e},Ie.prototype.readBytes=async function(n){const t=[];let e=0;for(;;){const{done:r,value:i}=await this.read();if(r)return t.length?Wt(t):void 0;if(t.push(i),e+=i.length,e>=n){const s=Wt(t);return this.unshift(Tt(s,n)),Tt(s,0,n)}}},Ie.prototype.peekBytes=async function(n){const t=await this.readBytes(n);return this.unshift(t),t},Ie.prototype.unshift=function(...n){this[ft]||(this[ft]=[]),n.length===1&&Xi(n[0])&&this[ft].length&&n[0].length&&this[ft][0].byteOffset>=n[0].length?this[ft][0]=new Uint8Array(this[ft][0].buffer,this[ft][0].byteOffset-n[0].length,this[ft][0].byteLength+n[0].length):this[ft].unshift(...n.filter(t=>t&&t.length))},Ie.prototype.readToEnd=async function(n=Wt){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return n(t)};const En=Symbol("byValue");var f={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(n,t){if(typeof t=="number"&&(t=this.read(n,t)),n[t]!==void 0)return n[t];throw Error("Invalid enum value.")},read:function(n,t){if(n[En]||(n[En]=[],Object.entries(n).forEach(([e,r])=>{n[En][r]=e})),n[En][t]!==void 0)return n[En][t];throw Error("Invalid enum value.")}},W={preferredHashAlgorithm:f.hash.sha512,preferredSymmetricAlgorithm:f.symmetric.aes256,preferredCompressionAlgorithm:f.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:f.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:f.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([f.symmetric.aes128,f.symmetric.aes192,f.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.0.1",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([f.hash.md5,f.hash.ripemd]),rejectMessageHashAlgorithms:new Set([f.hash.md5,f.hash.ripemd,f.hash.sha1]),rejectPublicKeyAlgorithms:new Set([f.publicKey.elgamal,f.publicKey.dsa]),rejectCurves:new Set([f.curve.secp256k1])};const po=(()=>{try{return!1}catch{}return!1})(),d={isString:function(n){return typeof n=="string"||n instanceof String},nodeRequire:()=>{},isArray:function(n){return n instanceof Array},isUint8Array:Xi,isStream:ne,getNobleCurve:async(n,t)=>{if(!W.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:e}=await Promise.resolve().then(function(){return B2});switch(n){case f.publicKey.ecdh:case f.publicKey.ecdsa:{const r=e.get(t);if(!r)throw Error("Unsupported curve");return r}case f.publicKey.x448:return e.get("x448");case f.publicKey.ed448:return e.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(n){let t=0;for(let e=0;e<n.length;e++)t+=256**e*n[n.length-1-e];return t},writeNumber:function(n,t){const e=new Uint8Array(t);for(let r=0;r<t;r++)e[r]=n>>8*(t-r-1)&255;return e},readDate:function(n){const t=d.readNumber(n);return new Date(1e3*t)},writeDate:function(n){const t=Math.floor(n.getTime()/1e3);return d.writeNumber(t,4)},normalizeDate:function(n=Date.now()){return n===null||n===1/0?n:new Date(1e3*Math.floor(+n/1e3))},readMPI:function(n){const t=(n[0]<<8|n[1])+7>>>3;return d.readExactSubarray(n,2,2+t)},readExactSubarray:function(n,t,e){if(n.length<e-t)throw Error("Input array too short");return n.subarray(t,e)},leftPad(n,t){if(n.length>t)throw Error("Input array too long");const e=new Uint8Array(t),r=t-n.length;return e.set(n,r),e},uint8ArrayToMPI:function(n){const t=d.uint8ArrayBitLength(n);if(t===0)throw Error("Zero MPI");const e=n.subarray(n.length-Math.ceil(t/8)),r=new Uint8Array([(65280&t)>>8,255&t]);return d.concatUint8Array([r,e])},uint8ArrayBitLength:function(n){let t;for(t=0;t<n.length&&n[t]===0;t++);if(t===n.length)return 0;const e=n.subarray(t);return 8*(e.length-1)+d.nbits(e[0])},hexToUint8Array:function(n){const t=new Uint8Array(n.length>>1);for(let e=0;e<n.length>>1;e++)t[e]=parseInt(n.substr(e<<1,2),16);return t},uint8ArrayToHex:function(n){const t="0123456789abcdef";let e="";return n.forEach(r=>{e+=t[r>>4]+t[15&r]}),e},stringToUint8Array:function(n){return Et(n,t=>{if(!d.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})},uint8ArrayToString:function(n){const t=[],r=(n=new Uint8Array(n)).length;for(let i=0;i<r;i+=16384)t.push(String.fromCharCode.apply(String,n.subarray(i,i+16384<r?i+16384:r)));return t.join("")},encodeUTF8:function(n){const t=new TextEncoder("utf-8");function e(r,i=!1){return t.encode(r,{stream:!i})}return Et(n,e,()=>e("",!0))},decodeUTF8:function(n){const t=new TextDecoder("utf-8");function e(r,i=!1){return t.decode(r,{stream:!i})}return Et(n,e,()=>e(new Uint8Array,!0))},concat:Wt,concatUint8Array:s3,equalsUint8Array:function(n,t){if(!d.isUint8Array(n)||!d.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0},writeChecksum:function(n){let t=0;for(let e=0;e<n.length;e++)t=t+n[e]&65535;return d.writeNumber(t,2)},printDebug:function(n){po&&console.log("[OpenPGP.js debug]",n)},printDebugError:function(n){po&&console.error("[OpenPGP.js debug]",n)},nbits:function(n){let t=1,e=n>>>16;return e!==0&&(n=e,t+=16),e=n>>8,e!==0&&(n=e,t+=8),e=n>>4,e!==0&&(n=e,t+=4),e=n>>2,e!==0&&(n=e,t+=2),e=n>>1,e!==0&&(n=e,t+=1),t},double:function(n){const t=new Uint8Array(n.length),e=n.length-1;for(let r=0;r<e;r++)t[r]=n[r]<<1^n[r+1]>>7;return t[e]=n[e]<<1^135*(n[0]>>7),t},shiftRight:function(n,t){if(t)for(let e=n.length-1;e>=0;e--)n[e]>>=t,e>0&&(n[e]|=n[e-1]<<8-t);return n},getWebCrypto:function(){const n=Ot!==void 0&&Ot.crypto&&Ot.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!n)throw Error("The WebCrypto API is not available");return n},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(n){return d.isString(n)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(n):!1},canonicalizeEOL:function(n){let t=!1;return Et(n,e=>{let r;t&&(e=d.concatUint8Array([new Uint8Array([13]),e])),e[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;const i=[];for(let o=0;r=e.indexOf(10,o)+1,r;o=r)e[r-2]!==13&&i.push(r);if(!i.length)return e;const s=new Uint8Array(e.length+i.length);let a=0;for(let o=0;o<i.length;o++){const c=e.subarray(i[o-1]||0,i[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(e.subarray(i[i.length-1]||0),a),s},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(n){let t=!1;return Et(n,e=>{let r;(e=t&&e[0]!==10?d.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;let i=0;for(let s=0;s!==e.length;s=r){r=e.indexOf(13,s)+1,r||(r=e.length);const a=r-(e[r]===10?1:0);s&&e.copyWithin(i,s,a),i+=a-s}return e.subarray(0,i)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(n){return n.split(`
`).map(t=>{let e=t.length-1;for(;e>=0&&(t[e]===" "||t[e]==="	"||t[e]==="\r");e--);return t.substr(0,e+1)}).join(`
`)},wrapError:function(n,t){if(!t)return Error(n);try{t.message=n+": "+t.message}catch{}return t},constructAllowedPackets:function(n){const t={};return n.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(n){return new Promise(async(t,e)=>{let r;await Promise.all(n.map(async i=>{try{t(await i)}catch(s){r=s}})),e(r)})},selectUint8Array:function(n,t,e){const r=Math.max(t.length,e.length),i=new Uint8Array(r);let s=0;for(let a=0;a<i.length;a++)i[a]=t[a]&256-n|e[a]&255+n,s+=n&a<t.length|1-n&a<e.length;return i.subarray(0,s)},selectUint8:function(n,t,e){return t&256-n|e&255+n},isAES:function(n){return n===f.symmetric.aes128||n===f.symmetric.aes192||n===f.symmetric.aes256}},ps=d.getNodeBuffer();let Qi,Ri;function Ge(n){let t=new Uint8Array;return Et(n,e=>{t=d.concatUint8Array([t,e]);const r=[],i=Math.floor(t.length/45),s=45*i,a=Qi(t.subarray(0,s));for(let o=0;o<i;o++)r.push(a.substr(60*o,60)),r.push(`
`);return t=t.subarray(s),r.join("")},()=>t.length?Qi(t)+`
`:"")}function h3(n){let t="";return Et(n,e=>{t+=e;let r=0;const i=[" ","	","\r",`
`];for(let o=0;o<i.length;o++){const c=i[o];for(let h=t.indexOf(c);h!==-1;h=t.indexOf(c,h+1))r++}let s=t.length;for(;s>0&&(s-r)%4!=0;s--)i.includes(t[s])&&r--;const a=Ri(t.substr(0,s));return t=t.substr(s),a},()=>Ri(t))}function me(n){return h3(n.replace(/-/g,"+").replace(/_/g,"/"))}function qt(n,t){let e=Ge(n).replace(/[\r\n]/g,"");return e=e.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),e}function q0(n){const t=n.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?f.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?f.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?f.armor.signed:/MESSAGE/.test(t[1])?f.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?f.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?f.armor.privateKey:/SIGNATURE/.test(t[1])?f.armor.signature:void 0}function Br(n,t){let e="";return t.showVersion&&(e+="Version: "+t.versionString+`
`),t.showComment&&(e+="Comment: "+t.commentString+`
`),n&&(e+="Comment: "+n+`
`),e+=`
`,e}function Ir(n){const t=function(e){let r=13501623;return Et(e,i=>{const s=$0?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,s);for(let o=0;o<s;o++)r^=a[o],r=Qt[0][r>>24&255]^Qt[1][r>>16&255]^Qt[2][r>>8&255]^Qt[3][255&r];for(let o=4*s;o<i.length;o++)r=r>>8^Qt[0][255&r^i[o]]},()=>new Uint8Array([r,r>>8,r>>16]))}(n);return Ge(t)}ps?(Qi=n=>ps.from(n).toString("base64"),Ri=n=>{const t=ps.from(n,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(Qi=n=>btoa(d.uint8ArrayToString(n)),Ri=n=>d.stringToUint8Array(atob(n)));const Qt=[Array(255),Array(255),Array(255),Array(255)];for(let n=0;n<=255;n++){let t=n<<16;for(let e=0;e<8;e++)t=t<<1^(8388608&t?8801531:0);Qt[0][n]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let n=0;n<=255;n++)Qt[1][n]=Qt[0][n]>>8^Qt[0][255&Qt[0][n]];for(let n=0;n<=255;n++)Qt[2][n]=Qt[1][n]>>8^Qt[0][255&Qt[1][n]];for(let n=0;n<=255;n++)Qt[3][n]=Qt[2][n]>>8^Qt[0][255&Qt[2][n]];const $0=function(){const n=new ArrayBuffer(2);return new DataView(n).setInt16(0,255,!0),new Int16Array(n)[0]===255}();function Ao(n){for(let t=0;t<n.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(n[t])||d.printDebugError(Error("Improperly formatted armor header: "+n[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(n[t])||d.printDebugError(Error("Unknown header: "+n[t]))}function j0(n){let t=n;const e=n.lastIndexOf("=");return e>=0&&e!==n.length-1&&(t=n.slice(0,e)),t}function u3(n){return new Promise(async(t,e)=>{try{const r=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,h=a,l=[];const u=h3(Er(n,async(g,y)=>{const A=tr(g);try{for(;;){let w=await A.readLine();if(w===void 0)throw Error("Misformed armored text");if(w=d.removeTrailingSpaces(w.replace(/[\r\n]/g,"")),s)if(o)c||s!==f.armor.signed||(r.test(w)?(l=l.join(`\r
`),c=!0,Ao(h),h=[],o=!1):l.push(w.replace(/^- /,"")));else if(r.test(w)&&e(Error("Mandatory blank line missing between armor headers and armor data")),i.test(w)){if(Ao(h),o=!0,c||s!==f.armor.signed){t({text:l,data:u,headers:a,type:s});break}}else h.push(w);else r.test(w)&&(s=q0(w))}}catch(w){return void e(w)}const p=le(y);try{for(;;){await p.ready;const{done:w,value:k}=await A.read();if(w)throw Error("Misformed armored text");const v=k+"";if(v.indexOf("=")!==-1||v.indexOf("-")!==-1){let m=await A.readToEnd();m.length||(m=""),m=v+m,m=d.removeTrailingSpaces(m.replace(/\r/g,""));const E=m.split(r);if(E.length===1)throw Error("Misformed armored text");const U=j0(E[0].slice(0,-1));await p.write(U);break}await p.write(v)}await p.ready,await p.close()}catch(w){await p.abort(w)}}))}catch(r){e(r)}}).then(async t=>(Ct(t.data)&&(t.data=await Ut(t.data)),t))}function f3(n,t,e,r,i,s=!1,a=W){let o,c;n===f.armor.signed&&(o=t.text,c=t.hash,t=t.data);const h=s&&On(t),l=[];switch(n){case f.armor.multipartSection:l.push("-----BEGIN PGP MESSAGE, PART "+e+"/"+r+`-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push("-----END PGP MESSAGE, PART "+e+"/"+r+`-----
`);break;case f.armor.multipartLast:l.push("-----BEGIN PGP MESSAGE, PART "+e+`-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push("-----END PGP MESSAGE, PART "+e+`-----
`);break;case f.armor.signed:l.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),l.push(c?`Hash: ${c}

`:`
`),l.push(o.replace(/^-/gm,"- -")),l.push(`
-----BEGIN PGP SIGNATURE-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push(`-----END PGP SIGNATURE-----
`);break;case f.armor.message:l.push(`-----BEGIN PGP MESSAGE-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push(`-----END PGP MESSAGE-----
`);break;case f.armor.publicKey:l.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case f.armor.privateKey:l.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case f.armor.signature:l.push(`-----BEGIN PGP SIGNATURE-----
`),l.push(Br(i,a)),l.push(Ge(t)),h&&l.push("=",Ir(h)),l.push(`-----END PGP SIGNATURE-----
`)}return d.concat(l)}async function ta(n){switch(n){case f.symmetric.aes128:case f.symmetric.aes192:case f.symmetric.aes256:throw Error("Not a legacy cipher");case f.symmetric.cast5:case f.symmetric.blowfish:case f.symmetric.twofish:case f.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then(function(){return S2}),e=t.get(n);if(!e)throw Error("Unsupported cipher algorithm");return e}default:throw Error("Unsupported cipher algorithm")}}function V0(n){switch(n){case f.symmetric.aes128:case f.symmetric.aes192:case f.symmetric.aes256:case f.symmetric.twofish:return 16;case f.symmetric.blowfish:case f.symmetric.cast5:case f.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function Z0(n){switch(n){case f.symmetric.aes128:case f.symmetric.blowfish:case f.symmetric.cast5:return 16;case f.symmetric.aes192:case f.symmetric.tripledes:return 24;case f.symmetric.aes256:case f.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function Ft(n){return{keySize:Z0(n),blockSize:V0(n)}}var Y0=Object.freeze({__proto__:null,getCipherParams:Ft,getLegacyCipher:ta});function ds(n,t){let e=n[0],r=n[1],i=n[2],s=n[3];e=Lt(e,r,i,s,t[0],7,-680876936),s=Lt(s,e,r,i,t[1],12,-389564586),i=Lt(i,s,e,r,t[2],17,606105819),r=Lt(r,i,s,e,t[3],22,-1044525330),e=Lt(e,r,i,s,t[4],7,-176418897),s=Lt(s,e,r,i,t[5],12,1200080426),i=Lt(i,s,e,r,t[6],17,-1473231341),r=Lt(r,i,s,e,t[7],22,-45705983),e=Lt(e,r,i,s,t[8],7,1770035416),s=Lt(s,e,r,i,t[9],12,-1958414417),i=Lt(i,s,e,r,t[10],17,-42063),r=Lt(r,i,s,e,t[11],22,-1990404162),e=Lt(e,r,i,s,t[12],7,1804603682),s=Lt(s,e,r,i,t[13],12,-40341101),i=Lt(i,s,e,r,t[14],17,-1502002290),r=Lt(r,i,s,e,t[15],22,1236535329),e=Mt(e,r,i,s,t[1],5,-165796510),s=Mt(s,e,r,i,t[6],9,-1069501632),i=Mt(i,s,e,r,t[11],14,643717713),r=Mt(r,i,s,e,t[0],20,-373897302),e=Mt(e,r,i,s,t[5],5,-701558691),s=Mt(s,e,r,i,t[10],9,38016083),i=Mt(i,s,e,r,t[15],14,-660478335),r=Mt(r,i,s,e,t[4],20,-405537848),e=Mt(e,r,i,s,t[9],5,568446438),s=Mt(s,e,r,i,t[14],9,-1019803690),i=Mt(i,s,e,r,t[3],14,-187363961),r=Mt(r,i,s,e,t[8],20,1163531501),e=Mt(e,r,i,s,t[13],5,-1444681467),s=Mt(s,e,r,i,t[2],9,-51403784),i=Mt(i,s,e,r,t[7],14,1735328473),r=Mt(r,i,s,e,t[12],20,-1926607734),e=Nt(e,r,i,s,t[5],4,-378558),s=Nt(s,e,r,i,t[8],11,-2022574463),i=Nt(i,s,e,r,t[11],16,1839030562),r=Nt(r,i,s,e,t[14],23,-35309556),e=Nt(e,r,i,s,t[1],4,-1530992060),s=Nt(s,e,r,i,t[4],11,1272893353),i=Nt(i,s,e,r,t[7],16,-155497632),r=Nt(r,i,s,e,t[10],23,-1094730640),e=Nt(e,r,i,s,t[13],4,681279174),s=Nt(s,e,r,i,t[0],11,-358537222),i=Nt(i,s,e,r,t[3],16,-722521979),r=Nt(r,i,s,e,t[6],23,76029189),e=Nt(e,r,i,s,t[9],4,-640364487),s=Nt(s,e,r,i,t[12],11,-421815835),i=Nt(i,s,e,r,t[15],16,530742520),r=Nt(r,i,s,e,t[2],23,-995338651),e=zt(e,r,i,s,t[0],6,-198630844),s=zt(s,e,r,i,t[7],10,1126891415),i=zt(i,s,e,r,t[14],15,-1416354905),r=zt(r,i,s,e,t[5],21,-57434055),e=zt(e,r,i,s,t[12],6,1700485571),s=zt(s,e,r,i,t[3],10,-1894986606),i=zt(i,s,e,r,t[10],15,-1051523),r=zt(r,i,s,e,t[1],21,-2054922799),e=zt(e,r,i,s,t[8],6,1873313359),s=zt(s,e,r,i,t[15],10,-30611744),i=zt(i,s,e,r,t[6],15,-1560198380),r=zt(r,i,s,e,t[13],21,1309151649),e=zt(e,r,i,s,t[4],6,-145523070),s=zt(s,e,r,i,t[11],10,-1120210379),i=zt(i,s,e,r,t[2],15,718787259),r=zt(r,i,s,e,t[9],21,-343485551),n[0]=gr(e,n[0]),n[1]=gr(r,n[1]),n[2]=gr(i,n[2]),n[3]=gr(s,n[3])}function es(n,t,e,r,i,s){return t=gr(gr(t,n),gr(r,s)),gr(t<<i|t>>>32-i,e)}function Lt(n,t,e,r,i,s,a){return es(t&e|~t&r,n,t,i,s,a)}function Mt(n,t,e,r,i,s,a){return es(t&r|e&~r,n,t,i,s,a)}function Nt(n,t,e,r,i,s,a){return es(t^e^r,n,t,i,s,a)}function zt(n,t,e,r,i,s,a){return es(e^(t|~r),n,t,i,s,a)}function J0(n){const t=[];let e;for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}const wo="0123456789abcdef".split("");function W0(n){let t="",e=0;for(;e<4;e++)t+=wo[n>>8*e+4&15]+wo[n>>8*e&15];return t}function gr(n,t){return n+t&4294967295}const bo=d.getWebCrypto(),_i=d.getNodeCrypto(),X0=_i&&_i.getHashes();function Me(n){if(_i&&X0.includes(n))return async function(t){const e=_i.createHash(n);return Et(t,r=>{e.update(r)},()=>new Uint8Array(e.digest()))}}function rr(n,t){const e=async()=>{const{nobleHashes:r}=await Promise.resolve().then(function(){return L2}),i=r.get(n);if(!i)throw Error("Unsupported hash");return i};return async function(r){if(Ct(r)&&(r=await Ut(r)),d.isStream(r)){const i=(await e()).create();return Et(r,s=>{i.update(s)},()=>i.digest())}return bo&&t?new Uint8Array(await bo.digest(t,r)):(await e())(r)}}var ce={md5:Me("md5")||async function(n){const t=function(e){const r=e.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=e.length;s+=64)ds(i,J0(e.substring(s-64,s)));e=e.substring(s-64);const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<e.length;s++)a[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(a[s>>2]|=128<<(s%4<<3),s>55)for(ds(i,a),s=0;s<16;s++)a[s]=0;return a[14]=8*r,ds(i,a),i}(d.uint8ArrayToString(n));return d.hexToUint8Array(function(e){for(let r=0;r<e.length;r++)e[r]=W0(e[r]);return e.join("")}(t))},sha1:Me("sha1")||rr("sha1","SHA-1"),sha224:Me("sha224")||rr("sha224"),sha256:Me("sha256")||rr("sha256","SHA-256"),sha384:Me("sha384")||rr("sha384","SHA-384"),sha512:Me("sha512")||rr("sha512","SHA-512"),ripemd:Me("ripemd160")||rr("ripemd160"),sha3_256:Me("sha3-256")||rr("sha3_256"),sha3_512:Me("sha3-512")||rr("sha3_512"),digest:function(n,t){switch(n){case f.hash.md5:return this.md5(t);case f.hash.sha1:return this.sha1(t);case f.hash.ripemd:return this.ripemd(t);case f.hash.sha256:return this.sha256(t);case f.hash.sha384:return this.sha384(t);case f.hash.sha512:return this.sha512(t);case f.hash.sha224:return this.sha224(t);case f.hash.sha3_256:return this.sha3_256(t);case f.hash.sha3_512:return this.sha3_512(t);default:throw Error("Unsupported hash function")}},getHashByteLength:function(n){switch(n){case f.hash.md5:return 16;case f.hash.sha1:case f.hash.ripemd:return 20;case f.hash.sha256:return 32;case f.hash.sha384:return 48;case f.hash.sha512:return 64;case f.hash.sha224:return 28;case f.hash.sha3_256:return 32;case f.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}};function g3(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function ct(n,...t){if(!g3(n))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(n.length))throw Error(`Uint8Array expected of length ${t}, not of length=${n.length}`)}function Ti(n,t=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(t&&n.finished)throw Error("Hash#digest() has already been called")}function y3(n,t){ct(n);const e=t.outputLen;if(n.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const xa=n=>new Uint8Array(n.buffer,n.byteOffset,n.byteLength),gt=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Li=n=>new DataView(n.buffer,n.byteOffset,n.byteLength);if(new Uint8Array(new Uint32Array([287454020]).buffer)[0]!==68)throw Error("Non little-endian hardware is not supported");function qn(n){if(typeof n=="string")n=function(t){if(typeof t!="string")throw Error("string expected, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}(n);else{if(!g3(n))throw Error("Uint8Array expected, got "+typeof n);n=te(n)}return n}function p3(n,t){if(n.length!==t.length)return!1;let e=0;for(let r=0;r<n.length;r++)e|=n[r]^t[r];return e===0}const Wn=(n,t)=>(Object.assign(t,n),t);function As(n,t,e,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,e,r);const i=BigInt(32),s=BigInt(4294967295),a=Number(e>>i&s),o=Number(e&s);n.setUint32(t+0,a,r),n.setUint32(t+4,o,r)}function ge(n){return n.byteOffset%4==0}function te(n){return Uint8Array.from(n)}function Gt(...n){for(let t=0;t<n.length;t++)n[t].fill(0)}const qe=16,Ua=new Uint8Array(16),xe=gt(Ua),ue=n=>(n>>>0&255)<<24|(n>>>8&255)<<16|(n>>>16&255)<<8|n>>>24&255;class d3{constructor(t,e){this.blockLen=qe,this.outputLen=qe,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ct(t=qn(t),16);const r=Li(t);let i=r.getUint32(0,!1),s=r.getUint32(4,!1),a=r.getUint32(8,!1),o=r.getUint32(12,!1);const c=[];for(let k=0;k<128;k++)c.push({s0:ue(i),s1:ue(s),s2:ue(a),s3:ue(o)}),{s0:i,s1:s,s2:a,s3:o}={s3:(u=a)<<31|(g=o)>>>1,s2:(l=s)<<31|u>>>1,s1:(h=i)<<31|l>>>1,s0:h>>>1^225<<24&-(1&g)};var h,l,u,g;const y=(k=>k>65536?8:k>1024?4:2)(e||1024);if(![1,2,4,8].includes(y))throw Error(`ghash: wrong window size=${y}, should be 2, 4 or 8`);this.W=y;const A=128/y,p=this.windowSize=2**y,w=[];for(let k=0;k<A;k++)for(let v=0;v<p;v++){let m=0,E=0,U=0,K=0;for(let P=0;P<y;P++){if(!(v>>>y-P-1&1))continue;const{s0:B,s1:b,s2:x,s3:C}=c[y*k+P];m^=B,E^=b,U^=x,K^=C}w.push({s0:m,s1:E,s2:U,s3:K})}this.t=w}_updateBlock(t,e,r,i){t^=this.s0,e^=this.s1,r^=this.s2,i^=this.s3;const{W:s,t:a,windowSize:o}=this;let c=0,h=0,l=0,u=0;const g=(1<<s)-1;let y=0;for(const A of[t,e,r,i])for(let p=0;p<4;p++){const w=A>>>8*p&255;for(let k=8/s-1;k>=0;k--){const v=w>>>s*k&g,{s0:m,s1:E,s2:U,s3:K}=a[y*o+v];c^=m,h^=E,l^=U,u^=K,y+=1}}this.s0=c,this.s1=h,this.s2=l,this.s3=u}update(t){t=qn(t),Ti(this);const e=gt(t),r=Math.floor(t.length/qe),i=t.length%qe;for(let s=0;s<r;s++)this._updateBlock(e[4*s+0],e[4*s+1],e[4*s+2],e[4*s+3]);return i&&(Ua.set(t.subarray(r*qe)),this._updateBlock(xe[0],xe[1],xe[2],xe[3]),Gt(xe)),this}destroy(){const{t}=this;for(const e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){Ti(this),y3(t,this),this.finished=!0;const{s0:e,s1:r,s2:i,s3:s}=this,a=gt(t);return a[0]=e,a[1]=r,a[2]=i,a[3]=s,t}digest(){const t=new Uint8Array(qe);return this.digestInto(t),this.destroy(),t}}class t5 extends d3{constructor(t,e){const r=function(i){i.reverse();const s=1&i[15];let a=0;for(let o=0;o<i.length;o++){const c=i[o];i[o]=c>>>1|a,a=(1&c)<<7}return i[0]^=225&-s,i}(te(t=qn(t)));super(r,e),Gt(r)}update(t){t=qn(t),Ti(this);const e=gt(t),r=t.length%qe,i=Math.floor(t.length/qe);for(let s=0;s<i;s++)this._updateBlock(ue(e[4*s+3]),ue(e[4*s+2]),ue(e[4*s+1]),ue(e[4*s+0]));return r&&(Ua.set(t.subarray(i*qe)),this._updateBlock(ue(xe[3]),ue(xe[2]),ue(xe[1]),ue(xe[0])),Gt(xe)),this}digestInto(t){Ti(this),y3(t,this),this.finished=!0;const{s0:e,s1:r,s2:i,s3:s}=this,a=gt(t);return a[0]=e,a[1]=r,a[2]=i,a[3]=s,t.reverse()}}function A3(n){const t=(r,i)=>n(i,r.length).update(qn(r)).digest(),e=n(new Uint8Array(16),0);return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=(r,i)=>n(r,i),t}const mo=A3((n,t)=>new d3(n,t));A3((n,t)=>new t5(n,t));const Yt=16,si=new Uint8Array(Yt),e5=283;function Ka(n){return n<<1^e5&-(n>>7)}function nn(n,t){let e=0;for(;t>0;t>>=1)e^=n&-(1&t),n=Ka(n);return e}const ea=(()=>{const n=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=Ka(r))n[e]=r;const t=new Uint8Array(256);t[0]=99;for(let e=0;e<255;e++){let r=n[255-e];r|=r<<8,t[n[e]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return Gt(n),t})(),r5=ea.map((n,t)=>ea.indexOf(t)),n5=n=>n<<24|n>>>8,ws=n=>n<<8|n>>>24,Eo=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;function w3(n,t){if(n.length!==256)throw Error("Wrong sbox length");const e=new Uint32Array(256).map((h,l)=>t(n[l])),r=e.map(ws),i=r.map(ws),s=i.map(ws),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let h=0;h<256;h++)for(let l=0;l<256;l++){const u=256*h+l;a[u]=e[h]^r[l],o[u]=i[h]^s[l],c[u]=n[h]<<8|n[l]}return{sbox:n,sbox2:c,T0:e,T1:r,T2:i,T3:s,T01:a,T23:o}}const Pa=w3(ea,n=>nn(n,3)<<24|n<<16|n<<8|nn(n,2)),b3=w3(r5,n=>nn(n,11)<<24|nn(n,13)<<16|nn(n,9)<<8|nn(n,14)),i5=(()=>{const n=new Uint8Array(16);for(let t=0,e=1;t<16;t++,e=Ka(e))n[t]=e;return n})();function qr(n){ct(n);const t=n.length;if(![16,24,32].includes(t))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+t);const{sbox2:e}=Pa,r=[];ge(n)||r.push(n=te(n));const i=gt(n),s=i.length,a=c=>Ke(e,c,c,c,c),o=new Uint32Array(t+28);o.set(i);for(let c=s;c<o.length;c++){let h=o[c-1];c%s==0?h=a(n5(h))^i5[c/s-1]:s>6&&c%s==4&&(h=a(h)),o[c]=o[c-s]^h}return Gt(...r),o}function Da(n){const t=qr(n),e=t.slice(),r=t.length,{sbox2:i}=Pa,{T0:s,T1:a,T2:o,T3:c}=b3;for(let h=0;h<r;h+=4)for(let l=0;l<4;l++)e[h+l]=t[r-h-4+l];Gt(t);for(let h=4;h<r-4;h++){const l=e[h],u=Ke(i,l,l,l,l);e[h]=s[255&u]^a[u>>>8&255]^o[u>>>16&255]^c[u>>>24]}return e}function yr(n,t,e,r,i,s){return n[e<<8&65280|r>>>8&255]^t[i>>>8&65280|s>>>24&255]}function Ke(n,t,e,r,i){return n[255&t|65280&e]|n[r>>>16&255|i>>>16&65280]<<16}function Ee(n,t,e,r,i){const{sbox2:s,T01:a,T23:o}=Pa;let c=0;t^=n[c++],e^=n[c++],r^=n[c++],i^=n[c++];const h=n.length/4-2;for(let l=0;l<h;l++){const u=n[c++]^yr(a,o,t,e,r,i),g=n[c++]^yr(a,o,e,r,i,t),y=n[c++]^yr(a,o,r,i,t,e),A=n[c++]^yr(a,o,i,t,e,r);t=u,e=g,r=y,i=A}return{s0:n[c++]^Ke(s,t,e,r,i),s1:n[c++]^Ke(s,e,r,i,t),s2:n[c++]^Ke(s,r,i,t,e),s3:n[c++]^Ke(s,i,t,e,r)}}function rs(n,t,e,r,i){const{sbox2:s,T01:a,T23:o}=b3;let c=0;t^=n[c++],e^=n[c++],r^=n[c++],i^=n[c++];const h=n.length/4-2;for(let l=0;l<h;l++){const u=n[c++]^yr(a,o,t,i,r,e),g=n[c++]^yr(a,o,e,t,i,r),y=n[c++]^yr(a,o,r,e,t,i),A=n[c++]^yr(a,o,i,r,e,t);t=u,e=g,r=y,i=A}return{s0:n[c++]^Ke(s,t,i,r,e),s1:n[c++]^Ke(s,e,t,i,r),s2:n[c++]^Ke(s,r,e,t,i),s3:n[c++]^Ke(s,i,r,e,t)}}function $n(n,t){if(t===void 0)return new Uint8Array(n);if(ct(t),t.length<n)throw Error(`aes: wrong destination length, expected at least ${n}, got: ${t.length}`);if(!ge(t))throw Error("unaligned dst");return t}function m3(n,t,e,r){ct(t,Yt),ct(e);const i=e.length;r=$n(i,r);const s=t,a=gt(s);let{s0:o,s1:c,s2:h,s3:l}=Ee(n,a[0],a[1],a[2],a[3]);const u=gt(e),g=gt(r);for(let A=0;A+4<=u.length;A+=4){g[A+0]=u[A+0]^o,g[A+1]=u[A+1]^c,g[A+2]=u[A+2]^h,g[A+3]=u[A+3]^l;let p=1;for(let w=s.length-1;w>=0;w--)p=p+(255&s[w])|0,s[w]=255&p,p>>>=8;({s0:o,s1:c,s2:h,s3:l}=Ee(n,a[0],a[1],a[2],a[3]))}const y=Yt*Math.floor(u.length/4);if(y<i){const A=new Uint32Array([o,c,h,l]),p=xa(A);for(let w=y,k=0;w<i;w++,k++)r[w]=e[w]^p[k];Gt(A)}return r}function Pn(n,t,e,r,i){ct(e,Yt),ct(r),i=$n(r.length,i);const s=e,a=gt(s),o=Li(s),c=gt(r),h=gt(i),l=t?0:12,u=r.length;let g=o.getUint32(l,t),{s0:y,s1:A,s2:p,s3:w}=Ee(n,a[0],a[1],a[2],a[3]);for(let v=0;v+4<=c.length;v+=4)h[v+0]=c[v+0]^y,h[v+1]=c[v+1]^A,h[v+2]=c[v+2]^p,h[v+3]=c[v+3]^w,g=g+1>>>0,o.setUint32(l,g,t),{s0:y,s1:A,s2:p,s3:w}=Ee(n,a[0],a[1],a[2],a[3]);const k=Yt*Math.floor(c.length/4);if(k<u){const v=new Uint32Array([y,A,p,w]),m=xa(v);for(let E=k,U=0;E<u;E++,U++)i[E]=r[E]^m[U];Gt(v)}return i}const s5=Wn({blockSize:16,nonceLength:16},function(n,t){function e(r,i){if(ct(r),i!==void 0&&(ct(i),!ge(i)))throw Error("unaligned destination");const s=qr(n),a=te(t),o=[s,a];ge(r)||o.push(r=te(r));const c=m3(s,a,r,i);return Gt(...o),c}return ct(n),ct(t,Yt),{encrypt:(r,i)=>e(r,i),decrypt:(r,i)=>e(r,i)}}),E3=Wn({blockSize:16,nonceLength:16},function(n,t,e={}){ct(n),ct(t,16);const r=!e.disablePadding;return{encrypt(i,s){const a=qr(n),{b:o,o:c,out:h}=function(v,m,E){ct(v);let U=v.length;const K=U%Yt;if(!m&&K!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");ge(v)||(v=te(v));const P=gt(v);if(m){let b=Yt-K;b||(b=Yt),U+=b}const B=$n(U,E);return{b:P,o:gt(B),out:B}}(i,r,s);let l=t;const u=[a];ge(l)||u.push(l=te(l));const g=gt(l);let y=g[0],A=g[1],p=g[2],w=g[3],k=0;for(;k+4<=o.length;)y^=o[k+0],A^=o[k+1],p^=o[k+2],w^=o[k+3],{s0:y,s1:A,s2:p,s3:w}=Ee(a,y,A,p,w),c[k++]=y,c[k++]=A,c[k++]=p,c[k++]=w;if(r){const v=function(m){const E=new Uint8Array(16),U=gt(E);E.set(m);const K=Yt-m.length;for(let P=Yt-K;P<Yt;P++)E[P]=K;return U}(i.subarray(4*k));y^=v[0],A^=v[1],p^=v[2],w^=v[3],{s0:y,s1:A,s2:p,s3:w}=Ee(a,y,A,p,w),c[k++]=y,c[k++]=A,c[k++]=p,c[k++]=w}return Gt(...u),h},decrypt(i,s){(function(k){if(ct(k),k.length%Yt!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")})(i);const a=Da(n);let o=t;const c=[a];ge(o)||c.push(o=te(o));const h=gt(o),l=$n(i.length,s);ge(i)||c.push(i=te(i));const u=gt(i),g=gt(l);let y=h[0],A=h[1],p=h[2],w=h[3];for(let k=0;k+4<=u.length;){const v=y,m=A,E=p,U=w;y=u[k+0],A=u[k+1],p=u[k+2],w=u[k+3];const{s0:K,s1:P,s2:B,s3:b}=rs(a,y,A,p,w);g[k++]=K^v,g[k++]=P^m,g[k++]=B^E,g[k++]=b^U}return Gt(...c),function(k,v){if(!v)return k;const m=k.length;if(!m)throw Error("aes/pcks5: empty ciphertext not allowed");const E=k[m-1];if(E<=0||E>16)throw Error("aes/pcks5: wrong padding");const U=k.subarray(0,-E);for(let K=0;K<E;K++)if(k[m-K-1]!==E)throw Error("aes/pcks5: wrong padding");return U}(l,r)}}}),ko=Wn({blockSize:16,nonceLength:16},function(n,t){function e(r,i,s){ct(r);const a=r.length;s=$n(a,s);const o=qr(n);let c=t;const h=[o];ge(c)||h.push(c=te(c)),ge(r)||h.push(r=te(r));const l=gt(r),u=gt(s),g=i?u:l,y=gt(c);let A=y[0],p=y[1],w=y[2],k=y[3];for(let m=0;m+4<=l.length;){const{s0:E,s1:U,s2:K,s3:P}=Ee(o,A,p,w,k);u[m+0]=l[m+0]^E,u[m+1]=l[m+1]^U,u[m+2]=l[m+2]^K,u[m+3]=l[m+3]^P,A=g[m++],p=g[m++],w=g[m++],k=g[m++]}const v=Yt*Math.floor(l.length/4);if(v<a){({s0:A,s1:p,s2:w,s3:k}=Ee(o,A,p,w,k));const m=xa(new Uint32Array([A,p,w,k]));for(let E=v,U=0;E<a;E++,U++)s[E]=r[E]^m[U];Gt(m)}return Gt(...h),s}return ct(n),ct(t,16),{encrypt:(r,i)=>e(r,!0,i),decrypt:(r,i)=>e(r,!1,i)}}),ai=Wn({blockSize:16,nonceLength:12,tagLength:16},function(n,t,e){if(ct(n),ct(t),e!==void 0&&ct(e),t.length<8)throw Error("aes/gcm: invalid nonce length");const r=16;function i(a,o,c){const h=function(l,u,g,y,A){const p=A==null?0:A.length,w=l.create(g,y.length+p);A&&w.update(A),w.update(y);const k=new Uint8Array(16),v=Li(k);A&&As(v,0,BigInt(8*p),u),As(v,8,BigInt(8*y.length),u),w.update(k);const m=w.digest();return Gt(k),m}(mo,!1,a,c,e);for(let l=0;l<o.length;l++)h[l]^=o[l];return h}function s(){const a=qr(n),o=si.slice(),c=si.slice();if(Pn(a,!1,c,c,o),t.length===12)c.set(t);else{const h=si.slice();As(Li(h),8,BigInt(8*t.length),!1);const l=mo.create(o).update(t).update(h);l.digestInto(c),l.destroy()}return{xk:a,authKey:o,counter:c,tagMask:Pn(a,!1,c,si)}}return{encrypt(a){ct(a);const{xk:o,authKey:c,counter:h,tagMask:l}=s(),u=new Uint8Array(a.length+r),g=[o,c,h,l];ge(a)||g.push(a=te(a)),Pn(o,!1,h,a,u);const y=i(c,l,u.subarray(0,u.length-r));return g.push(y),u.set(y,a.length),Gt(...g),u},decrypt(a){if(ct(a),a.length<r)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:o,authKey:c,counter:h,tagMask:l}=s(),u=[o,c,l,h];ge(a)||u.push(a=te(a));const g=a.subarray(0,-16),y=a.subarray(-16),A=i(c,l,g);if(u.push(A),!p3(A,y))throw Error("aes/gcm: invalid ghash tag");const p=Pn(o,!1,h,g);return Gt(...u),p}}});function k3(n){return n!=null&&typeof n=="object"&&(n instanceof Uint32Array||n.constructor.name==="Uint32Array")}function B3(n,t){if(ct(t,16),!k3(n))throw Error("_encryptBlock accepts result of expandKeyLE");const e=gt(t);let{s0:r,s1:i,s2:s,s3:a}=Ee(n,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=i,e[2]=s,e[3]=a,t}function I3(n,t){if(ct(t,16),!k3(n))throw Error("_decryptBlock accepts result of expandKeyLE");const e=gt(t);let{s0:r,s1:i,s2:s,s3:a}=rs(n,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=i,e[2]=s,e[3]=a,t}const Bo={encrypt(n,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const e=qr(n);if(t.length===16)B3(e,t);else{const r=gt(t);let i=r[0],s=r[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<r.length;c+=2,o++){const{s0:h,s1:l,s2:u,s3:g}=Ee(e,i,s,r[c],r[c+1]);i=h,s=l^Eo(o),r[c]=u,r[c+1]=g}r[0]=i,r[1]=s}e.fill(0)},decrypt(n,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const e=Da(n),r=t.length/8-1;if(r===1)I3(e,t);else{const i=gt(t);let s=i[0],a=i[1];for(let o=0,c=6*r;o<6;o++)for(let h=2*r;h>=1;h-=2,c--){a^=Eo(c);const{s0:l,s1:u,s2:g,s3:y}=rs(e,s,a,i[h],i[h+1]);s=l,a=u,i[h]=g,i[h+1]=y}i[0]=s,i[1]=a}e.fill(0)}},Io=new Uint8Array(8).fill(166),v3=Wn({blockSize:8},n=>({encrypt(t){if(ct(t),!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(t.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const e=function(...r){let i=0;for(let a=0;a<r.length;a++){const o=r[a];ct(o),i+=o.length}const s=new Uint8Array(i);for(let a=0,o=0;a<r.length;a++){const c=r[a];s.set(c,o),o+=c.length}return s}(Io,t);return Bo.encrypt(n,e),e},decrypt(t){if(ct(t),t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const e=te(t);if(Bo.decrypt(n,e),!p3(e.subarray(0,8),Io))throw Error("integrity check failed");return e.subarray(0,8).fill(0),e.subarray(8)}})),vo={expandKeyLE:qr,expandKeyDecLE:Da,encrypt:Ee,decrypt:rs,encryptBlock:B3,decryptBlock:I3,ctrCounter:m3,ctr32:Pn},ki=d.getWebCrypto(),Fn=d.getNodeCrypto(),vr=Fn?Fn.getCiphers():[],oi={idea:vr.includes("idea-cfb")?"idea-cfb":void 0,tripledes:vr.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:vr.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:vr.includes("bf-cfb")?"bf-cfb":void 0,aes128:vr.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:vr.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:vr.includes("aes-256-cfb")?"aes-256-cfb":void 0};class So{constructor(t,e,r){const{blockSize:i}=Ft(t);this.key=e,this.prevBlock=r,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(t){const{keySize:e}=Ft(t);return ki.importKey("raw",new Uint8Array(e),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(t,e){const r="AES-CBC";this.keyRef=this.keyRef||await ki.importKey("raw",this.key,r,!1,["encrypt"]);const i=await ki.encrypt({name:r,iv:e||this.zeroBlock},this.keyRef,t);return new Uint8Array(i).subarray(0,t.length)}async encryptChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=d.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=d.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=await this._runCBC(o);return ci(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,c}let i;if(this.i+=r.length,this.i===this.nextBlock.length){const s=this.nextBlock;i=await this._runCBC(this.prevBlock),ci(i,s),this.prevBlock=i.slice(),this.i=0;const a=t.subarray(r.length);this.nextBlock.set(a,this.i),this.i+=a.length}else i=new Uint8Array;return i}async finish(){let t;if(this.i===0)t=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const e=this.nextBlock,r=await this._runCBC(this.prevBlock);ci(r,e),t=r.subarray(0,e.length)}return this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(t){const e=(await this._runCBC(d.concatUint8Array([new Uint8Array(this.blockSize),t]),this.iv)).subarray(0,t.length);return ci(e,t),this.clearSensitiveData(),e}}class Co{constructor(t,e,r,i){this.forEncryption=t;const{blockSize:s}=Ft(e);this.key=vo.expandKeyLE(r),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=bs(i),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(t){const e=bs(t),r=new Uint8Array(t.length),i=bs(r);for(let s=0;s+4<=i.length;s+=4){const{s0:a,s1:o,s2:c,s3:h}=vo.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[s+0]=e[s+0]^a,i[s+1]=e[s+1]^o,i[s+2]=e[s+2]^c,i[s+3]=e[s+3]^h,this.prevBlock=(this.forEncryption?i:e).slice(s,s+4)}return r}async processChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=d.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,o}let i;if(this.i+=r.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;const s=t.subarray(r.length);this.nextBlock.set(s,this.i),this.i+=s.length}else i=new Uint8Array;return i}async finish(){let t;return this.i===0?t=new Uint8Array:t=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function ci(n,t){const e=Math.min(n.length,t.length);for(let r=0;r<e;r++)n[r]=n[r]^t[r]}const bs=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));var a5=Object.freeze({__proto__:null,decrypt:async function(n,t,e,r){const i=f.read(f.symmetric,n);if(Fn&&oi[i])return function(l,u,g,y){const A=f.read(f.symmetric,l),p=new Fn.createDecipheriv(oi[A],u,y);return Et(g,w=>new Uint8Array(p.update(w)))}(n,t,e,r);if(d.isAES(n))return async function(l,u,g,y){if(d.isStream(g)){const A=new Co(!1,l,u,y);return Et(g,p=>A.processChunk(p),()=>A.finish())}return ko(u,y).decrypt(g)}(n,t,e,r);const s=new(await ta(n))(t),a=s.blockSize;let o=r,c=new Uint8Array;const h=l=>{l&&(c=d.concatUint8Array([c,l]));const u=new Uint8Array(c.length);let g,y=0;for(;l?c.length>=a:c.length;){const A=s.encrypt(o);for(o=c.subarray(0,a),g=0;g<a;g++)u[y++]=o[g]^A[g];c=c.subarray(a)}return u.subarray(0,y)};return Et(e,h,h)},encrypt:async function(n,t,e,r,i){const s=f.read(f.symmetric,n);if(d.getNodeCrypto()&&oi[s])return function(u,g,y,A){const p=f.read(f.symmetric,u),w=new Fn.createCipheriv(oi[p],g,A);return Et(y,k=>new Uint8Array(w.update(k)))}(n,t,e,r);if(d.isAES(n))return async function(u,g,y,A){if(ki&&await So.isSupported(u)){const p=new So(u,g,A);return d.isStream(y)?Et(y,w=>p.encryptChunk(w),()=>p.finish()):p.encrypt(y)}if(d.isStream(y)){const p=new Co(!0,u,g,A);return Et(y,w=>p.processChunk(w),()=>p.finish())}return ko(g,A).encrypt(y)}(n,t,e,r);const a=new(await ta(n))(t),o=a.blockSize,c=r.slice();let h=new Uint8Array;const l=u=>{u&&(h=d.concatUint8Array([h,u]));const g=new Uint8Array(h.length);let y,A=0;for(;u?h.length>=o:h.length;){const p=a.encrypt(c);for(y=0;y<o;y++)c[y]=h[y]^p[y],g[A++]=c[y];h=h.subarray(o)}return g.subarray(0,A)};return Et(e,l,l)}});const xo=d.getWebCrypto(),o5=d.getNodeCrypto(),wr=16;function Uo(n,t){const e=n.length-wr;for(let r=0;r<wr;r++)n[r+e]^=t[r];return n}const Bi=new Uint8Array(wr);async function c5(n){const t=await l5(n),e=d.double(await t(Bi)),r=d.double(e);return async function(i){return(await t(function(s,a,o){if(s.length&&s.length%wr==0)return Uo(s,a);const c=new Uint8Array(s.length+(wr-s.length%wr));return c.set(s),c[s.length]=128,Uo(c,o)}(i,e,r))).subarray(-16)}}async function l5(n){if(d.getNodeCrypto())return async function(t){const e=new o5.createCipheriv("aes-"+8*n.length+"-cbc",n,Bi).update(t);return new Uint8Array(e)};if(d.getWebCrypto())try{return n=await xo.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),async function(t){const e=await xo.encrypt({name:"AES-CBC",iv:Bi,length:8*wr},n,t);return new Uint8Array(e).subarray(0,e.byteLength-wr)}}catch(t){if(t.name!=="NotSupportedError"&&(n.length!==24||t.name!=="OperationError"))throw t;d.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return E3(n,Bi,{disablePadding:!0}).encrypt(t)}}const Ko=d.getWebCrypto(),h5=d.getNodeCrypto(),u5=d.getNodeBuffer(),Ye=16,f5=Ye,Ii=Ye,Po=new Uint8Array(Ye),ra=new Uint8Array(Ye);ra[Ye-1]=1;const na=new Uint8Array(Ye);async function g5(n){const t=await c5(n);return function(e,r){return t(d.concatUint8Array([e,r]))}}async function y5(n){if(d.getNodeCrypto())return async function(t,e){const r=new h5.createCipheriv("aes-"+8*n.length+"-ctr",n,e),i=u5.concat([r.update(t),r.final()]);return new Uint8Array(i)};if(d.getWebCrypto())try{const t=await Ko.importKey("raw",n,{name:"AES-CTR",length:8*n.length},!1,["encrypt"]);return async function(e,r){const i=await Ko.encrypt({name:"AES-CTR",counter:r,length:8*Ye},t,e);return new Uint8Array(i)}}catch(t){if(t.name!=="NotSupportedError"&&(n.length!==24||t.name!=="OperationError"))throw t;d.printDebugError("Browser did not support operation: "+t.message)}return async function(t,e){return s5(n,e).encrypt(t)}}async function Dn(n,t){if(n!==f.symmetric.aes128&&n!==f.symmetric.aes192&&n!==f.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[e,r]=await Promise.all([g5(t),y5(t)]);return{encrypt:async function(i,s,a){const[o,c]=await Promise.all([e(Po,s),e(ra,a)]),h=await r(i,o),l=await e(na,h);for(let u=0;u<Ii;u++)l[u]^=c[u]^o[u];return d.concatUint8Array([h,l])},decrypt:async function(i,s,a){if(i.length<Ii)throw Error("Invalid EAX ciphertext");const o=i.subarray(0,-16),c=i.subarray(-16),[h,l,u]=await Promise.all([e(Po,s),e(ra,a),e(na,o)]),g=u;for(let y=0;y<Ii;y++)g[y]^=l[y]^h[y];if(!d.equalsUint8Array(c,g))throw Error("Authentication tag mismatch");return await r(o,h)}}}na[Ye-1]=2,Dn.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[8+r]^=t[r];return e},Dn.blockLength=Ye,Dn.ivLength=f5,Dn.tagLength=Ii;const ie=16,ia=16;function Do(n){let t=0;for(let e=1;!(n&e);e<<=1)t++;return t}function Vt(n,t){for(let e=0;e<n.length;e++)n[e]^=t[e];return n}function li(n,t){return Vt(n.slice(),t)}const hi=new Uint8Array(ie),p5=new Uint8Array([1]);async function Qn(n,t){const{keySize:e}=Ft(n);if(!d.isAES(n)||t.length!==e)throw Error("Unexpected algorithm or key size");let r=0;const i=E3(t,hi,{disablePadding:!0}),s=h=>i.encrypt(h),a=h=>i.decrypt(h);let o;function c(h,l,u,g){const y=l.length/ie|0;(function(B,b){const x=d.nbits(Math.max(B.length,b.length)/ie|0)-1;for(let C=r+1;C<=x;C++)o[C]=d.double(o[C-1]);r=x})(l,g);const A=d.concatUint8Array([hi.subarray(0,15-u.length),p5,u]),p=63&A[15];A[15]&=192;const w=s(A),k=d.concatUint8Array([w,li(w.subarray(0,8),w.subarray(1,9))]),v=d.shiftRight(k.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),m=new Uint8Array(ie),E=new Uint8Array(l.length+ia);let U,K=0;for(U=0;U<y;U++)Vt(v,o[Do(U+1)]),E.set(Vt(h(li(v,l)),v),K),Vt(m,h===s?l:E.subarray(K)),l=l.subarray(ie),K+=ie;if(l.length){Vt(v,o.x);const B=s(v);E.set(li(l,B),K);const b=new Uint8Array(ie);b.set(h===s?l:E.subarray(K,-16),0),b[l.length]=128,Vt(m,b),K+=l.length}const P=Vt(s(Vt(Vt(m,v),o.$)),function(B){if(!B.length)return hi;const b=B.length/ie|0,x=new Uint8Array(ie),C=new Uint8Array(ie);for(let S=0;S<b;S++)Vt(x,o[Do(S+1)]),Vt(C,s(li(x,B))),B=B.subarray(ie);if(B.length){Vt(x,o.x);const S=new Uint8Array(ie);S.set(B,0),S[B.length]=128,Vt(S,x),Vt(C,s(S))}return C}(g));return E.set(P,K),E}return function(){const h=s(hi),l=d.double(h);o=[],o[0]=d.double(l),o.x=h,o.$=l}(),{encrypt:async function(h,l,u){return c(s,h,l,u)},decrypt:async function(h,l,u){if(h.length<ia)throw Error("Invalid OCB ciphertext");const g=h.subarray(-16);h=h.subarray(0,-16);const y=c(a,h,l,u);if(d.equalsUint8Array(g,y.subarray(-16)))return y.subarray(0,-16);throw Error("Authentication tag mismatch")}}}Qn.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[7+r]^=t[r];return e},Qn.blockLength=ie,Qn.ivLength=15,Qn.tagLength=ia;const ms=d.getWebCrypto(),Qo=d.getNodeCrypto(),Ro=d.getNodeBuffer(),vi=16,Es="AES-GCM";async function sn(n,t){if(n!==f.symmetric.aes128&&n!==f.symmetric.aes192&&n!==f.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(d.getNodeCrypto())return{encrypt:async function(e,r,i=new Uint8Array){const s=new Qo.createCipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(i);const a=Ro.concat([s.update(e),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(e,r,i=new Uint8Array){const s=new Qo.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(i),s.setAuthTag(e.slice(e.length-vi,e.length));const a=Ro.concat([s.update(e.slice(0,e.length-vi)),s.final()]);return new Uint8Array(a)}};if(d.getWebCrypto())try{const e=await ms.importKey("raw",t,{name:Es},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(i,s,a=new Uint8Array){if(r&&!i.length)return ai(t,s,a).encrypt(i);const o=await ms.encrypt({name:Es,iv:s,additionalData:a,tagLength:128},e,i);return new Uint8Array(o)},decrypt:async function(i,s,a=new Uint8Array){if(r&&i.length===vi)return ai(t,s,a).decrypt(i);try{const o=await ms.decrypt({name:Es,iv:s,additionalData:a,tagLength:128},e,i);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(e){if(e.name!=="NotSupportedError"&&(t.length!==24||e.name!=="OperationError"))throw e;d.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,i){return ai(t,r,i).encrypt(e)},decrypt:async function(e,r,i){return ai(t,r,i).decrypt(e)}}}sn.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[4+r]^=t[r];return e},sn.blockLength=16,sn.ivLength=12,sn.tagLength=vi;var S3={cfb:a5,gcm:sn,experimentalGCM:sn,eax:Dn,ocb:Qn};const re=BigInt(0),ln=BigInt(1);function V(n){const t="0123456789ABCDEF";let e="";return n.forEach(r=>{e+=t[r>>4]+t[15&r]}),BigInt("0x0"+e)}function it(n,t){const e=n%t;return e<re?e+t:e}function Dt(n,t,e){if(e===re)throw Error("Modulo cannot be zero");if(e===ln)return BigInt(0);if(t<re)throw Error("Unsopported negative exponent");let r=t,i=n;i%=e;let s=BigInt(1);for(;r>re;){const a=r&ln;r>>=ln,s=a?s*i%e:s,i=i*i%e}return s}function _o(n){return n>=re?n:-n}function hn(n,t){const{gcd:e,x:r}=function(i,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),h=BigInt(0),l=_o(i),u=_o(s);const g=i<re,y=s<re;for(;u!==re;){const A=l/u;let p=a;a=c-A*a,c=p,p=o,o=h-A*o,h=p,p=u,u=l%u,l=p}return{x:g?-c:c,y:y?-h:h,gcd:l}}(n,t);if(e!==ln)throw Error("Inverse does not exist");return it(r+t,t)}function sa(n){const t=Number(n);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function d5(n,t){return(n>>BigInt(t)&ln)===re?0:1}function gn(n){const t=n<re?BigInt(-1):re;let e=1,r=n;for(;(r>>=ln)!==t;)e++;return e}function Jt(n){const t=n<re?BigInt(-1):re,e=BigInt(8);let r=1,i=n;for(;(i>>=e)!==t;)r++;return r}function It(n,t="be",e){let r=n.toString(16);r.length%2==1&&(r="0"+r);const i=r.length/2,s=new Uint8Array(e||i),a=e?e-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(r.slice(2*o,2*o+2),16),o++;return t!=="be"&&s.reverse(),s}const A5=d.getNodeCrypto();function Je(n){const t=typeof crypto<"u"?crypto:A5?.webcrypto;if(t?.getRandomValues){const e=new Uint8Array(n);return t.getRandomValues(e)}throw Error("No secure random number generator available.")}function We(n,t){if(t<n)throw Error("Illegal parameter value: max <= min");const e=t-n;return it(V(Je(Jt(e)+8)),e)+n}var w5=Object.freeze({__proto__:null,getRandomBigInteger:We,getRandomBytes:Je});const ve=BigInt(1);function To(n,t,e){const r=BigInt(30),i=ve<<BigInt(n-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=We(i,i<<ve),o=sa(it(a,r));do a+=BigInt(s[o]),o=(o+s[o])%s.length,gn(a)>n&&(a=it(a,i<<ve),a+=i,o=sa(it(a,r)));while(!C3(a,t,e));return a}function C3(n,t,e){return(!t||function(r,i){let s=r,a=i;for(;a!==re;){const o=a;a=s%a,s=o}return s}(n-ve,t)===ve)&&!!function(r){const i=BigInt(0);return b5.every(s=>it(r,s)!==i)}(n)&&!!function(r,i=BigInt(2)){return Dt(i,r-ve,r)===ve}(n)&&!!function(r,i){const s=gn(r);i||(i=Math.max(1,s/48|0));const a=r-ve;let o=0;for(;!d5(a,o);)o++;const c=r>>BigInt(o);for(;i>0;i--){let h,l=Dt(We(BigInt(2),a),c,r);if(l!==ve&&l!==a){for(h=1;h<o;h++){if(l=it(l*l,r),l===ve)return!1;if(l===a)break}if(h===o)return!1}}return!0}(n,e)}const b5=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(n=>BigInt(n)),Se=[];function Qa(n,t){const e=n.length;if(e>t-11)throw Error("Message too long");const r=function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const c=Je(s-o);for(let h=0;h<c.length;h++)c[h]!==0&&(a[o++]=c[h])}return a}(t-e-3),i=new Uint8Array(t);return i[1]=2,i.set(r,2),i.set(n,t-e),i}function Ra(n,t){let e=2,r=1;for(let o=e;o<n.length;o++)r&=n[o]!==0,e+=r;const i=e-2,s=n.subarray(e+1),a=n[0]===0&n[1]===2&i>=8&!r;if(t)return d.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function aa(n,t,e){let r;if(t.length!==ce.getHashByteLength(n))throw Error("Invalid hash length");const i=new Uint8Array(Se[n].length);for(r=0;r<Se[n].length;r++)i[r]=Se[n][r];const s=i.length+t.length;if(e<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(e-s-3).fill(255),o=new Uint8Array(e);return o[1]=1,o.set(a,2),o.set(i,e-s),o.set(t,e-t.length),o}Se[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Se[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Se[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Se[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Se[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Se[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Se[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var m5=Object.freeze({__proto__:null,emeDecode:Ra,emeEncode:Qa,emsaEncode:aa});const Zr=d.getWebCrypto(),Sr=d.getNodeCrypto(),fr=BigInt(1);async function ks(n,t,e,r,i,s){const a=V(r),o=V(i),c=V(e);let h=it(c,o-fr),l=it(c,a-fr);return l=It(l),h=It(h),{kty:"RSA",n:qt(n),e:qt(t),d:qt(e),p:qt(i),q:qt(r),dp:qt(h),dq:qt(l),qi:qt(s),ext:!0}}function Bs(n,t){return{kty:"RSA",n:qt(n),e:qt(t),ext:!0}}function Lo(n,t){return{n:me(n.n),e:It(t),d:me(n.d),p:me(n.q),q:me(n.p),u:me(n.qi)}}var E5=Object.freeze({__proto__:null,decrypt:async function(n,t,e,r,i,s,a,o){if(d.getNodeCrypto()&&!o)try{return await async function(c,h,l,u,g,y,A){const p=await ks(h,l,u,g,y,A),w={key:p,format:"jwk",type:"pkcs1",padding:Sr.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Sr.privateDecrypt(w,c))}catch{throw Error("Decryption error")}}(n,t,e,r,i,s,a)}catch(c){d.printDebugError(c)}return async function(c,h,l,u,g,y,A,p){if(c=V(c),h=V(h),l=V(l),u=V(u),g=V(g),y=V(y),A=V(A),c>=h)throw Error("Data too large.");const w=it(u,y-fr),k=it(u,g-fr),v=We(BigInt(2),h),m=Dt(hn(v,h),l,h);c=it(c*m,h);const E=Dt(c,k,g),U=Dt(c,w,y);let P=it(A*(U-E),y)*g+E;return P=it(P*v,h),Ra(It(P,"be",Jt(h)),p)}(n,t,e,r,i,s,a,o)},encrypt:async function(n,t,e){return d.getNodeCrypto()?async function(r,i,s){const a=Bs(i,s),o={key:a,format:"jwk",type:"pkcs1",padding:Sr.constants.RSA_PKCS1_PADDING};return new Uint8Array(Sr.publicEncrypt(o,r))}(n,t,e):async function(r,i,s){if(i=V(i),r=V(Qa(r,Jt(i))),s=V(s),r>=i)throw Error("Message size cannot exceed modulus size");return It(Dt(r,s,i),"be",Jt(i))}(n,t,e)},generate:async function(n,t){if(t=BigInt(t),d.getWebCrypto()){const a={name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:It(t),hash:{name:"SHA-1"}},o=await Zr.generateKey(a,!0,["sign","verify"]);return Lo(await Zr.exportKey("jwk",o.privateKey),t)}if(d.getNodeCrypto()){const a={modulusLength:n,publicExponent:sa(t),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},o=await new Promise((c,h)=>{Sr.generateKeyPair("rsa",a,(l,u,g)=>{l?h(l):c(g)})});return Lo(o,t)}let e,r,i;do r=To(n-(n>>1),t,40),e=To(n>>1,t,40),i=e*r;while(gn(i)!==n);const s=(e-fr)*(r-fr);return r<e&&([e,r]=[r,e]),{n:It(i),e:It(t),d:It(hn(t,s)),p:It(e),q:It(r),u:It(hn(e,r))}},sign:async function(n,t,e,r,i,s,a,o,c){if(ce.getHashByteLength(n)>=e.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!d.isStream(t)){if(d.getWebCrypto())try{return await async function(h,l,u,g,y,A,p,w){const k=await ks(u,g,y,A,p,w),v={name:"RSASSA-PKCS1-v1_5",hash:{name:h}},m=await Zr.importKey("jwk",k,v,!1,["sign"]);return new Uint8Array(await Zr.sign("RSASSA-PKCS1-v1_5",m,l))}(f.read(f.webHash,n),t,e,r,i,s,a,o)}catch(h){d.printDebugError(h)}else if(d.getNodeCrypto())return async function(h,l,u,g,y,A,p,w){const k=Sr.createSign(f.read(f.hash,h));k.write(l),k.end();const v=await ks(u,g,y,A,p,w);return new Uint8Array(k.sign({key:v,format:"jwk",type:"pkcs1"}))}(n,t,e,r,i,s,a,o)}return async function(h,l,u,g){l=V(l);const y=V(aa(h,g,Jt(l)));return u=V(u),It(Dt(y,u,l),"be",Jt(l))}(n,e,i,c)},validateParams:async function(n,t,e,r,i,s){if(n=V(n),(r=V(r))*(i=V(i))!==n)return!1;const a=BigInt(2);if(it(r*(s=V(s)),i)!==BigInt(1))return!1;t=V(t),e=V(e);const o=We(a,a<<BigInt(Math.floor(gn(n)/3))),c=o*e*t;return!(it(c,r-fr)!==o||it(c,i-fr)!==o)},verify:async function(n,t,e,r,i,s){if(t&&!d.isStream(t)){if(d.getWebCrypto())try{return await async function(a,o,c,h,l){const u=Bs(h,l),g=await Zr.importKey("jwk",u,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return Zr.verify("RSASSA-PKCS1-v1_5",g,c,o)}(f.read(f.webHash,n),t,e,r,i)}catch(a){d.printDebugError(a)}else if(d.getNodeCrypto())return async function(a,o,c,h,l){const u=Bs(h,l),g={key:u,format:"jwk",type:"pkcs1"},y=Sr.createVerify(f.read(f.hash,a));y.write(o),y.end();try{return y.verify(g,c)}catch{return!1}}(n,t,e,r,i)}return async function(a,o,c,h,l){if(c=V(c),o=V(o),h=V(h),o>=c)throw Error("Signature size cannot exceed modulus size");const u=It(Dt(o,h,c),"be",Jt(c)),g=aa(a,l,Jt(c));return d.equalsUint8Array(u,g)}(n,e,r,i,s)}});const nr=BigInt(1);var k5=Object.freeze({__proto__:null,decrypt:async function(n,t,e,r,i){return n=V(n),t=V(t),e=V(e),Ra(It(it(hn(Dt(n,r=V(r),e),e)*t,e),"be",Jt(e)),i)},encrypt:async function(n,t,e,r){t=V(t),e=V(e),r=V(r);const i=V(Qa(n,Jt(t))),s=We(nr,t-nr);return{c1:It(Dt(e,s,t)),c2:It(it(Dt(r,s,t)*i,t))}},validateParams:async function(n,t,e,r){if(n=V(n),t=V(t),e=V(e),t<=nr||t>=n)return!1;const i=BigInt(gn(n));if(i<BigInt(1023)||Dt(t,n-nr,n)!==nr)return!1;let s=t,a=BigInt(1);const o=BigInt(2),c=o<<BigInt(17);for(;a<c;){if(s=it(s*t,n),s===nr)return!1;a++}r=V(r);const h=We(o<<i-nr,o<<i);return e===Dt(t,(n-nr)*h+r,n)}});const Is=typeof Ot=="object"&&"crypto"in Ot?Ot.crypto:void 0,At={};var j=function(n){var t,e=new Float64Array(16);if(n)for(t=0;t<n.length;t++)e[t]=n[t];return e},oa=function(){throw Error("no PRNG")},x3=new Uint8Array(32);x3[0]=9;var ca=j(),Mi=j([1]),B5=j([56129,1]),I5=j([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v5=j([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Mo=j([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),No=j([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S5=j([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function zo(n,t,e,r){n[t]=e>>24&255,n[t+1]=e>>16&255,n[t+2]=e>>8&255,n[t+3]=255&e,n[t+4]=r>>24&255,n[t+5]=r>>16&255,n[t+6]=r>>8&255,n[t+7]=255&r}function U3(n,t,e,r){return function(i,s,a,o,c){var h,l=0;for(h=0;h<c;h++)l|=i[s+h]^a[o+h];return(1&l-1>>>8)-1}(n,t,e,r,32)}function pr(n,t){var e;for(e=0;e<16;e++)n[e]=0|t[e]}function vs(n){var t,e,r=1;for(t=0;t<16;t++)e=n[t]+r+65535,r=Math.floor(e/65536),n[t]=e-65536*r;n[0]+=r-1+37*(r-1)}function an(n,t,e){for(var r,i=~(e-1),s=0;s<16;s++)r=i&(n[s]^t[s]),n[s]^=r,t[s]^=r}function jn(n,t){var e,r,i,s=j(),a=j();for(e=0;e<16;e++)a[e]=t[e];for(vs(a),vs(a),vs(a),r=0;r<2;r++){for(s[0]=a[0]-65517,e=1;e<15;e++)s[e]=a[e]-65535-(s[e-1]>>16&1),s[e-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,an(a,s,1-i)}for(e=0;e<16;e++)n[2*e]=255&a[e],n[2*e+1]=a[e]>>8}function Ho(n,t){var e=new Uint8Array(32),r=new Uint8Array(32);return jn(e,n),jn(r,t),U3(e,0,r,0)}function K3(n){var t=new Uint8Array(32);return jn(t,n),1&t[0]}function P3(n,t){var e;for(e=0;e<16;e++)n[e]=t[2*e]+(t[2*e+1]<<8);n[15]&=32767}function Ue(n,t,e){for(var r=0;r<16;r++)n[r]=t[r]+e[r]}function Pe(n,t,e){for(var r=0;r<16;r++)n[r]=t[r]-e[r]}function st(n,t,e){var r,i,s=0,a=0,o=0,c=0,h=0,l=0,u=0,g=0,y=0,A=0,p=0,w=0,k=0,v=0,m=0,E=0,U=0,K=0,P=0,B=0,b=0,x=0,C=0,S=0,I=0,D=0,Q=0,R=0,T=0,G=0,H=0,L=e[0],M=e[1],_=e[2],z=e[3],N=e[4],O=e[5],q=e[6],X=e[7],Y=e[8],nt=e[9],tt=e[10],ot=e[11],ht=e[12],mt=e[13],kt=e[14],Bt=e[15];s+=(r=t[0])*L,a+=r*M,o+=r*_,c+=r*z,h+=r*N,l+=r*O,u+=r*q,g+=r*X,y+=r*Y,A+=r*nt,p+=r*tt,w+=r*ot,k+=r*ht,v+=r*mt,m+=r*kt,E+=r*Bt,a+=(r=t[1])*L,o+=r*M,c+=r*_,h+=r*z,l+=r*N,u+=r*O,g+=r*q,y+=r*X,A+=r*Y,p+=r*nt,w+=r*tt,k+=r*ot,v+=r*ht,m+=r*mt,E+=r*kt,U+=r*Bt,o+=(r=t[2])*L,c+=r*M,h+=r*_,l+=r*z,u+=r*N,g+=r*O,y+=r*q,A+=r*X,p+=r*Y,w+=r*nt,k+=r*tt,v+=r*ot,m+=r*ht,E+=r*mt,U+=r*kt,K+=r*Bt,c+=(r=t[3])*L,h+=r*M,l+=r*_,u+=r*z,g+=r*N,y+=r*O,A+=r*q,p+=r*X,w+=r*Y,k+=r*nt,v+=r*tt,m+=r*ot,E+=r*ht,U+=r*mt,K+=r*kt,P+=r*Bt,h+=(r=t[4])*L,l+=r*M,u+=r*_,g+=r*z,y+=r*N,A+=r*O,p+=r*q,w+=r*X,k+=r*Y,v+=r*nt,m+=r*tt,E+=r*ot,U+=r*ht,K+=r*mt,P+=r*kt,B+=r*Bt,l+=(r=t[5])*L,u+=r*M,g+=r*_,y+=r*z,A+=r*N,p+=r*O,w+=r*q,k+=r*X,v+=r*Y,m+=r*nt,E+=r*tt,U+=r*ot,K+=r*ht,P+=r*mt,B+=r*kt,b+=r*Bt,u+=(r=t[6])*L,g+=r*M,y+=r*_,A+=r*z,p+=r*N,w+=r*O,k+=r*q,v+=r*X,m+=r*Y,E+=r*nt,U+=r*tt,K+=r*ot,P+=r*ht,B+=r*mt,b+=r*kt,x+=r*Bt,g+=(r=t[7])*L,y+=r*M,A+=r*_,p+=r*z,w+=r*N,k+=r*O,v+=r*q,m+=r*X,E+=r*Y,U+=r*nt,K+=r*tt,P+=r*ot,B+=r*ht,b+=r*mt,x+=r*kt,C+=r*Bt,y+=(r=t[8])*L,A+=r*M,p+=r*_,w+=r*z,k+=r*N,v+=r*O,m+=r*q,E+=r*X,U+=r*Y,K+=r*nt,P+=r*tt,B+=r*ot,b+=r*ht,x+=r*mt,C+=r*kt,S+=r*Bt,A+=(r=t[9])*L,p+=r*M,w+=r*_,k+=r*z,v+=r*N,m+=r*O,E+=r*q,U+=r*X,K+=r*Y,P+=r*nt,B+=r*tt,b+=r*ot,x+=r*ht,C+=r*mt,S+=r*kt,I+=r*Bt,p+=(r=t[10])*L,w+=r*M,k+=r*_,v+=r*z,m+=r*N,E+=r*O,U+=r*q,K+=r*X,P+=r*Y,B+=r*nt,b+=r*tt,x+=r*ot,C+=r*ht,S+=r*mt,I+=r*kt,D+=r*Bt,w+=(r=t[11])*L,k+=r*M,v+=r*_,m+=r*z,E+=r*N,U+=r*O,K+=r*q,P+=r*X,B+=r*Y,b+=r*nt,x+=r*tt,C+=r*ot,S+=r*ht,I+=r*mt,D+=r*kt,Q+=r*Bt,k+=(r=t[12])*L,v+=r*M,m+=r*_,E+=r*z,U+=r*N,K+=r*O,P+=r*q,B+=r*X,b+=r*Y,x+=r*nt,C+=r*tt,S+=r*ot,I+=r*ht,D+=r*mt,Q+=r*kt,R+=r*Bt,v+=(r=t[13])*L,m+=r*M,E+=r*_,U+=r*z,K+=r*N,P+=r*O,B+=r*q,b+=r*X,x+=r*Y,C+=r*nt,S+=r*tt,I+=r*ot,D+=r*ht,Q+=r*mt,R+=r*kt,T+=r*Bt,m+=(r=t[14])*L,E+=r*M,U+=r*_,K+=r*z,P+=r*N,B+=r*O,b+=r*q,x+=r*X,C+=r*Y,S+=r*nt,I+=r*tt,D+=r*ot,Q+=r*ht,R+=r*mt,T+=r*kt,G+=r*Bt,E+=(r=t[15])*L,a+=38*(K+=r*_),o+=38*(P+=r*z),c+=38*(B+=r*N),h+=38*(b+=r*O),l+=38*(x+=r*q),u+=38*(C+=r*X),g+=38*(S+=r*Y),y+=38*(I+=r*nt),A+=38*(D+=r*tt),p+=38*(Q+=r*ot),w+=38*(R+=r*ht),k+=38*(T+=r*mt),v+=38*(G+=r*kt),m+=38*(H+=r*Bt),s=(r=(s+=38*(U+=r*M))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),k=(r=k+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),E=(r=E+i+65535)-65536*(i=Math.floor(r/65536)),s=(r=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),k=(r=k+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),E=(r=E+i+65535)-65536*(i=Math.floor(r/65536)),s+=i-1+37*(i-1),n[0]=s,n[1]=a,n[2]=o,n[3]=c,n[4]=h,n[5]=l,n[6]=u,n[7]=g,n[8]=y,n[9]=A,n[10]=p,n[11]=w,n[12]=k,n[13]=v,n[14]=m,n[15]=E}function be(n,t){st(n,t,t)}function D3(n,t){var e,r=j();for(e=0;e<16;e++)r[e]=t[e];for(e=253;e>=0;e--)be(r,r),e!==2&&e!==4&&st(r,r,t);for(e=0;e<16;e++)n[e]=r[e]}function Q3(n,t,e){var r,i,s=new Uint8Array(32),a=new Float64Array(80),o=j(),c=j(),h=j(),l=j(),u=j(),g=j();for(i=0;i<31;i++)s[i]=t[i];for(s[31]=127&t[31]|64,s[0]&=248,P3(a,e),i=0;i<16;i++)c[i]=a[i],l[i]=o[i]=h[i]=0;for(o[0]=l[0]=1,i=254;i>=0;--i)an(o,c,r=s[i>>>3]>>>(7&i)&1),an(h,l,r),Ue(u,o,h),Pe(o,o,h),Ue(h,c,l),Pe(c,c,l),be(l,u),be(g,o),st(o,h,o),st(h,c,u),Ue(u,o,h),Pe(o,o,h),be(c,o),Pe(h,l,g),st(o,h,B5),Ue(o,o,l),st(h,h,o),st(o,l,g),st(l,c,a),be(c,u),an(o,c,r),an(h,l,r);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=h[i],a[i+48]=c[i],a[i+64]=l[i];var y=a.subarray(32),A=a.subarray(16);return D3(y,y),st(A,A,y),jn(n,A),0}function Oo(n,t){return Q3(n,t,x3)}var Fo=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Go(n,t,e,r){for(var i,s,a,o,c,h,l,u,g,y,A,p,w,k,v,m,E,U,K,P,B,b,x,C,S,I,D=new Int32Array(16),Q=new Int32Array(16),R=n[0],T=n[1],G=n[2],H=n[3],L=n[4],M=n[5],_=n[6],z=n[7],N=t[0],O=t[1],q=t[2],X=t[3],Y=t[4],nt=t[5],tt=t[6],ot=t[7],ht=0;r>=128;){for(K=0;K<16;K++)P=8*K+ht,D[K]=e[P+0]<<24|e[P+1]<<16|e[P+2]<<8|e[P+3],Q[K]=e[P+4]<<24|e[P+5]<<16|e[P+6]<<8|e[P+7];for(K=0;K<80;K++)if(i=R,s=T,a=G,o=H,c=L,h=M,l=_,g=N,y=O,A=q,p=X,w=Y,k=nt,v=tt,x=65535&(b=ot),C=b>>>16,S=65535&(B=z),I=B>>>16,x+=65535&(b=(Y>>>14|L<<18)^(Y>>>18|L<<14)^(L>>>9|Y<<23)),C+=b>>>16,S+=65535&(B=(L>>>14|Y<<18)^(L>>>18|Y<<14)^(Y>>>9|L<<23)),I+=B>>>16,x+=65535&(b=Y&nt^~Y&tt),C+=b>>>16,S+=65535&(B=L&M^~L&_),I+=B>>>16,B=Fo[2*K],x+=65535&(b=Fo[2*K+1]),C+=b>>>16,S+=65535&B,I+=B>>>16,B=D[K%16],C+=(b=Q[K%16])>>>16,S+=65535&B,I+=B>>>16,S+=(C+=(x+=65535&b)>>>16)>>>16,x=65535&(b=U=65535&x|C<<16),C=b>>>16,S=65535&(B=E=65535&S|(I+=S>>>16)<<16),I=B>>>16,x+=65535&(b=(N>>>28|R<<4)^(R>>>2|N<<30)^(R>>>7|N<<25)),C+=b>>>16,S+=65535&(B=(R>>>28|N<<4)^(N>>>2|R<<30)^(N>>>7|R<<25)),I+=B>>>16,C+=(b=N&O^N&q^O&q)>>>16,S+=65535&(B=R&T^R&G^T&G),I+=B>>>16,u=65535&(S+=(C+=(x+=65535&b)>>>16)>>>16)|(I+=S>>>16)<<16,m=65535&x|C<<16,x=65535&(b=p),C=b>>>16,S=65535&(B=o),I=B>>>16,C+=(b=U)>>>16,S+=65535&(B=E),I+=B>>>16,T=i,G=s,H=a,L=o=65535&(S+=(C+=(x+=65535&b)>>>16)>>>16)|(I+=S>>>16)<<16,M=c,_=h,z=l,R=u,O=g,q=y,X=A,Y=p=65535&x|C<<16,nt=w,tt=k,ot=v,N=m,K%16==15)for(P=0;P<16;P++)B=D[P],x=65535&(b=Q[P]),C=b>>>16,S=65535&B,I=B>>>16,B=D[(P+9)%16],x+=65535&(b=Q[(P+9)%16]),C+=b>>>16,S+=65535&B,I+=B>>>16,E=D[(P+1)%16],x+=65535&(b=((U=Q[(P+1)%16])>>>1|E<<31)^(U>>>8|E<<24)^(U>>>7|E<<25)),C+=b>>>16,S+=65535&(B=(E>>>1|U<<31)^(E>>>8|U<<24)^E>>>7),I+=B>>>16,E=D[(P+14)%16],C+=(b=((U=Q[(P+14)%16])>>>19|E<<13)^(E>>>29|U<<3)^(U>>>6|E<<26))>>>16,S+=65535&(B=(E>>>19|U<<13)^(U>>>29|E<<3)^E>>>6),I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,D[P]=65535&S|I<<16,Q[P]=65535&x|C<<16;x=65535&(b=N),C=b>>>16,S=65535&(B=R),I=B>>>16,B=n[0],C+=(b=t[0])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[0]=R=65535&S|I<<16,t[0]=N=65535&x|C<<16,x=65535&(b=O),C=b>>>16,S=65535&(B=T),I=B>>>16,B=n[1],C+=(b=t[1])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[1]=T=65535&S|I<<16,t[1]=O=65535&x|C<<16,x=65535&(b=q),C=b>>>16,S=65535&(B=G),I=B>>>16,B=n[2],C+=(b=t[2])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[2]=G=65535&S|I<<16,t[2]=q=65535&x|C<<16,x=65535&(b=X),C=b>>>16,S=65535&(B=H),I=B>>>16,B=n[3],C+=(b=t[3])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[3]=H=65535&S|I<<16,t[3]=X=65535&x|C<<16,x=65535&(b=Y),C=b>>>16,S=65535&(B=L),I=B>>>16,B=n[4],C+=(b=t[4])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[4]=L=65535&S|I<<16,t[4]=Y=65535&x|C<<16,x=65535&(b=nt),C=b>>>16,S=65535&(B=M),I=B>>>16,B=n[5],C+=(b=t[5])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[5]=M=65535&S|I<<16,t[5]=nt=65535&x|C<<16,x=65535&(b=tt),C=b>>>16,S=65535&(B=_),I=B>>>16,B=n[6],C+=(b=t[6])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[6]=_=65535&S|I<<16,t[6]=tt=65535&x|C<<16,x=65535&(b=ot),C=b>>>16,S=65535&(B=z),I=B>>>16,B=n[7],C+=(b=t[7])>>>16,S+=65535&B,I+=B>>>16,I+=(S+=(C+=(x+=65535&b)>>>16)>>>16)>>>16,n[7]=z=65535&S|I<<16,t[7]=ot=65535&x|C<<16,ht+=128,r-=128}return r}function Rn(n,t,e){var r,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=e;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Go(i,s,t,e),e%=128,r=0;r<e;r++)a[r]=t[o-e+r];for(a[e]=128,a[(e=256-128*(e<112?1:0))-9]=0,zo(a,e-8,o/536870912|0,o<<3),Go(i,s,a,e),r=0;r<8;r++)zo(n,8*r,i[r],s[r]);return 0}function la(n,t){var e=j(),r=j(),i=j(),s=j(),a=j(),o=j(),c=j(),h=j(),l=j();Pe(e,n[1],n[0]),Pe(l,t[1],t[0]),st(e,e,l),Ue(r,n[0],n[1]),Ue(l,t[0],t[1]),st(r,r,l),st(i,n[3],t[3]),st(i,i,v5),st(s,n[2],t[2]),Ue(s,s,s),Pe(a,r,e),Pe(o,s,i),Ue(c,s,i),Ue(h,r,e),st(n[0],a,o),st(n[1],h,c),st(n[2],c,o),st(n[3],a,h)}function qo(n,t,e){var r;for(r=0;r<4;r++)an(n[r],t[r],e)}function ha(n,t){var e=j(),r=j(),i=j();D3(i,t[2]),st(e,t[0],i),st(r,t[1],i),jn(n,r),n[31]^=K3(e)<<7}function R3(n,t,e){var r,i;for(pr(n[0],ca),pr(n[1],Mi),pr(n[2],Mi),pr(n[3],ca),i=255;i>=0;--i)qo(n,t,r=e[i/8|0]>>(7&i)&1),la(t,n),la(n,n),qo(n,t,r)}function ua(n,t){var e=[j(),j(),j(),j()];pr(e[0],Mo),pr(e[1],No),pr(e[2],Mi),st(e[3],Mo,No),R3(n,e,t)}function $o(n,t,e){var r,i=new Uint8Array(64),s=[j(),j(),j(),j()];for(e||oa(t,32),Rn(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,ua(s,i),ha(n,s),r=0;r<32;r++)t[r+32]=n[r];return 0}var Ss=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function _3(n,t){var e,r,i,s;for(r=63;r>=32;--r){for(e=0,i=r-32,s=r-12;i<s;++i)t[i]+=e-16*t[r]*Ss[i-(r-32)],e=Math.floor((t[i]+128)/256),t[i]-=256*e;t[i]+=e,t[r]=0}for(e=0,i=0;i<32;i++)t[i]+=e-(t[31]>>4)*Ss[i],e=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=e*Ss[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,n[r]=255&t[r]}function Cs(n){var t,e=new Float64Array(64);for(t=0;t<64;t++)e[t]=n[t];for(t=0;t<64;t++)n[t]=0;_3(n,e)}function C5(n,t){var e=j(),r=j(),i=j(),s=j(),a=j(),o=j(),c=j();return pr(n[2],Mi),P3(n[1],t),be(i,n[1]),st(s,i,I5),Pe(i,i,n[2]),Ue(s,n[2],s),be(a,s),be(o,a),st(c,o,a),st(e,c,i),st(e,e,s),function(h,l){var u,g=j();for(u=0;u<16;u++)g[u]=l[u];for(u=250;u>=0;u--)be(g,g),u!==1&&st(g,g,l);for(u=0;u<16;u++)h[u]=g[u]}(e,e),st(e,e,i),st(e,e,s),st(e,e,s),st(n[0],e,s),be(r,n[0]),st(r,r,s),Ho(r,i)&&st(n[0],n[0],S5),be(r,n[0]),st(r,r,s),Ho(r,i)?-1:(K3(n[0])===t[31]>>7&&Pe(n[0],ca,n[0]),st(n[3],n[0],n[1]),0)}var Cr=64;function Yr(){for(var n=0;n<arguments.length;n++)if(!(arguments[n]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}At.scalarMult=function(n,t){if(Yr(n,t),n.length!==32)throw Error("bad n size");if(t.length!==32)throw Error("bad p size");var e=new Uint8Array(32);return Q3(e,n,t),e},At.box={},At.box.keyPair=function(){var n=new Uint8Array(32),t=new Uint8Array(32);return function(e,r){oa(r,32),Oo(e,r)}(n,t),{publicKey:n,secretKey:t}},At.box.keyPair.fromSecretKey=function(n){if(Yr(n),n.length!==32)throw Error("bad secret key size");var t=new Uint8Array(32);return Oo(t,n),{publicKey:t,secretKey:new Uint8Array(n)}},At.sign=function(n,t){if(Yr(n,t),t.length!==64)throw Error("bad secret key size");var e=new Uint8Array(Cr+n.length);return function(r,i,s,a){var o,c,h=new Uint8Array(64),l=new Uint8Array(64),u=new Uint8Array(64),g=new Float64Array(64),y=[j(),j(),j(),j()];for(Rn(h,a,32),h[0]&=248,h[31]&=127,h[31]|=64,o=0;o<s;o++)r[64+o]=i[o];for(o=0;o<32;o++)r[32+o]=h[32+o];for(Rn(u,r.subarray(32),s+32),Cs(u),ua(y,u),ha(r,y),o=32;o<64;o++)r[o]=a[o];for(Rn(l,r,s+64),Cs(l),o=0;o<64;o++)g[o]=0;for(o=0;o<32;o++)g[o]=u[o];for(o=0;o<32;o++)for(c=0;c<32;c++)g[o+c]+=l[o]*h[c];_3(r.subarray(32),g)}(e,n,n.length,t),e},At.sign.detached=function(n,t){for(var e=At.sign(n,t),r=new Uint8Array(Cr),i=0;i<r.length;i++)r[i]=e[i];return r},At.sign.detached.verify=function(n,t,e){if(Yr(n,t,e),t.length!==Cr)throw Error("bad signature size");if(e.length!==32)throw Error("bad public key size");var r,i=new Uint8Array(Cr+n.length),s=new Uint8Array(Cr+n.length);for(r=0;r<Cr;r++)i[r]=t[r];for(r=0;r<n.length;r++)i[r+Cr]=n[r];return function(a,o,c,h){var l,u=new Uint8Array(32),g=new Uint8Array(64),y=[j(),j(),j(),j()],A=[j(),j(),j(),j()];if(c<64||C5(A,h))return-1;for(l=0;l<c;l++)a[l]=o[l];for(l=0;l<32;l++)a[l+32]=h[l];if(Rn(g,a,c),Cs(g),R3(y,A,g),ua(A,o.subarray(32)),la(y,A),ha(u,y),c-=64,U3(o,0,u,0)){for(l=0;l<c;l++)a[l]=0;return-1}for(l=0;l<c;l++)a[l]=o[l+64];return c}(s,i,i.length,e)>=0},At.sign.keyPair=function(){var n=new Uint8Array(32),t=new Uint8Array(64);return $o(n,t),{publicKey:n,secretKey:t}},At.sign.keyPair.fromSecretKey=function(n){if(Yr(n),n.length!==64)throw Error("bad secret key size");for(var t=new Uint8Array(32),e=0;e<t.length;e++)t[e]=n[32+e];return{publicKey:t,secretKey:new Uint8Array(n)}},At.sign.keyPair.fromSeed=function(n){if(Yr(n),n.length!==32)throw Error("bad seed size");for(var t=new Uint8Array(32),e=new Uint8Array(64),r=0;r<32;r++)e[r]=n[r];return $o(t,e,!0),{publicKey:t,secretKey:e}},At.setPRNG=function(n){oa=n},function(){Is&&Is.getRandomValues&&At.setPRNG(function(n,t){var e,r=new Uint8Array(t);for(e=0;e<t;e+=65536)Is.getRandomValues(r.subarray(e,e+Math.min(t-e,65536)));for(e=0;e<t;e++)n[e]=r[e];(function(i){for(var s=0;s<i.length;s++)i[s]=0})(r)})}();const x5={"2a8648ce3d030107":f.curve.nistP256,"2b81040022":f.curve.nistP384,"2b81040023":f.curve.nistP521,"2b8104000a":f.curve.secp256k1,"2b06010401da470f01":f.curve.ed25519Legacy,"2b060104019755010501":f.curve.curve25519Legacy,"2b2403030208010107":f.curve.brainpoolP256r1,"2b240303020801010b":f.curve.brainpoolP384r1,"2b240303020801010d":f.curve.brainpoolP512r1};class $e{constructor(t){if(t instanceof $e)this.oid=t.oid;else if(d.isArray(t)||d.isUint8Array(t)){if((t=new Uint8Array(t))[0]===6){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.oid=t.subarray(1,1+e),1+this.oid.length}throw Error("Invalid oid")}write(){return d.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return d.uint8ArrayToHex(this.oid)}getName(){const t=x5[this.toHex()];if(!t)throw Error("Unknown curve object identifier.");return t}}function U5(n){let t,e=0;const r=n[0];return r<192?([e]=n,t=1):r<255?(e=(n[0]-192<<8)+n[1]+192,t=2):r===255&&(e=d.readNumber(n.subarray(1,5)),t=5),{len:e,offset:t}}function _a(n){return n<192?new Uint8Array([n]):n>191&&n<8384?new Uint8Array([192+(n-192>>8),n-192&255]):d.concatUint8Array([new Uint8Array([255]),d.writeNumber(n,4)])}function K5(n){if(n<0||n>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+n])}function T3(n){return new Uint8Array([192|n])}function jo(n,t){return d.concatUint8Array([T3(n),_a(t)])}function Si(n){return[f.packet.literalData,f.packet.compressedData,f.packet.symmetricallyEncryptedData,f.packet.symEncryptedIntegrityProtectedData,f.packet.aeadEncryptedData].includes(n)}async function P5(n,t){const e=tr(n);let r,i;try{const s=await e.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await e.readByte();let o,c,h=-1,l=-1;l=0,64&a&&(l=1),l?h=63&a:(h=(63&a)>>2,c=3&a);const u=Si(h);let g,y=null;if(u){if(d.isStream(n)==="array"){const p=new fe;r=le(p),y=p}else{const p=new TransformStream;r=le(p.writable),y=p.readable}i=t({tag:h,packet:y})}else y=[];do{if(l){const p=await e.readByte();if(g=!1,p<192)o=p;else if(p>=192&&p<224)o=(p-192<<8)+await e.readByte()+192;else if(p>223&&p<255){if(o=1<<(31&p),g=!0,!u)throw new TypeError("This packet type does not support partial lengths.")}else o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte()}else switch(c){case 0:o=await e.readByte();break;case 1:o=await e.readByte()<<8|await e.readByte();break;case 2:o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte();break;default:o=1/0}if(o>0){let p=0;for(;;){r&&await r.ready;const{done:w,value:k}=await e.read();if(w){if(o===1/0)break;throw Error("Unexpected end of packet")}const v=o===1/0?k:k.subarray(0,o-p);if(r?await r.write(v):y.push(v),p+=k.length,p>=o){e.unshift(k.subarray(o-p+k.length));break}}}}while(g);const A=await e.peekBytes(u?1/0:2);return r?(await r.ready,await r.close()):(y=d.concatUint8Array(y),await t({tag:h,packet:y})),!A||!A.length}catch(s){if(r)return await r.abort(s),!0;throw s}finally{r&&await i,e.releaseLock()}}class yt extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,yt),this.name="UnsupportedError"}}class L3 extends yt{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,yt),this.name="UnknownPacketError"}}class Vo{constructor(t,e){this.tag=t,this.rawContent=e}write(){return this.rawContent}}async function M3(n){switch(n){case f.publicKey.ed25519:try{const t=d.getWebCrypto(),e=await t.generateKey("Ed25519",!0,["sign","verify"]),r=await t.exportKey("jwk",e.privateKey),i=await t.exportKey("jwk",e.publicKey);return{A:new Uint8Array(me(i.x)),seed:me(r.d)}}catch(t){if(t.name!=="NotSupportedError"&&t.name!=="OperationError")throw t;const e=Je(H3(n)),{publicKey:r}=At.sign.keyPair.fromSeed(e);return{A:r,seed:e}}case f.publicKey.ed448:{const t=await d.getNobleCurve(f.publicKey.ed448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),seed:e}}default:throw Error("Unsupported EdDSA algorithm")}}async function N3(n,t,e,r,i,s){if(ce.getHashByteLength(t)<ce.getHashByteLength(Ta(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case f.publicKey.ed25519:try{const a=d.getWebCrypto(),o=D5(n,r,i),c=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const o=d.concatUint8Array([i,r]);return{RS:At.sign.detached(s,o)}}case f.publicKey.ed448:return{RS:(await d.getNobleCurve(f.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function z3(n,t,{RS:e},r,i,s){if(ce.getHashByteLength(t)<ce.getHashByteLength(Ta(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case f.publicKey.ed25519:try{const a=d.getWebCrypto(),o=O3(n,i),c=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",c,e,s)}catch(a){if(a.name!=="NotSupportedError")throw a;return At.sign.detached.verify(s,e,i)}case f.publicKey.ed448:return(await d.getNobleCurve(f.publicKey.ed448)).verify(e,s,i);default:throw Error("Unsupported EdDSA algorithm")}}function H3(n){switch(n){case f.publicKey.ed25519:return 32;case f.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Ta(n){switch(n){case f.publicKey.ed25519:return f.hash.sha256;case f.publicKey.ed448:return f.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const O3=(n,t)=>{if(n===f.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:qt(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},D5=(n,t,e)=>{if(n===f.publicKey.ed25519){const r=O3(n,t);return r.d=qt(e),r}throw Error("Unsupported EdDSA algorithm")};var Q5=Object.freeze({__proto__:null,generate:M3,getPayloadSize:H3,getPreferredHashAlgo:Ta,sign:N3,validateParams:async function(n,t,e){switch(n){case f.publicKey.ed25519:{const{publicKey:r}=At.sign.keyPair.fromSeed(e);return d.equalsUint8Array(t,r)}case f.publicKey.ed448:{const r=(await d.getNobleCurve(f.publicKey.ed448)).getPublicKey(e);return d.equalsUint8Array(t,r)}default:return!1}},verify:z3});const un=d.getWebCrypto();async function Ni(n,t,e){const{keySize:r}=Ft(n);if(!d.isAES(n)||t.length!==r)throw Error("Unexpected algorithm or key size");try{const i=await un.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),s=await un.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await un.wrapKey("raw",s,i,{name:"AES-KW"});return new Uint8Array(a)}catch(i){if(i.name!=="NotSupportedError"&&(t.length!==24||i.name!=="OperationError"))throw i;d.printDebugError("Browser did not support operation: "+i.message)}return v3(t).encrypt(e)}async function zi(n,t,e){const{keySize:r}=Ft(n);if(!d.isAES(n)||t.length!==r)throw Error("Unexpected algorithm or key size");let i;try{i=await un.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(t.length!==24||s.name!=="OperationError"))throw s;return d.printDebugError("Browser did not support operation: "+s.message),v3(t).decrypt(e)}try{const s=await un.unwrapKey("raw",e,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await un.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}var R5=Object.freeze({__proto__:null,unwrap:zi,wrap:Ni});const Zo=d.getWebCrypto();async function Qr(n,t,e,r,i){const s=f.read(f.webHash,n);if(!s)throw Error("Hash algo not supported with HKDF");const a=await Zo.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await Zo.deriveBits({name:"HKDF",hash:s,salt:e,info:r},a,8*i);return new Uint8Array(o)}const ui={x25519:d.encodeUTF8("OpenPGP X25519"),x448:d.encodeUTF8("OpenPGP X448")};async function F3(n){switch(n){case f.publicKey.x25519:{const t=Je(32),{publicKey:e}=At.box.keyPair.fromSecretKey(t);return{A:e,k:t}}case f.publicKey.x448:{const t=await d.getNobleCurve(f.publicKey.x448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),k:e}}default:throw Error("Unsupported ECDH algorithm")}}function G3(n){switch(n){case f.publicKey.x25519:return 32;case f.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function fa(n,t){switch(n){case f.publicKey.x25519:{const e=Je(G3(n)),r=At.scalarMult(e,t);Hi(r);const{publicKey:i}=At.box.keyPair.fromSecretKey(e);return{ephemeralPublicKey:i,sharedSecret:r}}case f.publicKey.x448:{const e=await d.getNobleCurve(f.publicKey.x448),r=e.utils.randomPrivateKey(),i=e.getSharedSecret(r,t);return Hi(i),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function ga(n,t,e,r){switch(n){case f.publicKey.x25519:{const i=At.scalarMult(r,t);return Hi(i),i}case f.publicKey.x448:{const i=(await d.getNobleCurve(f.publicKey.x448)).getSharedSecret(r,t);return Hi(i),i}default:throw Error("Unsupported ECDH algorithm")}}function Hi(n){let t=0;for(let e=0;e<n.length;e++)t|=n[e];if(t===0)throw Error("Unexpected low order point")}var _5=Object.freeze({__proto__:null,decrypt:async function(n,t,e,r,i){const s=await ga(n,t,r,i),a=d.concatUint8Array([t,r,s]);switch(n){case f.publicKey.x25519:{const o=f.symmetric.aes128,{keySize:c}=Ft(o);return zi(o,await Qr(f.hash.sha256,a,new Uint8Array,ui.x25519,c),e)}case f.publicKey.x448:{const o=f.symmetric.aes256,{keySize:c}=Ft(f.symmetric.aes256);return zi(o,await Qr(f.hash.sha512,a,new Uint8Array,ui.x448,c),e)}default:throw Error("Unsupported ECDH algorithm")}},encrypt:async function(n,t,e){const{ephemeralPublicKey:r,sharedSecret:i}=await fa(n,e),s=d.concatUint8Array([r,e,i]);switch(n){case f.publicKey.x25519:{const a=f.symmetric.aes128,{keySize:o}=Ft(a),c=await Qr(f.hash.sha256,s,new Uint8Array,ui.x25519,o);return{ephemeralPublicKey:r,wrappedKey:await Ni(a,c,t)}}case f.publicKey.x448:{const a=f.symmetric.aes256,{keySize:o}=Ft(f.symmetric.aes256),c=await Qr(f.hash.sha512,s,new Uint8Array,ui.x448,o);return{ephemeralPublicKey:r,wrappedKey:await Ni(a,c,t)}}default:throw Error("Unsupported ECDH algorithm")}},generate:F3,generateEphemeralEncryptionMaterial:fa,getPayloadSize:G3,recomputeSharedSecret:ga,validateParams:async function(n,t,e){switch(n){case f.publicKey.x25519:{const{publicKey:r}=At.box.keyPair.fromSecretKey(e);return d.equalsUint8Array(t,r)}case f.publicKey.x448:{const r=(await d.getNobleCurve(f.publicKey.x448)).getPublicKey(e);return d.equalsUint8Array(t,r)}default:return!1}}});const xs=d.getWebCrypto(),Oi=d.getNodeCrypto(),Re={[f.curve.nistP256]:"P-256",[f.curve.nistP384]:"P-384",[f.curve.nistP521]:"P-521"},Ne=Oi?Oi.getCurves():[],Ce=Oi?{[f.curve.secp256k1]:Ne.includes("secp256k1")?"secp256k1":void 0,[f.curve.nistP256]:Ne.includes("prime256v1")?"prime256v1":void 0,[f.curve.nistP384]:Ne.includes("secp384r1")?"secp384r1":void 0,[f.curve.nistP521]:Ne.includes("secp521r1")?"secp521r1":void 0,[f.curve.ed25519Legacy]:Ne.includes("ED25519")?"ED25519":void 0,[f.curve.curve25519Legacy]:Ne.includes("X25519")?"X25519":void 0,[f.curve.brainpoolP256r1]:Ne.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[f.curve.brainpoolP384r1]:Ne.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[f.curve.brainpoolP512r1]:Ne.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},q3={[f.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:f.publicKey.ecdsa,hash:f.hash.sha256,cipher:f.symmetric.aes128,node:Ce[f.curve.nistP256],web:Re[f.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[f.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:f.publicKey.ecdsa,hash:f.hash.sha384,cipher:f.symmetric.aes192,node:Ce[f.curve.nistP384],web:Re[f.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[f.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:f.publicKey.ecdsa,hash:f.hash.sha512,cipher:f.symmetric.aes256,node:Ce[f.curve.nistP521],web:Re[f.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[f.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:f.publicKey.ecdsa,hash:f.hash.sha256,cipher:f.symmetric.aes128,node:Ce[f.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[f.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:f.publicKey.eddsaLegacy,hash:f.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[f.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:f.publicKey.ecdh,hash:f.hash.sha256,cipher:f.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[f.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:f.publicKey.ecdsa,hash:f.hash.sha256,cipher:f.symmetric.aes128,node:Ce[f.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[f.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:f.publicKey.ecdsa,hash:f.hash.sha384,cipher:f.symmetric.aes192,node:Ce[f.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[f.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:f.publicKey.ecdsa,hash:f.hash.sha512,cipher:f.symmetric.aes256,node:Ce[f.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class Xe{constructor(t){try{this.name=t instanceof $e?t.getName():f.write(f.curve,t)}catch{throw new yt("Unknown curve")}const e=q3[this.name];this.keyType=e.keyType,this.oid=e.oid,this.hash=e.hash,this.cipher=e.cipher,this.node=e.node,this.web=e.web,this.payloadSize=e.payloadSize,this.sharedSize=e.sharedSize,this.wireFormatLeadingByte=e.wireFormatLeadingByte,this.web&&d.getWebCrypto()?this.type="web":this.node&&d.getNodeCrypto()?this.type="node":this.name===f.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===f.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(t,e){const r=await xs.generateKey({name:"ECDSA",namedCurve:Re[t]},!0,["sign","verify"]),i=await xs.exportKey("jwk",r.privateKey),s=await xs.exportKey("jwk",r.publicKey);return{publicKey:j3(s,e),privateKey:me(i.d)}}(this.name,this.wireFormatLeadingByte)}catch(t){return d.printDebugError("Browser did not support generating ec key "+t.message),Yo(this.name)}case"node":return async function(t){const e=Oi.createECDH(Ce[t]);return await e.generateKeys(),{publicKey:new Uint8Array(e.getPublicKey()),privateKey:new Uint8Array(e.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:t,A:e}=await F3(f.publicKey.x25519),r=t.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:r}}case"ed25519Legacy":{const{seed:t,A:e}=await M3(f.publicKey.ed25519);return{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:t}}default:return Yo(this.name)}}}async function $3(n,t,e,r){const i={[f.curve.nistP256]:!0,[f.curve.nistP384]:!0,[f.curve.nistP521]:!0,[f.curve.secp256k1]:!0,[f.curve.curve25519Legacy]:n===f.publicKey.ecdh,[f.curve.brainpoolP256r1]:!0,[f.curve.brainpoolP384r1]:!0,[f.curve.brainpoolP512r1]:!0},s=t.getName();if(!i[s])return!1;if(s===f.curve.curve25519Legacy){r=r.slice().reverse();const{publicKey:o}=At.box.keyPair.fromSecretKey(r);e=new Uint8Array(e);const c=new Uint8Array([64,...o]);return!!d.equalsUint8Array(c,e)}const a=(await d.getNobleCurve(f.publicKey.ecdsa,s)).getPublicKey(r,!1);return!!d.equalsUint8Array(a,e)}function Lr(n,t){const{payloadSize:e,wireFormatLeadingByte:r,name:i}=n,s=i===f.curve.curve25519Legacy||i===f.curve.ed25519Legacy?e:2*e;if(t[0]!==r||t.length!==s+1)throw Error("Invalid point encoding")}async function Yo(n){const t=await d.getNobleCurve(f.publicKey.ecdsa,n),e=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(e,!1),privateKey:e}}function j3(n,t){const e=me(n.x),r=me(n.y),i=new Uint8Array(e.length+r.length+1);return i[0]=t,i.set(e,1),i.set(r,e.length+1),i}function ns(n,t,e){const r=n,i=e.slice(1,r+1),s=e.slice(r+1,2*r+1);return{kty:"EC",crv:t,x:qt(i),y:qt(s),ext:!0}}function V3(n,t,e,r){const i=ns(n,t,e);return i.d=qt(r),i}const Fi=d.getWebCrypto(),Z3=d.getNodeCrypto();async function Jo(n,t,e,r,i,s){const a=new Xe(n);if(Lr(a,r),e&&!d.isStream(e)){const c={publicKey:r,privateKey:i};switch(a.type){case"web":try{return await async function(h,l,u,g){const y=h.payloadSize,A=V3(h.payloadSize,Re[h.name],g.publicKey,g.privateKey),p=await Fi.importKey("jwk",A,{name:"ECDSA",namedCurve:Re[h.name],hash:{name:f.read(f.webHash,h.hash)}},!1,["sign"]),w=new Uint8Array(await Fi.sign({name:"ECDSA",namedCurve:Re[h.name],hash:{name:f.read(f.webHash,l)}},p,u));return{r:w.slice(0,y),s:w.slice(y,y<<1)}}(a,t,e,c)}catch(h){if(a.name!=="nistP521"&&(h.name==="DataError"||h.name==="OperationError"))throw h;d.printDebugError("Browser did not support signing: "+h.message)}break;case"node":return async function(h,l,u,g){const y=d.nodeRequire("eckey-utils"),A=d.getNodeBuffer(),{privateKey:p}=y.generateDer({curveName:Ce[h.name],privateKey:A.from(g)}),w=Z3.createSign(f.read(f.hash,l));w.write(u),w.end();const k=new Uint8Array(w.sign({key:p,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),v=h.payloadSize;return{r:k.subarray(0,v),s:k.subarray(v,v<<1)}}(a,t,e,i)}}const o=(await d.getNobleCurve(f.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:It(o.r,"be",a.payloadSize),s:It(o.s,"be",a.payloadSize)}}async function Wo(n,t,e,r,i,s){const a=new Xe(n);Lr(a,i);const o=async()=>s[0]===0&&Xo(a,e,s.subarray(1),i);if(r&&!d.isStream(r))switch(a.type){case"web":try{return await async function(h,l,{r:u,s:g},y,A){const p=ns(h.payloadSize,Re[h.name],A),w=await Fi.importKey("jwk",p,{name:"ECDSA",namedCurve:Re[h.name],hash:{name:f.read(f.webHash,h.hash)}},!1,["verify"]),k=d.concatUint8Array([u,g]).buffer;return Fi.verify({name:"ECDSA",namedCurve:Re[h.name],hash:{name:f.read(f.webHash,l)}},w,k,y)}(a,t,e,r,i)||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;d.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return await async function(h,l,{r:u,s:g},y,A){const p=d.nodeRequire("eckey-utils"),w=d.getNodeBuffer(),{publicKey:k}=p.generateDer({curveName:Ce[h.name],publicKey:w.from(A)}),v=Z3.createVerify(f.read(f.hash,l));v.write(y),v.end();const m=d.concatUint8Array([u,g]);try{return v.verify({key:k,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},m)}catch{return!1}}(a,t,e,r,i)||o()}return await Xo(a,e,s,i)||o()}async function Xo(n,t,e,r){return(await d.getNobleCurve(f.publicKey.ecdsa,n.name)).verify(d.concatUint8Array([t.r,t.s]),e,r,{lowS:!1})}var T5=Object.freeze({__proto__:null,sign:Jo,validateParams:async function(n,t,e){const r=new Xe(n);if(r.keyType!==f.publicKey.ecdsa)return!1;switch(r.type){case"web":case"node":{const i=Je(8),s=f.hash.sha256,a=await ce.digest(s,i);try{const o=await Jo(n,s,i,t,e,a);return await Wo(n,s,o,i,t,a)}catch{return!1}}default:return $3(f.publicKey.ecdsa,n,t,e)}},verify:Wo}),L5=Object.freeze({__proto__:null,sign:async function(n,t,e,r,i,s){if(Lr(new Xe(n),r),ce.getHashByteLength(t)<ce.getHashByteLength(f.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await N3(f.publicKey.ed25519,t,0,r.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}},validateParams:async function(n,t,e){if(n.getName()!==f.curve.ed25519Legacy)return!1;const{publicKey:r}=At.sign.keyPair.fromSeed(e),i=new Uint8Array([64,...r]);return d.equalsUint8Array(t,i)},verify:async function(n,t,{r:e,s:r},i,s,a){if(Lr(new Xe(n),s),ce.getHashByteLength(t)<ce.getHashByteLength(f.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=d.concatUint8Array([e,r]);return z3(f.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}});function Y3(n){const t=8-n.length%8,e=new Uint8Array(n.length+t).fill(t);return e.set(n),e}function J3(n){const t=n.length;if(t>0){const e=n[t-1];if(e>=1){const r=n.subarray(t-e),i=new Uint8Array(e).fill(e);if(d.equalsUint8Array(r,i))return n.subarray(0,t-e)}}throw Error("Invalid padding")}var M5=Object.freeze({__proto__:null,decode:J3,encode:Y3});const dr=d.getWebCrypto(),W3=d.getNodeCrypto();function t1(n,t,e,r){return d.concatUint8Array([t.write(),new Uint8Array([n]),e.write(),d.stringToUint8Array("Anonymous Sender    "),r])}async function e1(n,t,e,r,i=!1,s=!1){let a;if(i){for(a=0;a<t.length&&t[a]===0;a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&t[a]===0;a--);t=t.subarray(0,a+1)}return(await ce.digest(n,d.concatUint8Array([new Uint8Array([0,0,0,1]),t,r]))).subarray(0,e)}async function N5(n,t){switch(n.type){case"curve25519Legacy":{const{sharedSecret:e,ephemeralPublicKey:r}=await fa(f.publicKey.x25519,t.subarray(1));return{publicKey:d.concatUint8Array([new Uint8Array([n.wireFormatLeadingByte]),r]),sharedKey:e}}case"web":if(n.web&&d.getWebCrypto())try{return await async function(e,r){const i=ns(e.payloadSize,e.web,r);let s=dr.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),a=dr.importKey("jwk",i,{name:"ECDH",namedCurve:e.web},!1,[]);[s,a]=await Promise.all([s,a]);let o=dr.deriveBits({name:"ECDH",namedCurve:e.web,public:a},s.privateKey,e.sharedSize),c=dr.exportKey("jwk",s.publicKey);[o,c]=await Promise.all([o,c]);const h=new Uint8Array(o);return{publicKey:new Uint8Array(j3(c,e.wireFormatLeadingByte)),sharedKey:h}}(n,t)}catch(e){return d.printDebugError(e),n1(n,t)}break;case"node":return async function(e,r){const i=W3.createECDH(e.node);i.generateKeys();const s=new Uint8Array(i.computeSecret(r));return{publicKey:new Uint8Array(i.getPublicKey()),sharedKey:s}}(n,t);default:return n1(n,t)}}async function z5(n,t,e,r){if(r.length!==n.payloadSize){const i=new Uint8Array(n.payloadSize);i.set(r,n.payloadSize-r.length),r=i}switch(n.type){case"curve25519Legacy":{const i=r.slice().reverse();return{secretKey:i,sharedKey:await ga(f.publicKey.x25519,t.subarray(1),e.subarray(1),i)}}case"web":if(n.web&&d.getWebCrypto())try{return await async function(i,s,a,o){const c=V3(i.payloadSize,i.web,a,o);let h=dr.importKey("jwk",c,{name:"ECDH",namedCurve:i.web},!0,["deriveKey","deriveBits"]);const l=ns(i.payloadSize,i.web,s);let u=dr.importKey("jwk",l,{name:"ECDH",namedCurve:i.web},!0,[]);[h,u]=await Promise.all([h,u]);let g=dr.deriveBits({name:"ECDH",namedCurve:i.web,public:u},h,i.sharedSize),y=dr.exportKey("jwk",h);[g,y]=await Promise.all([g,y]);const A=new Uint8Array(g);return{secretKey:me(y.d),sharedKey:A}}(n,t,e,r)}catch(i){return d.printDebugError(i),r1(n,t,r)}break;case"node":return async function(i,s,a){const o=W3.createECDH(i.node);o.setPrivateKey(a);const c=new Uint8Array(o.computeSecret(s));return{secretKey:new Uint8Array(o.getPrivateKey()),sharedKey:c}}(n,t,r);default:return r1(n,t,r)}}async function r1(n,t,e){return{secretKey:e,sharedKey:(await d.getNobleCurve(f.publicKey.ecdh,n.name)).getSharedSecret(e,t).subarray(1)}}async function n1(n,t){const e=await d.getNobleCurve(f.publicKey.ecdh,n.name),{publicKey:r,privateKey:i}=await n.genKeyPair();return{publicKey:r,sharedKey:e.getSharedSecret(i,t).subarray(1)}}var H5=Object.freeze({__proto__:null,decrypt:async function(n,t,e,r,i,s,a){const o=new Xe(n);Lr(o,i),Lr(o,e);const{sharedKey:c}=await z5(o,e,i,s),h=t1(f.publicKey.ecdh,n,t,a),{keySize:l}=Ft(t.cipher);let u;for(let g=0;g<3;g++)try{const y=await e1(t.hash,c,l,h,g===1,g===2);return J3(await zi(t.cipher,y,r))}catch(y){u=y}throw u},encrypt:async function(n,t,e,r,i){const s=Y3(e),a=new Xe(n);Lr(a,r);const{publicKey:o,sharedKey:c}=await N5(a,r),h=t1(f.publicKey.ecdh,n,t,i),{keySize:l}=Ft(t.cipher),u=await e1(t.hash,c,l,h);return{publicKey:o,wrappedKey:await Ni(t.cipher,u,s)}},validateParams:async function(n,t,e){return $3(f.publicKey.ecdh,n,t,e)}}),O5=Object.freeze({__proto__:null,CurveWithOID:Xe,ecdh:H5,ecdhX:_5,ecdsa:T5,eddsa:Q5,eddsaLegacy:L5,generate:async function(n){const t=new Xe(n),{oid:e,hash:r,cipher:i}=t,s=await t.genKeyPair();return{oid:e,Q:s.publicKey,secret:d.leftPad(s.privateKey,t.payloadSize),hash:r,cipher:i}},getPreferredHashAlgo:function(n){return q3[n.getName()].hash}});const fi=BigInt(0),kn=BigInt(1);var F5=Object.freeze({__proto__:null,sign:async function(n,t,e,r,i,s){const a=BigInt(0);let o,c,h,l;r=V(r),i=V(i),e=V(e),s=V(s),e=it(e,r),s=it(s,i);const u=it(V(t.subarray(0,Jt(i))),i);for(;;){if(o=We(kn,i),c=it(Dt(e,o,r),i),c===a)continue;const g=it(s*c,i);if(l=it(u+g,i),h=it(hn(o,i)*l,i),h!==a)break}return{r:It(c,"be",Jt(r)),s:It(h,"be",Jt(r))}},validateParams:async function(n,t,e,r,i){if(n=V(n),t=V(t),e=V(e),r=V(r),e<=kn||e>=n||it(n-kn,t)!==fi||Dt(e,t,n)!==kn)return!1;const s=BigInt(gn(t));if(s<BigInt(150)||!C3(t,null,32))return!1;i=V(i);const a=BigInt(2);return r===Dt(e,t*We(a<<s-kn,a<<s)+i,n)},verify:async function(n,t,e,r,i,s,a,o){if(t=V(t),e=V(e),s=V(s),a=V(a),i=V(i),o=V(o),t<=fi||t>=a||e<=fi||e>=a)return d.printDebug("invalid DSA Signature"),!1;const c=it(V(r.subarray(0,Jt(a))),a),h=hn(e,a);if(h===fi)return d.printDebug("invalid DSA Signature"),!1;i=it(i,s),o=it(o,s);const l=it(c*h,a),u=it(t*h,a);return it(it(Dt(i,l,s)*Dt(o,u,s),s),a)===t}}),rt={rsa:E5,elgamal:k5,elliptic:O5,dsa:F5},G5=Object.freeze({__proto__:null,parseSignatureParams:function(n,t){let e=0;switch(n){case f.publicKey.rsaEncryptSign:case f.publicKey.rsaEncrypt:case f.publicKey.rsaSign:{const r=d.readMPI(t.subarray(e));return e+=r.length+2,{read:e,signatureParams:{s:r}}}case f.publicKey.dsa:case f.publicKey.ecdsa:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=d.readMPI(t.subarray(e));return e+=i.length+2,{read:e,signatureParams:{r,s:i}}}case f.publicKey.eddsaLegacy:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=d.readMPI(t.subarray(e));return e+=i.length+2,{read:e,signatureParams:{r,s:i}}}case f.publicKey.ed25519:case f.publicKey.ed448:{const r=2*rt.elliptic.eddsa.getPayloadSize(n),i=d.readExactSubarray(t,e,e+r);return e+=i.length,{read:e,signatureParams:{RS:i}}}default:throw new yt("Unknown signature algorithm.")}},sign:async function(n,t,e,r,i,s){if(!e||!r)throw Error("Missing key parameters");switch(n){case f.publicKey.rsaEncryptSign:case f.publicKey.rsaEncrypt:case f.publicKey.rsaSign:{const{n:a,e:o}=e,{d:c,p:h,q:l,u}=r;return{s:await rt.rsa.sign(t,i,a,o,c,h,l,u,s)}}case f.publicKey.dsa:{const{g:a,p:o,q:c}=e,{x:h}=r;return rt.dsa.sign(t,s,a,o,c,h)}case f.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case f.publicKey.ecdsa:{const{oid:a,Q:o}=e,{d:c}=r;return rt.elliptic.ecdsa.sign(a,t,i,o,c,s)}case f.publicKey.eddsaLegacy:{const{oid:a,Q:o}=e,{seed:c}=r;return rt.elliptic.eddsaLegacy.sign(a,t,i,o,c,s)}case f.publicKey.ed25519:case f.publicKey.ed448:{const{A:a}=e,{seed:o}=r;return rt.elliptic.eddsa.sign(n,t,i,a,o,s)}default:throw Error("Unknown signature algorithm.")}},verify:async function(n,t,e,r,i,s){switch(n){case f.publicKey.rsaEncryptSign:case f.publicKey.rsaEncrypt:case f.publicKey.rsaSign:{const{n:a,e:o}=r,c=d.leftPad(e.s,a.length);return rt.rsa.verify(t,i,c,a,o,s)}case f.publicKey.dsa:{const{g:a,p:o,q:c,y:h}=r,{r:l,s:u}=e;return rt.dsa.verify(t,l,u,s,a,o,c,h)}case f.publicKey.ecdsa:{const{oid:a,Q:o}=r,c=new rt.elliptic.CurveWithOID(a).payloadSize,h=d.leftPad(e.r,c),l=d.leftPad(e.s,c);return rt.elliptic.ecdsa.verify(a,t,{r:h,s:l},i,o,s)}case f.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,c=new rt.elliptic.CurveWithOID(a).payloadSize,h=d.leftPad(e.r,c),l=d.leftPad(e.s,c);return rt.elliptic.eddsaLegacy.verify(a,t,{r:h,s:l},i,o,s)}case f.publicKey.ed25519:case f.publicKey.ed448:{const{A:a}=r;return rt.elliptic.eddsa.verify(n,t,e,i,a,s)}default:throw Error("Unknown signature algorithm.")}}});class i1{constructor(t){t&&(this.data=t)}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.data=t.subarray(1,1+e),1+this.data.length}throw Error("Invalid symmetric key")}write(){return d.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class s1{constructor(t){if(t){const{hash:e,cipher:r}=t;this.hash=e,this.cipher=r}else this.hash=null,this.cipher=null}read(t){if(t.length<4||t[0]!==3||t[1]!==1)throw new yt("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class Gi{static fromObject({wrappedKey:t,algorithm:e}){const r=new Gi;return r.wrappedKey=t,r.algorithm=e,r}read(t){let e=0,r=t[e++];this.algorithm=r%2?t[e++]:null,r-=r%2,this.wrappedKey=d.readExactSubarray(t,e,e+r),e+=r}write(){return d.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}function Us(n){try{n.getName()}catch{throw new yt("Unknown curve OID")}}function xr(n,t){switch(n){case f.publicKey.ecdsa:case f.publicKey.ecdh:case f.publicKey.eddsaLegacy:return new rt.elliptic.CurveWithOID(t).payloadSize;case f.publicKey.ed25519:case f.publicKey.ed448:return rt.elliptic.eddsa.getPayloadSize(n);case f.publicKey.x25519:case f.publicKey.x448:return rt.elliptic.ecdhX.getPayloadSize(n);default:throw Error("Unknown elliptic algo")}}var q5=Object.freeze({__proto__:null,generateParams:function(n,t,e){switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.rsaSign:return rt.rsa.generate(t,65537).then(({n:r,e:i,d:s,p:a,q:o,u:c})=>({privateParams:{d:s,p:a,q:o,u:c},publicParams:{n:r,e:i}}));case f.publicKey.ecdsa:return rt.elliptic.generate(e).then(({oid:r,Q:i,secret:s})=>({privateParams:{d:s},publicParams:{oid:new $e(r),Q:i}}));case f.publicKey.eddsaLegacy:return rt.elliptic.generate(e).then(({oid:r,Q:i,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new $e(r),Q:i}}));case f.publicKey.ecdh:return rt.elliptic.generate(e).then(({oid:r,Q:i,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new $e(r),Q:i,kdfParams:new s1({hash:a,cipher:o})}}));case f.publicKey.ed25519:case f.publicKey.ed448:return rt.elliptic.eddsa.generate(n).then(({A:r,seed:i})=>({privateParams:{seed:i},publicParams:{A:r}}));case f.publicKey.x25519:case f.publicKey.x448:return rt.elliptic.ecdhX.generate(n).then(({A:r,k:i})=>({privateParams:{k:i},publicParams:{A:r}}));case f.publicKey.dsa:case f.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},generateSessionKey:function(n){const{keySize:t}=Ft(n);return Je(t)},getAEADMode:function(n){const t=f.read(f.aead,n);return S3[t]},getCipherParams:Ft,getCurvePayloadSize:xr,getPreferredCurveHashAlgo:function(n,t){switch(n){case f.publicKey.ecdsa:case f.publicKey.eddsaLegacy:return rt.elliptic.getPreferredHashAlgo(t);case f.publicKey.ed25519:case f.publicKey.ed448:return rt.elliptic.eddsa.getPreferredHashAlgo(n);default:throw Error("Unknown elliptic signing algo")}},getPrefixRandom:async function(n){const{blockSize:t}=Ft(n),e=await Je(t),r=new Uint8Array([e[e.length-2],e[e.length-1]]);return d.concat([e,r])},parseEncSessionKeyParams:function(n,t){let e=0;switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:return{c:d.readMPI(t.subarray(e))};case f.publicKey.elgamal:{const r=d.readMPI(t.subarray(e));return e+=r.length+2,{c1:r,c2:d.readMPI(t.subarray(e))}}case f.publicKey.ecdh:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=new i1;return i.read(t.subarray(e)),{V:r,C:i}}case f.publicKey.x25519:case f.publicKey.x448:{const r=xr(n),i=d.readExactSubarray(t,e,e+r);e+=i.length;const s=new Gi;return s.read(t.subarray(e)),{ephemeralPublicKey:i,C:s}}default:throw new yt("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(n,t,e){let r=0;switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.rsaSign:{const i=d.readMPI(t.subarray(r));r+=i.length+2;const s=d.readMPI(t.subarray(r));r+=s.length+2;const a=d.readMPI(t.subarray(r));r+=a.length+2;const o=d.readMPI(t.subarray(r));return r+=o.length+2,{read:r,privateParams:{d:i,p:s,q:a,u:o}}}case f.publicKey.dsa:case f.publicKey.elgamal:{const i=d.readMPI(t.subarray(r));return r+=i.length+2,{read:r,privateParams:{x:i}}}case f.publicKey.ecdsa:case f.publicKey.ecdh:{const i=xr(n,e.oid);let s=d.readMPI(t.subarray(r));return r+=s.length+2,s=d.leftPad(s,i),{read:r,privateParams:{d:s}}}case f.publicKey.eddsaLegacy:{const i=xr(n,e.oid);if(e.oid.getName()!==f.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=d.readMPI(t.subarray(r));return r+=s.length+2,s=d.leftPad(s,i),{read:r,privateParams:{seed:s}}}case f.publicKey.ed25519:case f.publicKey.ed448:{const i=xr(n),s=d.readExactSubarray(t,r,r+i);return r+=s.length,{read:r,privateParams:{seed:s}}}case f.publicKey.x25519:case f.publicKey.x448:{const i=xr(n),s=d.readExactSubarray(t,r,r+i);return r+=s.length,{read:r,privateParams:{k:s}}}default:throw new yt("Unknown public key encryption algorithm.")}},parsePublicKeyParams:function(n,t){let e=0;switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.rsaSign:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=d.readMPI(t.subarray(e));return e+=i.length+2,{read:e,publicParams:{n:r,e:i}}}case f.publicKey.dsa:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=d.readMPI(t.subarray(e));e+=i.length+2;const s=d.readMPI(t.subarray(e));e+=s.length+2;const a=d.readMPI(t.subarray(e));return e+=a.length+2,{read:e,publicParams:{p:r,q:i,g:s,y:a}}}case f.publicKey.elgamal:{const r=d.readMPI(t.subarray(e));e+=r.length+2;const i=d.readMPI(t.subarray(e));e+=i.length+2;const s=d.readMPI(t.subarray(e));return e+=s.length+2,{read:e,publicParams:{p:r,g:i,y:s}}}case f.publicKey.ecdsa:{const r=new $e;e+=r.read(t),Us(r);const i=d.readMPI(t.subarray(e));return e+=i.length+2,{read:e,publicParams:{oid:r,Q:i}}}case f.publicKey.eddsaLegacy:{const r=new $e;if(e+=r.read(t),Us(r),r.getName()!==f.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let i=d.readMPI(t.subarray(e));return e+=i.length+2,i=d.leftPad(i,33),{read:e,publicParams:{oid:r,Q:i}}}case f.publicKey.ecdh:{const r=new $e;e+=r.read(t),Us(r);const i=d.readMPI(t.subarray(e));e+=i.length+2;const s=new s1;return e+=s.read(t.subarray(e)),{read:e,publicParams:{oid:r,Q:i,kdfParams:s}}}case f.publicKey.ed25519:case f.publicKey.ed448:case f.publicKey.x25519:case f.publicKey.x448:{const r=d.readExactSubarray(t,e,e+xr(n));return e+=r.length,{read:e,publicParams:{A:r}}}default:throw new yt("Unknown public key encryption algorithm.")}},publicKeyDecrypt:async function(n,t,e,r,i,s){switch(n){case f.publicKey.rsaEncryptSign:case f.publicKey.rsaEncrypt:{const{c:a}=r,{n:o,e:c}=t,{d:h,p:l,q:u,u:g}=e;return rt.rsa.decrypt(a,o,c,h,l,u,g,s)}case f.publicKey.elgamal:{const{c1:a,c2:o}=r,c=t.p,h=e.x;return rt.elgamal.decrypt(a,o,c,h,s)}case f.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:c}=t,{d:h}=e,{V:l,C:u}=r;return rt.elliptic.ecdh.decrypt(a,c,l,u.data,o,h,i)}case f.publicKey.x25519:case f.publicKey.x448:{const{A:a}=t,{k:o}=e,{ephemeralPublicKey:c,C:h}=r;if(h.algorithm!==null&&!d.isAES(h.algorithm))throw Error("AES session key expected");return rt.elliptic.ecdhX.decrypt(n,c,h.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}},publicKeyEncrypt:async function(n,t,e,r,i){switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:{const{n:s,e:a}=e;return{c:await rt.rsa.encrypt(r,s,a)}}case f.publicKey.elgamal:{const{p:s,g:a,y:o}=e;return rt.elgamal.encrypt(r,s,a,o)}case f.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=e,{publicKey:c,wrappedKey:h}=await rt.elliptic.ecdh.encrypt(s,o,r,a,i);return{V:c,C:new i1(h)}}case f.publicKey.x25519:case f.publicKey.x448:{if(t&&!d.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=e,{ephemeralPublicKey:a,wrappedKey:o}=await rt.elliptic.ecdhX.encrypt(n,r,s);return{ephemeralPublicKey:a,C:Gi.fromObject({algorithm:t,wrappedKey:o})}}default:return[]}},serializeParams:function(n,t){const e=new Set([f.publicKey.ed25519,f.publicKey.x25519,f.publicKey.ed448,f.publicKey.x448]),r=Object.keys(t).map(i=>{const s=t[i];return d.isUint8Array(s)?e.has(n)?s:d.uint8ArrayToMPI(s):s.write()});return d.concatUint8Array(r)},validateParams:async function(n,t,e){if(!t||!e)throw Error("Missing key parameters");switch(n){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.rsaSign:{const{n:r,e:i}=t,{d:s,p:a,q:o,u:c}=e;return rt.rsa.validateParams(r,i,s,a,o,c)}case f.publicKey.dsa:{const{p:r,q:i,g:s,y:a}=t,{x:o}=e;return rt.dsa.validateParams(r,i,s,a,o)}case f.publicKey.elgamal:{const{p:r,g:i,y:s}=t,{x:a}=e;return rt.elgamal.validateParams(r,i,s,a)}case f.publicKey.ecdsa:case f.publicKey.ecdh:{const r=rt.elliptic[f.read(f.publicKey,n)],{oid:i,Q:s}=t,{d:a}=e;return r.validateParams(i,s,a)}case f.publicKey.eddsaLegacy:{const{Q:r,oid:i}=t,{seed:s}=e;return rt.elliptic.eddsaLegacy.validateParams(i,r,s)}case f.publicKey.ed25519:case f.publicKey.ed448:{const{A:r}=t,{seed:i}=e;return rt.elliptic.eddsa.validateParams(n,r,i)}case f.publicKey.x25519:case f.publicKey.x448:{const{A:r}=t,{k:i}=e;return rt.elliptic.ecdhX.validateParams(n,r,i)}default:throw Error("Unknown public key algorithm.")}}});const $={cipher:Y0,hash:ce,mode:S3,publicKey:rt,signature:G5,random:w5,pkcs1:m5,pkcs5:M5,aesKW:R5};Object.assign($,q5);class is extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,is),this.name="Argon2OutOfMemoryError"}}let gi,Bn;class $5{constructor(t=W){const{passes:e,parallelism:r,memoryExponent:i}=t.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=e,this.p=r,this.encodedM=i}generateSalt(){this.salt=$.random.getRandomBytes(16)}read(t){let e=0;return this.salt=t.subarray(e,e+16),e+=16,this.t=t[e++],this.p=t[e++],this.encodedM=t[e++],e}write(){const t=[new Uint8Array([f.write(f.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return d.concatUint8Array(t)}async produceKey(t,e){const r=2<<this.encodedM-1;try{gi=gi||(await Promise.resolve().then(function(){return rh})).default,Bn=Bn||gi();const i=await Bn,s=i({version:19,type:2,password:d.encodeUTF8(t),salt:this.salt,tagLength:e,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(Bn=gi(),Bn.catch(()=>{})),s}catch(i){throw i.message&&(i.message.includes("Unable to grow instance memory")||i.message.includes("failed to grow memory")||i.message.includes("WebAssembly.Memory.grow")||i.message.includes("Out of memory"))?new is("Could not allocate required memory for Argon2"):i}}}class j5{constructor(t,e=W){this.algorithm=f.hash.sha256,this.type=f.read(f.s2k,t),this.c=e.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=$.random.getRandomBytes(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let e=0;switch(this.algorithm=t[e++],this.type){case"simple":break;case"salted":this.salt=t.subarray(e,e+8),e+=8;break;case"iterated":this.salt=t.subarray(e,e+8),e+=8,this.c=t[e++];break;case"gnu":if(d.uint8ArrayToString(t.subarray(e,e+3))!=="GNU")throw new yt("Unknown s2k type.");if(e+=3,1e3+t[e++]!==1001)throw new yt("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new yt("Unknown s2k type.")}return e}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...d.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([f.write(f.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return d.concatUint8Array(t)}async produceKey(t,e){t=d.encodeUTF8(t);const r=[];let i=0,s=0;for(;i<e;){let a;switch(this.type){case"simple":a=d.concatUint8Array([new Uint8Array(s),t]);break;case"salted":a=d.concatUint8Array([new Uint8Array(s),this.salt,t]);break;case"iterated":{const c=d.concatUint8Array([this.salt,t]);let h=c.length;const l=Math.max(this.getCount(),h);a=new Uint8Array(s+l),a.set(c,s);for(let u=s+h;u<l;u+=h,h*=2)a.copyWithin(u,s,u);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await $.hash.digest(this.algorithm,a);r.push(o),i+=o.length,s++}return d.concatUint8Array(r).subarray(0,e)}}const V5=new Set([f.s2k.argon2,f.s2k.iterated]);function X3(n,t=W){switch(n){case f.s2k.argon2:return new $5(t);case f.s2k.iterated:case f.s2k.gnu:case f.s2k.salted:case f.s2k.simple:return new j5(n,t);default:throw new yt("Unsupported S2K type")}}function Z5(n){const{s2kType:t}=n;if(!V5.has(t))throw Error("The provided `config.s2kType` value is not allowed");return X3(t,n)}var _t=Uint8Array,ee=Uint16Array,ss=Uint32Array,as=new _t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),os=new _t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ya=new _t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tc=function(n,t){for(var e=new ee(31),r=0;r<31;++r)e[r]=t+=1<<n[r-1];var i=new ss(e[30]);for(r=1;r<30;++r)for(var s=e[r];s<e[r+1];++s)i[s]=s-e[r]<<5|r;return[e,i]},ec=tc(as,2),rc=ec[0],pa=ec[1];rc[28]=258,pa[258]=28;for(var a1=tc(os,0),Y5=a1[0],o1=a1[1],da=new ee(32768),dt=0;dt<32768;++dt){var Ur=(43690&dt)>>>1|(21845&dt)<<1;Ur=(61680&(Ur=(52428&Ur)>>>2|(13107&Ur)<<2))>>>4|(3855&Ur)<<4,da[dt]=((65280&Ur)>>>8|(255&Ur)<<8)>>>1}var _e=function(n,t,e){for(var r=n.length,i=0,s=new ee(t);i<r;++i)n[i]&&++s[n[i]-1];var a,o=new ee(t);for(i=0;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(e){a=new ee(1<<t);var c=15-t;for(i=0;i<r;++i)if(n[i])for(var h=i<<4|n[i],l=t-n[i],u=o[n[i]-1]++<<l,g=u|(1<<l)-1;u<=g;++u)a[da[u]>>>c]=h}else for(a=new ee(r),i=0;i<r;++i)n[i]&&(a[i]=da[o[n[i]-1]++]>>>15-n[i]);return a},mr=new _t(288);for(dt=0;dt<144;++dt)mr[dt]=8;for(dt=144;dt<256;++dt)mr[dt]=9;for(dt=256;dt<280;++dt)mr[dt]=7;for(dt=280;dt<288;++dt)mr[dt]=8;var Vn=new _t(32);for(dt=0;dt<32;++dt)Vn[dt]=5;var J5=_e(mr,9,0),W5=_e(mr,9,1),X5=_e(Vn,5,0),tl=_e(Vn,5,1),Ks=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},pe=function(n,t,e){var r=t/8|0;return(n[r]|n[r+1]<<8)>>(7&t)&e},Ps=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(7&t)},La=function(n){return(n+7)/8|0},_n=function(n,t,e){(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length);var r=new(n.BYTES_PER_ELEMENT==2?ee:n.BYTES_PER_ELEMENT==4?ss:_t)(e-t);return r.set(n.subarray(t,e)),r},el=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],se=function(n,t,e){var r=Error(t||el[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,se),!e)throw r;return r},ze=function(n,t,e){e<<=7&t;var r=t/8|0;n[r]|=e,n[r+1]|=e>>>8},In=function(n,t,e){e<<=7&t;var r=t/8|0;n[r]|=e,n[r+1]|=e>>>8,n[r+2]|=e>>>16},Ds=function(n,t){for(var e=[],r=0;r<n.length;++r)n[r]&&e.push({s:r,f:n[r]});var i=e.length,s=e.slice();if(!i)return[Ma,0];if(i==1){var a=new _t(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(U,K){return U.f-K.f}),e.push({s:-1,f:25001});var o=e[0],c=e[1],h=0,l=1,u=2;for(e[0]={s:-1,f:o.f+c.f,l:o,r:c};l!=i-1;)o=e[e[h].f<e[u].f?h++:u++],c=e[h!=l&&e[h].f<e[u].f?h++:u++],e[l++]={s:-1,f:o.f+c.f,l:o,r:c};var g=s[0].s;for(r=1;r<i;++r)s[r].s>g&&(g=s[r].s);var y=new ee(g+1),A=Aa(e[l-1],y,0);if(A>t){r=0;var p=0,w=A-t,k=1<<w;for(s.sort(function(U,K){return y[K.s]-y[U.s]||U.f-K.f});r<i;++r){var v=s[r].s;if(!(y[v]>t))break;p+=k-(1<<A-y[v]),y[v]=t}for(p>>>=w;p>0;){var m=s[r].s;y[m]<t?p-=1<<t-y[m]++-1:++r}for(;r>=0&&p;--r){var E=s[r].s;y[E]==t&&(--y[E],++p)}A=t}return[new _t(y),A]},Aa=function(n,t,e){return n.s==-1?Math.max(Aa(n.l,t,e+1),Aa(n.r,t,e+1)):t[n.s]=e},c1=function(n){for(var t=n.length;t&&!n[--t];);for(var e=new ee(++t),r=0,i=n[0],s=1,a=function(c){e[r++]=c},o=1;o<=t;++o)if(n[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=n[o]}return[e.subarray(0,r),t]},vn=function(n,t){for(var e=0,r=0;r<t.length;++r)e+=n[r]*t[r];return e},wa=function(n,t,e){var r=e.length,i=La(t+2);n[i]=255&r,n[i+1]=r>>>8,n[i+2]=255^n[i],n[i+3]=255^n[i+1];for(var s=0;s<r;++s)n[i+s+4]=e[s];return 8*(i+4+r)},l1=function(n,t,e,r,i,s,a,o,c,h,l){ze(t,l++,e),++i[256];for(var u=Ds(i,15),g=u[0],y=u[1],A=Ds(s,15),p=A[0],w=A[1],k=c1(g),v=k[0],m=k[1],E=c1(p),U=E[0],K=E[1],P=new ee(19),B=0;B<v.length;++B)P[31&v[B]]++;for(B=0;B<U.length;++B)P[31&U[B]]++;for(var b=Ds(P,7),x=b[0],C=b[1],S=19;S>4&&!x[ya[S-1]];--S);var I,D,Q,R,T=h+5<<3,G=vn(i,mr)+vn(s,Vn)+a,H=vn(i,g)+vn(s,p)+a+14+3*S+vn(P,x)+(2*P[16]+3*P[17]+7*P[18]);if(T<=G&&T<=H)return wa(t,l,n.subarray(c,c+h));if(ze(t,l,1+(H<G)),l+=2,H<G){I=_e(g,y,0),D=g,Q=_e(p,w,0),R=p;var L=_e(x,C,0);for(ze(t,l,m-257),ze(t,l+5,K-1),ze(t,l+10,S-4),l+=14,B=0;B<S;++B)ze(t,l+3*B,x[ya[B]]);l+=3*S;for(var M=[v,U],_=0;_<2;++_){var z=M[_];for(B=0;B<z.length;++B){var N=31&z[B];ze(t,l,L[N]),l+=x[N],N>15&&(ze(t,l,z[B]>>>5&127),l+=z[B]>>>12)}}}else I=J5,D=mr,Q=X5,R=Vn;for(B=0;B<o;++B)if(r[B]>255){N=r[B]>>>18&31,In(t,l,I[N+257]),l+=D[N+257],N>7&&(ze(t,l,r[B]>>>23&31),l+=as[N]);var O=31&r[B];In(t,l,Q[O]),l+=R[O],O>3&&(In(t,l,r[B]>>>5&8191),l+=os[O])}else In(t,l,I[r[B]]),l+=D[r[B]];return In(t,l,I[256]),l+D[256]},rl=new ss([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ma=new _t(0),nc=function(n,t,e,r,i){return function(s,a,o,c,h,l){var u=s.length,g=new _t(c+u+5*(1+Math.ceil(u/7e3))+h),y=g.subarray(c,g.length-h),A=0;if(!a||u<8)for(var p=0;p<=u;p+=65535){var w=p+65535;w>=u&&(y[A>>3]=l),A=wa(y,A+1,s.subarray(p,w))}else{for(var k=rl[a-1],v=k>>>13,m=8191&k,E=(1<<o)-1,U=new ee(32768),K=new ee(E+1),P=Math.ceil(o/3),B=2*P,b=function(Vr){return(s[Vr]^s[Vr+1]<<P^s[Vr+2]<<B)&E},x=new ss(25e3),C=new ee(288),S=new ee(32),I=0,D=0,Q=(p=0,0),R=0,T=0;p<u;++p){var G=b(p),H=32767&p,L=K[G];if(U[H]=L,K[G]=H,R<=p){var M=u-p;if((I>7e3||Q>24576)&&M>423){A=l1(s,y,0,x,C,S,D,Q,T,p-T,A),Q=I=D=0,T=p;for(var _=0;_<286;++_)C[_]=0;for(_=0;_<30;++_)S[_]=0}var z=2,N=0,O=m,q=H-L&32767;if(M>2&&G==b(p-q))for(var X=Math.min(v,M)-1,Y=Math.min(32767,p),nt=Math.min(258,M);q<=Y&&--O&&H!=L;){if(s[p+z]==s[p+z-q]){for(var tt=0;tt<nt&&s[p+tt]==s[p+tt-q];++tt);if(tt>z){if(z=tt,N=q,tt>X)break;var ot=Math.min(q,tt-2),ht=0;for(_=0;_<ot;++_){var mt=p-q+_+32768&32767,kt=mt-U[mt]+32768&32767;kt>ht&&(ht=kt,L=mt)}}}q+=(H=L)-(L=U[H])+32768&32767}if(N){x[Q++]=268435456|pa[z]<<18|o1[N];var Bt=31&pa[z],bn=31&o1[N];D+=as[Bt]+os[bn],++C[257+Bt],++S[bn],R=p+z,++I}else x[Q++]=s[p],++C[s[p]]}}A=l1(s,y,l,x,C,S,D,Q,T,p-T,A),!l&&7&A&&(A=wa(y,A+1,Ma))}return _n(g,0,c+La(A)+h)}(n,t.level==null?6:t.level,t.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):12+t.mem,e,r,!i)},ba=function(){function n(t,e){e||typeof t!="function"||(e=t,t={}),this.ondata=e,this.o=t||{}}return n.prototype.p=function(t,e){this.ondata(nc(t,this.o,0,0,!e),e)},n.prototype.push=function(t,e){this.ondata||se(5),this.d&&se(4),this.d=e,this.p(t,e||!1)},n}(),Ci=function(){function n(t){this.s={},this.p=new _t(0),this.ondata=t}return n.prototype.e=function(t){this.ondata||se(5),this.d&&se(4);var e=this.p.length,r=new _t(e+t.length);r.set(this.p),r.set(t,e),this.p=r},n.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,r=function(i,s,a){var o=i.length;if(!o||a&&a.f&&!a.l)return s||new _t(0);var c=!s||a,h=!a||a.i;a||(a={}),s||(s=new _t(3*o));var l=function(tt){var ot=s.length;if(tt>ot){var ht=new _t(Math.max(2*ot,tt));ht.set(s),s=ht}},u=a.f||0,g=a.p||0,y=a.b||0,A=a.l,p=a.d,w=a.m,k=a.n,v=8*o;do{if(!A){u=pe(i,g,1);var m=pe(i,g+1,3);if(g+=3,!m){var E=i[(Q=La(g)+4)-4]|i[Q-3]<<8,U=Q+E;if(U>o){h&&se(0);break}c&&l(y+E),s.set(i.subarray(Q,U),y),a.b=y+=E,a.p=g=8*U,a.f=u;continue}if(m==1)A=W5,p=tl,w=9,k=5;else if(m==2){var K=pe(i,g,31)+257,P=pe(i,g+10,15)+4,B=K+pe(i,g+5,31)+1;g+=14;for(var b=new _t(B),x=new _t(19),C=0;C<P;++C)x[ya[C]]=pe(i,g+3*C,7);g+=3*P;var S=Ks(x),I=(1<<S)-1,D=_e(x,S,1);for(C=0;C<B;){var Q,R=D[pe(i,g,I)];if(g+=15&R,(Q=R>>>4)<16)b[C++]=Q;else{var T=0,G=0;for(Q==16?(G=3+pe(i,g,3),g+=2,T=b[C-1]):Q==17?(G=3+pe(i,g,7),g+=3):Q==18&&(G=11+pe(i,g,127),g+=7);G--;)b[C++]=T}}var H=b.subarray(0,K),L=b.subarray(K);w=Ks(H),k=Ks(L),A=_e(H,w,1),p=_e(L,k,1)}else se(1);if(g>v){h&&se(0);break}}c&&l(y+131072);for(var M=(1<<w)-1,_=(1<<k)-1,z=g;;z=g){var N=(T=A[Ps(i,g)&M])>>>4;if((g+=15&T)>v){h&&se(0);break}if(T||se(2),N<256)s[y++]=N;else{if(N==256){z=g,A=null;break}var O=N-254;if(N>264){var q=as[C=N-257];O=pe(i,g,(1<<q)-1)+rc[C],g+=q}var X=p[Ps(i,g)&_],Y=X>>>4;if(X||se(3),g+=15&X,L=Y5[Y],Y>3&&(q=os[Y],L+=Ps(i,g)&(1<<q)-1,g+=q),g>v){h&&se(0);break}c&&l(y+131072);for(var nt=y+O;y<nt;y+=4)s[y]=s[y-L],s[y+1]=s[y+1-L],s[y+2]=s[y+2-L],s[y+3]=s[y+3-L];y=nt}}a.l=A,a.p=z,a.b=y,a.f=u,A&&(u=1,a.m=w,a.d=p,a.n=k)}while(!u);return y==s.length?s:_n(s,0,y)}(this.p,this.o,this.s);this.ondata(_n(r,e,this.s.b),this.d),this.o=_n(r,this.s.b-32768),this.s.b=this.o.length,this.p=_n(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(t,e){this.e(t),this.c(e)},n}(),nl=function(){function n(t,e){var r,i;this.c=(r=1,i=0,{p:function(s){for(var a=r,o=i,c=0|s.length,h=0;h!=c;){for(var l=Math.min(h+2655,c);h<l;++h)o+=a+=s[h];a=(65535&a)+15*(a>>16),o=(65535&o)+15*(o>>16)}r=a,i=o},d:function(){return(255&(r%=65521))<<24|r>>>8<<16|(255&(i%=65521))<<8|i>>>8}}),this.v=1,ba.call(this,t,e)}return n.prototype.push=function(t,e){ba.prototype.push.call(this,t,e)},n.prototype.p=function(t,e){this.c.p(t);var r=nc(t,this.o,this.v&&2,e&&4,!e);this.v&&(function(i,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;i[0]=120,i[1]=o<<6|(o?32-2*o:1)}(r,this.o),this.v=0),e&&function(i,s,a){for(;a;++s)i[s]=a,a>>>=8}(r,r.length-4,this.c.d()),this.ondata(r,e)},n}(),il=function(){function n(t){this.v=1,Ci.call(this,t)}return n.prototype.push=function(t,e){if(Ci.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}e&&(this.p.length<4&&se(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Ci.prototype.c.call(this,e)},n}(),sl=typeof TextDecoder<"u"&&new TextDecoder;try{sl.decode(Ma,{stream:!0})}catch{}class Xn{static get tag(){return f.packet.literalData}constructor(t=new Date){this.format=f.literal.utf8,this.date=d.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,e=f.literal.utf8){this.format=e,this.text=t,this.data=null}getText(t=!1){return(this.text===null||d.isStream(this.text))&&(this.text=d.decodeUTF8(d.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,e){this.format=e,this.data=t,this.text=null}getBytes(t=!1){return this.data===null&&(this.data=d.canonicalizeEOL(d.encodeUTF8(this.text))),t?On(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}async read(t){await ts(t,async e=>{const r=await e.readByte(),i=await e.readByte();this.filename=d.decodeUTF8(await e.readBytes(i)),this.date=d.readDate(await e.readBytes(4));let s=e.remainder();Ct(s)&&(s=await Ut(s)),this.setBytes(s,r)})}writeHeader(){const t=d.encodeUTF8(this.filename),e=new Uint8Array([t.length]),r=new Uint8Array([this.format]),i=d.writeDate(this.date);return d.concatUint8Array([r,e,t,i])}write(){const t=this.writeHeader(),e=this.getBytes();return d.concat([t,e])}}class Te{constructor(){this.bytes=""}read(t){return this.bytes=d.uint8ArrayToString(t.subarray(0,8)),this.bytes.length}write(){return d.stringToUint8Array(this.bytes)}toHex(){return d.uint8ArrayToHex(d.stringToUint8Array(this.bytes))}equals(t,e=!1){return e&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const e=new Te;return e.read(d.hexToUint8Array(t)),e}static wildcard(){const t=new Te;return t.read(new Uint8Array(8)),t}}const Sn=Symbol("verified"),h1="salt@notations.openpgpjs.org",al=new Set([f.signatureSubpacket.issuerKeyID,f.signatureSubpacket.issuerFingerprint,f.signatureSubpacket.embeddedSignature]);class $t{static get tag(){return f.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Te,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[Sn]=null}read(t,e=W){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new yt("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new yt(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[r++],this.publicKeyAlgorithm=t[r++],this.hashAlgorithm=t[r++],r+=this.readSubPackets(t.subarray(r,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=t.subarray(0,r),r+=this.readSubPackets(t.subarray(r,t.length),!1),this.signedHashValue=t.subarray(r,r+2),r+=2,this.version===6){const o=t[r++];this.salt=t.subarray(r,r+o),r+=o}const i=t.subarray(r,t.length),{read:s,signatureParams:a}=$.signature.parseSignatureParams(this.publicKeyAlgorithm,i);if(s<i.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?kr(async()=>$.serializeParams(this.publicKeyAlgorithm,await this.params)):$.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),this.version===6&&(t.push(new Uint8Array([this.salt.length])),t.push(this.salt)),t.push(this.writeParams()),d.concat(t)}async sign(t,e,r=new Date,i=!1,s){this.version=t.version,this.created=d.normalizeDate(r),this.issuerKeyVersion=t.version,this.issuerFingerprint=t.getFingerprintBytes(),this.issuerKeyID=t.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const l=Qs(this.hashAlgorithm);if(this.salt===null)this.salt=$.random.getRandomBytes(l);else if(l!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter(({name:l})=>l===h1).length!==0)throw Error("Unexpected existing salt notation");{const l=$.random.getRandomBytes(Qs(this.hashAlgorithm));this.rawNotations.push({name:h1,value:l,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=d.concat(a);const o=this.toHash(this.signatureType,e,i),c=await this.hash(this.signatureType,e,o,i);this.signedHashValue=Tt(Nr(c),0,2);const h=async()=>$.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,t.publicParams,t.privateParams,o,await Ut(c));d.isStream(c)?this.params=h():(this.params=await h(),this[Sn]=!0)}writeHashedSubPackets(){const t=f.signatureSubpacket,e=[];let r;if(this.created===null)throw Error("Missing signature creation time");e.push(ut(t.signatureCreationTime,!0,d.writeDate(this.created))),this.signatureExpirationTime!==null&&e.push(ut(t.signatureExpirationTime,!0,d.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&e.push(ut(t.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),e.push(ut(t.trustSignature,!0,r))),this.regularExpression!==null&&e.push(ut(t.regularExpression,!0,this.regularExpression)),this.revocable!==null&&e.push(ut(t.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&e.push(ut(t.keyExpirationTime,!0,d.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.preferredSymmetricAlgorithms)),e.push(ut(t.preferredSymmetricAlgorithms,!1,r))),this.revocationKeyClass!==null&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=d.concat([r,this.revocationKeyFingerprint]),e.push(ut(t.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&e.push(ut(t.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:a,value:o,humanReadable:c,critical:h})=>{r=[new Uint8Array([c?128:0,0,0,0])];const l=d.encodeUTF8(a);r.push(d.writeNumber(l.length,2)),r.push(d.writeNumber(o.length,2)),r.push(l),r.push(o),r=d.concat(r),e.push(ut(t.notationData,h,r))}),this.preferredHashAlgorithms!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.preferredHashAlgorithms)),e.push(ut(t.preferredHashAlgorithms,!1,r))),this.preferredCompressionAlgorithms!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.preferredCompressionAlgorithms)),e.push(ut(t.preferredCompressionAlgorithms,!1,r))),this.keyServerPreferences!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.keyServerPreferences)),e.push(ut(t.keyServerPreferences,!1,r))),this.preferredKeyServer!==null&&e.push(ut(t.preferredKeyServer,!1,d.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&e.push(ut(t.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&e.push(ut(t.policyURI,!1,d.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.keyFlags)),e.push(ut(t.keyFlags,!0,r))),this.signersUserID!==null&&e.push(ut(t.signersUserID,!1,d.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(r=d.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),e.push(ut(t.reasonForRevocation,!0,r))),this.features!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.features)),e.push(ut(t.features,!1,r))),this.signatureTargetPublicKeyAlgorithm!==null&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(d.stringToUint8Array(this.signatureTargetHash)),r=d.concat(r),e.push(ut(t.signatureTarget,!0,r))),this.embeddedSignature!==null&&e.push(ut(t.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=d.concat(r),e.push(ut(t.issuerFingerprint,this.version>=5,r))),this.preferredAEADAlgorithms!==null&&(r=d.stringToUint8Array(d.uint8ArrayToString(this.preferredAEADAlgorithms)),e.push(ut(t.preferredAEADAlgorithms,!1,r))),this.preferredCipherSuites!==null&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),e.push(ut(t.preferredCipherSuites,!1,r)));const i=d.concat(e),s=d.writeNumber(i.length,this.version===6?4:2);return d.concat([s,i])}writeUnhashedSubPackets(){const t=this.unhashedSubpackets.map(({type:i,critical:s,body:a})=>ut(i,s,a)),e=d.concat(t),r=d.writeNumber(e.length,this.version===6?4:2);return d.concat([r,e])}readSubPacket(t,e=!0){let r=0;const i=!!(128&t[r]),s=127&t[r];if(r++,e||(this.unhashedSubpackets.push({type:s,critical:i,body:t.subarray(r,t.length)}),al.has(s)))switch(s){case f.signatureSubpacket.signatureCreationTime:this.created=d.readDate(t.subarray(r,t.length));break;case f.signatureSubpacket.signatureExpirationTime:{const a=d.readNumber(t.subarray(r,t.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case f.signatureSubpacket.exportableCertification:this.exportable=t[r++]===1;break;case f.signatureSubpacket.trustSignature:this.trustLevel=t[r++],this.trustAmount=t[r++];break;case f.signatureSubpacket.regularExpression:this.regularExpression=t[r];break;case f.signatureSubpacket.revocable:this.revocable=t[r++]===1;break;case f.signatureSubpacket.keyExpirationTime:{const a=d.readNumber(t.subarray(r,t.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case f.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.revocationKey:this.revocationKeyClass=t[r++],this.revocationKeyAlgorithm=t[r++],this.revocationKeyFingerprint=t.subarray(r,r+20);break;case f.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(t.subarray(r,t.length));else if(e)throw Error("Unexpected Issuer Key ID subpacket");break;case f.signatureSubpacket.notationData:{const a=!!(128&t[r]);r+=4;const o=d.readNumber(t.subarray(r,r+2));r+=2;const c=d.readNumber(t.subarray(r,r+2));r+=2;const h=d.decodeUTF8(t.subarray(r,r+o)),l=t.subarray(r+o,r+o+c);this.rawNotations.push({name:h,humanReadable:a,value:l,critical:i}),a&&(this.notations[h]=d.decodeUTF8(l));break}case f.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=d.decodeUTF8(t.subarray(r,t.length));break;case f.signatureSubpacket.primaryUserID:this.isPrimaryUserID=t[r++]!==0;break;case f.signatureSubpacket.policyURI:this.policyURI=d.decodeUTF8(t.subarray(r,t.length));break;case f.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.signersUserID:this.signersUserID=d.decodeUTF8(t.subarray(r,t.length));break;case f.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[r++],this.reasonForRevocationString=d.decodeUTF8(t.subarray(r,t.length));break;case f.signatureSubpacket.features:this.features=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[r++],this.signatureTargetHashAlgorithm=t[r++];const a=$.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=d.uint8ArrayToString(t.subarray(r,r+a));break}case f.signatureSubpacket.embeddedSignature:this.embeddedSignature=new $t,this.embeddedSignature.read(t.subarray(r,t.length));break;case f.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[r++],this.issuerFingerprint=t.subarray(r,t.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case f.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(r,t.length)];break;case f.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=r;a<t.length;a+=2)this.preferredCipherSuites.push([t[a],t[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:i,body:t.subarray(r,t.length)})}}readSubPackets(t,e=!0,r){const i=this.version===6?4:2,s=d.readNumber(t.subarray(0,i));let a=i;for(;a<2+s;){const o=U5(t.subarray(a,t.length));a+=o.offset,this.readSubPacket(t.subarray(a,a+o.len),e,r),a+=o.len}return a}toSign(t,e){const r=f.signature;switch(t){case r.binary:return e.text!==null?d.encodeUTF8(e.getText(!0)):e.getBytes(!0);case r.text:{const i=e.getBytes(!0);return d.canonicalizeEOL(i)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let i,s;if(e.userID)s=180,i=e.userID;else{if(!e.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,i=e.userAttribute}const a=i.write();return d.concat([this.toSign(r.key,e),new Uint8Array([s]),d.writeNumber(a.length,4),a])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return d.concat([this.toSign(r.key,e),this.toSign(r.key,{key:e.bind})]);case r.key:if(e.key===void 0)throw Error("Key packet is required for this signature.");return e.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,e);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,e){let r=0;return Et(Nr(this.signatureData),i=>{r+=i.length},()=>{const i=[];return this.version!==5||this.signatureType!==f.signature.binary&&this.signatureType!==f.signature.text||(e?i.push(new Uint8Array(6)):i.push(t.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(d.writeNumber(r,4)),d.concat(i)})}toHash(t,e,r=!1){const i=this.toSign(t,e);return d.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(e,r)])}async hash(t,e,r,i=!1){if(this.version===6&&this.salt.length!==Qs(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(t,e,i)),$.hash.digest(this.hashAlgorithm,r)}async verify(t,e,r,i=new Date,s=!1,a=W){if(!this.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=e===f.signature.binary||e===f.signature.text;if(!(this[Sn]&&!o)){let h,l;if(this.hashed?l=await this.hashed:(h=this.toHash(e,r,s),l=await this.hash(e,r,h)),l=await Ut(l),this.signedHashValue[0]!==l[0]||this.signedHashValue[1]!==l[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Sn]=await $.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,t.publicParams,h,l),!this[Sn])throw Error("Signature verification failed")}const c=d.normalizeDate(i);if(c&&this.created>c)throw Error("Signature creation time is in the future");if(c&&c>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+f.read(f.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[f.signature.binary,f.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+f.read(f.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:h,critical:l})=>{if(l)throw Error("Unknown critical signature subpacket type "+h)}),this.rawNotations.forEach(({name:h,critical:l})=>{if(l&&a.knownNotations.indexOf(h)<0)throw Error("Unknown critical notation: "+h)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(t=new Date){const e=d.normalizeDate(t);return e!==null&&!(this.created<=e&&e<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function ut(n,t,e){const r=[];return r.push(_a(e.length+1)),r.push(new Uint8Array([(t?128:0)|n])),r.push(e),d.concat(r)}function Qs(n){switch(n){case f.hash.sha256:return 16;case f.hash.sha384:return 24;case f.hash.sha512:return 32;case f.hash.sha224:case f.hash.sha3_256:return 16;case f.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class ye{static get tag(){return f.packet.onePassSignature}static fromSignaturePacket(t,e){const r=new ye;return r.version=t.version===6?6:3,r.signatureType=t.signatureType,r.hashAlgorithm=t.hashAlgorithm,r.publicKeyAlgorithm=t.publicKeyAlgorithm,r.issuerKeyID=t.issuerKeyID,r.salt=t.salt,r.issuerFingerprint=t.issuerFingerprint,r.flags=e?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new yt(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=t[e++],this.hashAlgorithm=t[e++],this.publicKeyAlgorithm=t[e++],this.version===6){const r=t[e++];this.salt=t.subarray(e,e+r),e+=r,this.issuerFingerprint=t.subarray(e,e+32),e+=32,this.issuerKeyID=new Te,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Te,this.issuerKeyID.read(t.subarray(e,e+8)),e+=8;return this.flags=t[e++],this}write(){const t=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?t.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):t.push(this.issuerKeyID.write()),t.push(new Uint8Array([this.flags])),d.concatUint8Array(t)}calculateTrailer(...t){return kr(async()=>$t.prototype.calculateTrailer.apply(await this.correspondingSig,t))}async verify(){const t=await this.correspondingSig;if(!t||t.constructor.tag!==f.packet.signature)throw Error("Corresponding signature packet missing");if(t.signatureType!==this.signatureType||t.hashAlgorithm!==this.hashAlgorithm||t.publicKeyAlgorithm!==this.publicKeyAlgorithm||!t.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&t.version===6||this.version===6&&t.version!==6||this.version===6&&!d.equalsUint8Array(t.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!d.equalsUint8Array(t.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return t.hashed=this.hashed,t.verify.apply(t,arguments)}}function ol(n,t){if(!t[n]){let e;try{e=f.read(f.packet,n)}catch{throw new L3("Unknown packet type with tag: "+n)}throw Error("Packet not allowed in this context: "+e)}return new t[n]}ye.prototype.hash=$t.prototype.hash,ye.prototype.toHash=$t.prototype.toHash,ye.prototype.toSign=$t.prototype.toSign;class xt extends Array{static async fromBinary(t,e,r=W){const i=new xt;return await i.read(t,e,r),i}async read(t,e,r=W){r.additionalAllowedPackets.length&&(e={...e,...d.constructAllowedPackets(r.additionalAllowedPackets)}),this.stream=Er(t,async(s,a)=>{const o=le(a);try{for(;;)if(await o.ready,await P5(s,async c=>{try{if(c.tag===f.packet.marker||c.tag===f.packet.trust||c.tag===f.packet.padding)return;const h=ol(c.tag,e);h.packets=new xt,h.fromStream=d.isStream(c.packet),await h.read(c.packet,r),await o.write(h)}catch(h){if(h instanceof L3){if(!(c.tag<=39))return;await o.abort(h)}const l=!r.ignoreUnsupportedPackets&&h instanceof yt,u=!(r.ignoreMalformedPackets||h instanceof yt);if(l||u||Si(c.tag))await o.abort(h);else{const g=new Vo(c.tag,c.packet);await o.write(g)}d.printDebugError(h)}}))return await o.ready,void await o.close()}catch(c){await o.abort(c)}});const i=tr(this.stream);for(;;){const{done:s,value:a}=await i.read();if(s?this.stream=null:this.push(a),s||Si(a.constructor.tag))break}i.releaseLock()}write(){const t=[];for(let e=0;e<this.length;e++){const r=this[e]instanceof Vo?this[e].tag:this[e].constructor.tag,i=this[e].write();if(d.isStream(i)&&Si(this[e].constructor.tag)){let s=[],a=0;const o=512;t.push(T3(r)),t.push(Et(i,c=>{if(s.push(c),a+=c.length,a>=o){const h=Math.min(Math.log(a)/Math.LN2|0,30),l=2**h,u=d.concat([K5(h)].concat(s));return s=[u.subarray(1+l)],a=s[0].length,u.subarray(0,1+l)}},()=>d.concat([_a(a)].concat(s))))}else{if(d.isStream(i)){let s=0;t.push(Et(Nr(i),a=>{s+=a.length},()=>jo(r,s)))}else t.push(jo(r,i.length));t.push(i)}}return d.concat(t)}filterByTag(...t){const e=new xt,r=i=>s=>i===s;for(let i=0;i<this.length;i++)t.some(r(this[i].constructor.tag))&&e.push(this[i]);return e}findPacket(t){return this.find(e=>e.constructor.tag===t)}indexOfTag(...t){const e=[],r=this,i=s=>a=>s===a;for(let s=0;s<this.length;s++)t.some(i(r[s].constructor.tag))&&e.push(s);return e}}const cl=d.constructAllowedPackets([Xn,ye,$t]);class ti{static get tag(){return f.packet.compressedData}constructor(t=W){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null}async read(t,e=W){await ts(t,async r=>{this.algorithm=await r.readByte(),this.compressed=r.remainder(),await this.decompress(e)})}write(){return this.compressed===null&&this.compress(),d.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(t=W){const e=f.read(f.compression,this.algorithm),r=ul[e];if(!r)throw Error(e+" decompression not supported");this.packets=await xt.fromBinary(await r(this.compressed),cl,t)}compress(){const t=f.read(f.compression,this.algorithm),e=hl[t];if(!e)throw Error(t+" compression not supported");this.compressed=e(this.packets.write())}}function qi(n,t){return e=>{if(!d.isStream(e)||Ct(e))return kr(()=>Ut(e).then(s=>new Promise((a,o)=>{const c=new t;c.ondata=h=>{a(h)};try{c.push(s,!0)}catch(h){o(h)}})));if(n)try{const s=n();return e.pipeThrough(s)}catch(s){if(s.name!=="TypeError")throw s}const r=e.getReader(),i=new t;return new ReadableStream({async start(s){for(i.ondata=async(a,o)=>{s.enqueue(a),o&&s.close()};;){const{done:a,value:o}=await r.read();if(a)return void i.push(new Uint8Array,!0);o.length&&i.push(o)}}})}}function ll(){return async function(n){const{decode:t}=await Promise.resolve().then(function(){return ch});return kr(async()=>t(await Ut(n)))}}const $i=n=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(n)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(n))}),hl={zip:qi($i("deflate-raw").compressor,ba),zlib:qi($i("deflate").compressor,nl)},ul={uncompressed:n=>n,zip:qi($i("deflate-raw").decompressor,Ci),zlib:qi($i("deflate").decompressor,il),bzip2:ll()},fl=d.constructAllowedPackets([Xn,ti,ye,$t]);class yn{static get tag(){return f.packet.symEncryptedIntegrityProtectedData}static fromObject({version:t,aeadAlgorithm:e}){if(t!==1&&t!==2)throw Error("Unsupported SEIPD version");const r=new yn;return r.version=t,t===2&&(r.aeadAlgorithm=e),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(t){await ts(t,async e=>{if(this.version=await e.readByte(),this.version!==1&&this.version!==2)throw new yt(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()})}write(){return this.version===2?d.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):d.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(t,e,r=W){const{blockSize:i,keySize:s}=$.getCipherParams(t);if(e.length!==s)throw Error("Unexpected session key size");let a=this.packets.write();if(Ct(a)&&(a=await Ut(a)),this.version===2)this.cipherAlgorithm=t,this.salt=$.random.getRandomBytes(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await ji(this,"encrypt",e,a);else{const o=await $.getPrefixRandom(t),c=new Uint8Array([211,20]),h=d.concat([o,a,c]),l=await $.hash.sha1(On(h)),u=d.concat([h,l]);this.encrypted=await $.mode.cfb.encrypt(t,e,u,new Uint8Array(i),r)}return!0}async decrypt(t,e,r=W){if(e.length!==$.getCipherParams(t).keySize)throw Error("Unexpected session key size");let i,s=Nr(this.encrypted);if(Ct(s)&&(s=await Ut(s)),this.version===2){if(this.cipherAlgorithm!==t)throw Error("Unexpected session key algorithm");i=await ji(this,"decrypt",e,s)}else{const{blockSize:a}=$.getCipherParams(t),o=await $.mode.cfb.decrypt(t,e,s,new Uint8Array(a)),c=Tt(On(o),-20),h=Tt(o,0,-20),l=Promise.all([Ut(await $.hash.sha1(On(h))),Ut(c)]).then(([g,y])=>{if(!d.equalsUint8Array(g,y))throw Error("Modification detected.");return new Uint8Array}),u=Tt(h,a+2);i=Tt(u,0,-2),i=Wt([i,kr(()=>l)]),d.isStream(s)&&r.allowUnauthenticatedStream||(i=await Ut(i))}return this.packets=await xt.fromBinary(i,fl,r),!0}}async function ji(n,t,e,r){const i=n instanceof yn&&n.version===2,s=!i&&n.constructor.tag===f.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=$.getAEADMode(n.aeadAlgorithm),o=t==="decrypt"?a.tagLength:0,c=t==="encrypt"?a.tagLength:0,h=2**(n.chunkSizeByte+6)+o,l=s?8:0,u=new ArrayBuffer(13+l),g=new Uint8Array(u,0,5+l),y=new Uint8Array(u),A=new DataView(u),p=new Uint8Array(u,5,8);g.set([192|n.constructor.tag,n.version,n.cipherAlgorithm,n.aeadAlgorithm,n.chunkSizeByte],0);let w,k,v=0,m=Promise.resolve(),E=0,U=0;if(i){const{keySize:P}=$.getCipherParams(n.cipherAlgorithm),{ivLength:B}=a,b=new Uint8Array(u,0,5),x=await Qr(f.hash.sha256,e,n.salt,b,P+B);e=x.subarray(0,P),w=x.subarray(P),w.fill(0,w.length-8),k=new DataView(w.buffer,w.byteOffset,w.byteLength)}else w=n.iv;const K=await a(n.cipherAlgorithm,e);return Er(r,async(P,B)=>{if(d.isStream(P)!=="array"){const C=new TransformStream({},{highWaterMark:d.getHardwareConcurrency()*2**(n.chunkSizeByte+6),size:S=>S.length});Mr(C.readable,B),B=C.writable}const b=tr(P),x=le(B);try{for(;;){let C=await b.readBytes(h+o)||new Uint8Array;const S=C.subarray(C.length-o);let I,D,Q;if(C=C.subarray(0,C.length-o),i)Q=w;else{Q=w.slice();for(let R=0;R<8;R++)Q[w.length-8+R]^=p[R]}if(!v||C.length?(b.unshift(S),I=K[t](C,Q,g),I.catch(()=>{}),U+=C.length-o+c):(A.setInt32(5+l+4,E),I=K[t](S,Q,y),I.catch(()=>{}),U+=c,D=!0),E+=C.length-o,m=m.then(()=>I).then(async R=>{await x.ready,await x.write(R),U-=R.length}).catch(R=>x.abort(R)),(D||U>x.desiredSize)&&await m,D){await x.close();break}i?k.setInt32(w.length-4,++v):A.setInt32(9,++v)}}catch(C){await x.ready.catch(()=>{}),await x.abort(C)}})}const gl=d.constructAllowedPackets([Xn,ti,ye,$t]);class yl{static get tag(){return f.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=f.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(t){await ts(t,async e=>{const r=await e.readByte();if(r!==1)throw new yt(`Version ${r} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const i=$.getAEADMode(this.aeadAlgorithm);this.iv=await e.readBytes(i.ivLength),this.encrypted=e.remainder()})}write(){return d.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(t,e,r=W){this.packets=await xt.fromBinary(await ji(this,"decrypt",e,Nr(this.encrypted)),gl,r)}async encrypt(t,e,r=W){this.cipherAlgorithm=t;const{ivLength:i}=$.getAEADMode(this.aeadAlgorithm);this.iv=$.random.getRandomBytes(i),this.chunkSizeByte=r.aeadChunkSizeByte;const s=this.packets.write();this.encrypted=await ji(this,"encrypt",e,s)}}class Zn{static get tag(){return f.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Te,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:t,encryptionKeyPacket:e,anonymousRecipient:r,sessionKey:i,sessionKeyAlgorithm:s}){const a=new Zn;if(t!==3&&t!==6)throw Error("Unsupported PKESK version");return a.version=t,t===6&&(a.publicKeyVersion=r?null:e.version,a.publicKeyFingerprint=r?null:e.getFingerprintBytes()),a.publicKeyID=r?Te.wildcard():e.getKeyID(),a.publicKeyAlgorithm=e.algorithm,a.sessionKey=i,a.sessionKeyAlgorithm=s,a}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new yt(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){const r=t[e++];if(r){this.publicKeyVersion=t[e++];const i=r-1;this.publicKeyFingerprint=t.subarray(e,e+i),e+=i,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Te.wildcard()}else e+=this.publicKeyID.read(t.subarray(e,e+8));if(this.publicKeyAlgorithm=t[e++],this.encrypted=$.parseEncSessionKeyParams(this.publicKeyAlgorithm,t.subarray(e)),this.publicKeyAlgorithm===f.publicKey.x25519||this.publicKeyAlgorithm===f.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=f.write(f.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){const t=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(t.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),t.push(this.publicKeyFingerprint)):t.push(new Uint8Array([0])):t.push(this.publicKeyID.write()),t.push(new Uint8Array([this.publicKeyAlgorithm]),$.serializeParams(this.publicKeyAlgorithm,this.encrypted)),d.concatUint8Array(t)}async encrypt(t){const e=f.write(f.publicKey,this.publicKeyAlgorithm),r=this.version===3?this.sessionKeyAlgorithm:null,i=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=u1(this.version,e,r,this.sessionKey);this.encrypted=await $.publicKeyEncrypt(e,r,t.publicParams,s,i)}async decrypt(t,e){if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const r=e?u1(this.version,this.publicKeyAlgorithm,e.sessionKeyAlgorithm,e.sessionKey):null,i=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=await $.publicKeyDecrypt(this.publicKeyAlgorithm,t.publicParams,t.privateParams,this.encrypted,i,r),{sessionKey:a,sessionKeyAlgorithm:o}=function(c,h,l,u){switch(h){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.elgamal:case f.publicKey.ecdh:{const g=l.subarray(0,l.length-2),y=l.subarray(l.length-2),A=d.writeChecksum(g.subarray(g.length%8)),p=A[0]===y[0]&A[1]===y[1],w=c===6?{sessionKeyAlgorithm:null,sessionKey:g}:{sessionKeyAlgorithm:g[0],sessionKey:g.subarray(1)};if(u){const k=p&w.sessionKeyAlgorithm===u.sessionKeyAlgorithm&w.sessionKey.length===u.sessionKey.length;return{sessionKey:d.selectUint8Array(k,w.sessionKey,u.sessionKey),sessionKeyAlgorithm:c===6?null:d.selectUint8(k,w.sessionKeyAlgorithm,u.sessionKeyAlgorithm)}}if(p&&(c===6||f.read(f.symmetric,w.sessionKeyAlgorithm)))return w;throw Error("Decryption error")}case f.publicKey.x25519:case f.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:l};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,s,e);if(this.version===3){const c=this.publicKeyAlgorithm!==f.publicKey.x25519&&this.publicKeyAlgorithm!==f.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==$.getCipherParams(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a}}function u1(n,t,e,r){switch(t){case f.publicKey.rsaEncrypt:case f.publicKey.rsaEncryptSign:case f.publicKey.elgamal:case f.publicKey.ecdh:return d.concatUint8Array([new Uint8Array(n===6?[]:[e]),r,d.writeChecksum(r.subarray(r.length%8))]);case f.publicKey.x25519:case f.publicKey.x448:return r;default:throw Error("Unsupported public key algorithm")}}class pn{static get tag(){return f.packet.symEncryptedSessionKey}constructor(t=W){this.version=t.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=f.write(f.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let e=0;if(this.version=t[e++],this.version!==4&&this.version!==5&&this.version!==6)throw new yt(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&e++;const r=t[e++];this.version>=5&&(this.aeadAlgorithm=t[e++],this.version===6&&e++);const i=t[e++];if(this.s2k=X3(i),e+=this.s2k.read(t.subarray(e,t.length)),this.version>=5){const s=$.getAEADMode(this.aeadAlgorithm);this.iv=t.subarray(e,e+=s.ivLength)}this.version>=5||e<t.length?(this.encrypted=t.subarray(e,t.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const t=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let e;const r=this.s2k.write();if(this.version===6){const i=r.length,s=3+i+this.iv.length;e=d.concatUint8Array([new Uint8Array([this.version,s,t,this.aeadAlgorithm,i]),r,this.iv,this.encrypted])}else this.version===5?e=d.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(e=d.concatUint8Array([new Uint8Array([this.version,t]),r]),this.encrypted!==null&&(e=d.concatUint8Array([e,this.encrypted])));return e}async decrypt(t){const e=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:i}=$.getCipherParams(e),s=await this.s2k.produceKey(t,i);if(this.version>=5){const a=$.getAEADMode(this.aeadAlgorithm),o=new Uint8Array([192|pn.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?await Qr(f.hash.sha256,s,new Uint8Array,o,i):s,h=await a(e,c);this.sessionKey=await h.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const a=await $.mode.cfb.decrypt(e,s,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=f.write(f.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==$.getCipherParams(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s}async encrypt(t,e=W){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=Z5(e),this.s2k.generateSalt();const{blockSize:i,keySize:s}=$.getCipherParams(r),a=await this.s2k.produceKey(t,s);if(this.sessionKey===null&&(this.sessionKey=$.generateSessionKey(this.sessionKeyAlgorithm)),this.version>=5){const o=$.getAEADMode(this.aeadAlgorithm);this.iv=$.random.getRandomBytes(o.ivLength);const c=new Uint8Array([192|pn.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),h=this.version===6?await Qr(f.hash.sha256,a,new Uint8Array,c,s):a,l=await o(r,h);this.encrypted=await l.encrypt(this.sessionKey,this.iv,c)}else{const o=d.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await $.mode.cfb.encrypt(r,a,o,new Uint8Array(i),e)}}}class on{static get tag(){return f.packet.publicKey}constructor(t=new Date,e=W){this.version=e.v6Keys?6:4,this.created=d.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const e=new on,{version:r,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=t;return e.version=r,e.created=i,e.algorithm=s,e.publicParams=a,e.keyID=o,e.fingerprint=c,e}async read(t,e=W){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new yt("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=d.readDate(t.subarray(r,r+4)),r+=4,this.algorithm=t[r++],this.version>=5&&(r+=4);const{read:i,publicParams:s}=$.parsePublicKeyParams(this.algorithm,t.subarray(r));if(this.version===6&&s.oid&&(s.oid.getName()===f.curve.curve25519Legacy||s.oid.getName()===f.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,r+=i,await this.computeFingerprintAndKeyID(),r}throw new yt(`Version ${this.version} of the key packet is unsupported.`)}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(d.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const e=$.serializeParams(this.algorithm,this.publicParams);return this.version>=5&&t.push(d.writeNumber(e.length,4)),t.push(e),d.concatUint8Array(t)}writeForHash(t){const e=this.writePublicKey(),r=149+t,i=t>=5?4:2;return d.concatUint8Array([new Uint8Array([r]),d.writeNumber(e.length,i),e])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Te,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const t=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await $.hash.sha256(t);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await $.hash.sha1(t)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return d.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&d.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=f.read(f.publicKey,this.algorithm);const e=this.publicParams.n||this.publicParams.p;return e?t.bits=d.uint8ArrayBitLength(e):this.publicParams.oid&&(t.curve=this.publicParams.oid.getName()),t}}on.prototype.readPublicKey=on.prototype.read,on.prototype.writePublicKey=on.prototype.write;const pl=d.constructAllowedPackets([Xn,ti,ye,$t]);class dl{static get tag(){return f.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}async decrypt(t,e,r=W){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:i}=$.getCipherParams(t),s=await Ut(Nr(this.encrypted)),a=await $.mode.cfb.decrypt(t,e,s.subarray(i+2),s.subarray(2,i+2));this.packets=await xt.fromBinary(a,pl,r)}async encrypt(t,e,r=W){const i=this.packets.write(),{blockSize:s}=$.getCipherParams(t),a=await $.getPrefixRandom(t),o=await $.mode.cfb.encrypt(t,e,a,new Uint8Array(s),r),c=await $.mode.cfb.encrypt(t,e,i,o.subarray(2),r);this.encrypted=d.concat([o,c])}}class ic{constructor(t){this.packets=t||new xt}write(){return this.packets.write()}armor(t=W){const e=this.packets.some(r=>r.constructor.tag===$t.tag&&r.version!==6);return f3(f.armor.signature,this.write(),void 0,void 0,void 0,e,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}async function Al(n,t,e,r,i,s,a=[],o=!1,c){if(e.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!e.isDecrypted())throw Error("Signing key is not decrypted.");const h=new $t;return Object.assign(h,r),h.publicKeyAlgorithm=e.algorithm,h.hashAlgorithm=await async function(l,u,g=new Date,y=[],A){const p=f.hash.sha256,w=A.preferredHashAlgorithm,k=await Promise.all(l.map(async(U,K)=>(await U.getPrimarySelfSignature(g,y[K],A)).preferredHashAlgorithms)),v=new Map;for(const U of k)for(const K of U)try{const P=f.write(f.hash,K);v.set(P,v.has(P)?v.get(P)+1:1)}catch{}const m=U=>l.length===0||v.get(U)===l.length||U===p,E=()=>{if(v.size===0)return p;const U=Array.from(v.keys()).filter(K=>m(K)).sort((K,P)=>$.hash.getHashByteLength(K)-$.hash.getHashByteLength(P))[0];return $.hash.getHashByteLength(U)>=$.hash.getHashByteLength(p)?U:p};if(new Set([f.publicKey.ecdsa,f.publicKey.eddsaLegacy,f.publicKey.ed25519,f.publicKey.ed448]).has(u.algorithm)){const U=$.getPreferredCurveHashAlgo(u.algorithm,u.publicParams.oid),K=m(w),P=$.hash.getHashByteLength(w)>=$.hash.getHashByteLength(U);if(K&&P)return w;{const B=E();return $.hash.getHashByteLength(B)>=$.hash.getHashByteLength(U)?B:U}}return m(w)?w:E()}(t,e,i,s,c),h.rawNotations=[...a],await h.sign(e,n,i,o,c),h}f.packet.publicKey,f.packet.privateKey;f.packet.publicKey,f.packet.privateKey,f.packet.publicSubkey,f.packet.privateSubkey;const wl=d.constructAllowedPackets([Xn,ti,yl,yn,dl,Zn,pn,ye,$t]),bl=d.constructAllowedPackets([pn]),ml=d.constructAllowedPackets([$t]);class we{constructor(t){this.packets=t||new xt}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag(f.packet.publicKeyEncryptedSessionKey).forEach(function(e){t.push(e.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),e=t.packets.filterByTag(f.packet.onePassSignature);return e.length>0?e.map(r=>r.issuerKeyID):t.packets.filterByTag(f.packet.signature).map(r=>r.issuerKeyID)}async decrypt(t,e,r,i=new Date,s=W){const a=this.packets.filterByTag(f.packet.symmetricallyEncryptedData,f.packet.symEncryptedIntegrityProtectedData,f.packet.aeadEncryptedData);if(a.length===0)throw Error("No encrypted data found");const o=a[0],c=o.cipherAlgorithm,h=r||await this.decryptSessionKeys(t,e,c,i,s);let l=null;const u=Promise.all(h.map(async({algorithm:y,data:A})=>{if(!d.isUint8Array(A)||!o.cipherAlgorithm&&!d.isString(y))throw Error("Invalid session key for decryption.");try{const p=o.cipherAlgorithm||f.write(f.symmetric,y);await o.decrypt(p,A,s)}catch(p){d.printDebugError(p),l=p}}));if(Xs(o.encrypted),o.encrypted=null,await u,!o.packets||!o.packets.length)throw l||Error("Decryption failed.");const g=new we(o.packets);return o.packets=new xt,g}async decryptSessionKeys(t,e,r,i=new Date,s=W){let a,o=[];if(e){const c=this.packets.filterByTag(f.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(e.map(async function(h,l){let u;u=l?await xt.fromBinary(c.write(),bl,s):c,await Promise.all(u.map(async function(g){try{await g.decrypt(h),o.push(g)}catch(y){d.printDebugError(y),y instanceof is&&(a=y)}}))}))}else{if(!t)throw Error("No key or password specified.");{const c=this.packets.filterByTag(f.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(c.map(async function(h){await Promise.all(t.map(async function(l){let u;try{u=(await l.getDecryptionKeys(h.publicKeyID,null,void 0,s)).map(y=>y.keyPacket)}catch(y){return void(a=y)}let g=[f.symmetric.aes256,f.symmetric.aes128,f.symmetric.tripledes,f.symmetric.cast5];try{const y=await l.getPrimarySelfSignature(i,void 0,s);y.preferredSymmetricAlgorithms&&(g=g.concat(y.preferredSymmetricAlgorithms))}catch{}await Promise.all(u.map(async function(y){if(!y.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(h.publicKeyAlgorithm===f.publicKey.rsaEncrypt||h.publicKeyAlgorithm===f.publicKey.rsaEncryptSign||h.publicKeyAlgorithm===f.publicKey.rsaSign||h.publicKeyAlgorithm===f.publicKey.elgamal)){const A=h.write();await Promise.all((r?[r]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async p=>{const w=new Zn;w.read(A);const k={sessionKeyAlgorithm:p,sessionKey:$.generateSessionKey(p)};try{await w.decrypt(y,k),o.push(w)}catch(v){d.printDebugError(v),a=v}}))}else try{await h.decrypt(y);const A=r||h.sessionKeyAlgorithm;if(A&&!g.includes(f.write(f.symmetric,A)))throw Error("A non-preferred symmetric algorithm was used.");o.push(h)}catch(A){d.printDebugError(A),a=A}}))})),Xs(h.encrypted),h.encrypted=null}))}}if(o.length>0){if(o.length>1){const c=new Set;o=o.filter(h=>{const l=h.sessionKeyAlgorithm+d.uint8ArrayToString(h.sessionKey);return!c.has(l)&&(c.add(l),!0)})}return o.map(c=>({data:c.sessionKey,algorithm:c.sessionKeyAlgorithm&&f.read(f.symmetric,c.sessionKeyAlgorithm)}))}throw a||Error("Session key decryption failed.")}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket(f.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket(f.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket(f.packet.literalData);return t?t.getText():null}static async generateSessionKey(t=[],e=new Date,r=[],i=W){const{symmetricAlgo:s,aeadAlgo:a}=await async function(h=[],l=new Date,u=[],g=W){const y=await Promise.all(h.map((w,k)=>w.getPrimarySelfSignature(l,u[k],g)));if(h.length?y.every(w=>w.features&&w.features[0]&f.features.seipdv2):g.aeadProtect){const w={symmetricAlgo:f.symmetric.aes128,aeadAlgo:f.aead.ocb},k=[{symmetricAlgo:g.preferredSymmetricAlgorithm,aeadAlgo:g.preferredAEADAlgorithm},{symmetricAlgo:g.preferredSymmetricAlgorithm,aeadAlgo:f.aead.ocb},{symmetricAlgo:f.symmetric.aes128,aeadAlgo:g.preferredAEADAlgorithm}];for(const v of k)if(y.every(m=>m.preferredCipherSuites&&m.preferredCipherSuites.some(E=>E[0]===v.symmetricAlgo&&E[1]===v.aeadAlgo)))return v;return w}const A=f.symmetric.aes128,p=g.preferredSymmetricAlgorithm;return{symmetricAlgo:y.every(w=>w.preferredSymmetricAlgorithms&&w.preferredSymmetricAlgorithms.includes(p))?p:A,aeadAlgo:void 0}}(t,e,r,i),o=f.read(f.symmetric,s),c=a?f.read(f.aead,a):void 0;return await Promise.all(t.map(h=>h.getEncryptionKey().catch(()=>null).then(l=>{if(l&&(l.keyPacket.algorithm===f.publicKey.x25519||l.keyPacket.algorithm===f.publicKey.x448)&&!c&&!d.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:$.generateSessionKey(s),algorithm:o,aeadAlgorithm:c}}async encrypt(t,e,r,i=!1,s=[],a=new Date,o=[],c=W){if(r){if(!d.isUint8Array(r.data)||!d.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)r=await we.generateSessionKey(t,a,o,c);else{if(!e||!e.length)throw Error("No keys, passwords, or session key provided.");r=await we.generateSessionKey(void 0,void 0,void 0,c)}const{data:h,algorithm:l,aeadAlgorithm:u}=r,g=await we.encryptSessionKey(h,l,u,t,e,i,s,a,o,c),y=yn.fromObject({version:u?2:1,aeadAlgorithm:u?f.write(f.aead,u):null});y.packets=this.packets;const A=f.write(f.symmetric,l);return await y.encrypt(A,h,c),g.packets.push(y),y.packets=new xt,g}static async encryptSessionKey(t,e,r,i,s,a=!1,o=[],c=new Date,h=[],l=W){const u=new xt,g=f.write(f.symmetric,e),y=r&&f.write(f.aead,r);if(i){const A=await Promise.all(i.map(async function(p,w){const k=await p.getEncryptionKey(o[w],c,h,l),v=Zn.fromObject({version:y?6:3,encryptionKeyPacket:k.keyPacket,anonymousRecipient:a,sessionKey:t,sessionKeyAlgorithm:g});return await v.encrypt(k.keyPacket),delete v.sessionKey,v}));u.push(...A)}if(s){const A=async function(v,m){try{return await v.decrypt(m),1}catch{return 0}},p=(v,m)=>v+m,w=async function(v,m,E,U){const K=new pn(l);return K.sessionKey=v,K.sessionKeyAlgorithm=m,E&&(K.aeadAlgorithm=E),await K.encrypt(U,l),l.passwordCollisionCheck&&(await Promise.all(s.map(P=>A(K,P)))).reduce(p)!==1?w(v,m,U):(delete K.sessionKey,K)},k=await Promise.all(s.map(v=>w(t,g,y,v)));u.push(...k)}return new we(u)}async sign(t=[],e=[],r=null,i=[],s=new Date,a=[],o=[],c=[],h=W){const l=new xt,u=this.packets.findPacket(f.packet.literalData);if(!u)throw Error("No literal data packet to sign.");const g=await f1(u,t,e,r,i,s,a,o,c,!1,h),y=g.map((A,p)=>ye.fromSignaturePacket(A,p===0)).reverse();return l.push(...y),l.push(u),l.push(...g),new we(l)}compress(t,e=W){if(t===f.compression.uncompressed)return this;const r=new ti(e);r.algorithm=t,r.packets=this.packets;const i=new xt;return i.push(r),new we(i)}async signDetached(t=[],e=[],r=null,i=[],s=[],a=new Date,o=[],c=[],h=W){const l=this.packets.findPacket(f.packet.literalData);if(!l)throw Error("No literal data packet to sign.");return new ic(await f1(l,t,e,r,i,s,a,o,c,!0,h))}async verify(t,e=new Date,r=W){const i=this.unwrapCompressed(),s=i.packets.filterByTag(f.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");Ct(i.packets.stream)&&i.packets.push(...await Ut(i.packets.stream,c=>c||[]));const a=i.packets.filterByTag(f.packet.onePassSignature).reverse(),o=i.packets.filterByTag(f.packet.signature);return a.length&&!o.length&&d.isStream(i.packets.stream)&&!Ct(i.packets.stream)?(await Promise.all(a.map(async c=>{c.correspondingSig=new Promise((h,l)=>{c.correspondingSigResolve=h,c.correspondingSigReject=l}),c.signatureData=kr(async()=>(await c.correspondingSig).signatureData),c.hashed=Ut(await c.hash(c.signatureType,s[0],void 0,!1)),c.hashed.catch(()=>{})})),i.packets.stream=Er(i.packets.stream,async(c,h)=>{const l=tr(c),u=le(h);try{for(let g=0;g<a.length;g++){const{value:y}=await l.read();a[g].correspondingSigResolve(y)}await l.readToEnd(),await u.ready,await u.close()}catch(g){a.forEach(y=>{y.correspondingSigReject(g)}),await u.abort(g)}}),Rs(a,s,t,e,!1,r)):Rs(o,s,t,e,!1,r)}verifyDetached(t,e,r=new Date,i=W){const s=this.unwrapCompressed().packets.filterByTag(f.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return Rs(t.packets.filterByTag(f.packet.signature),s,e,r,!0,i)}unwrapCompressed(){const t=this.packets.filterByTag(f.packet.compressedData);return t.length?new we(t[0].packets):this}async appendSignature(t,e=W){await this.packets.read(d.isUint8Array(t)?t:(await u3(t)).data,ml,e)}write(){return this.packets.write()}armor(t=W){const e=this.packets[this.packets.length-1],r=e.constructor.tag===yn.tag?e.version!==2:this.packets.some(i=>i.constructor.tag===$t.tag&&i.version!==6);return f3(f.armor.message,this.write(),null,null,null,r,t)}}async function f1(n,t,e=[],r=null,i=[],s=new Date,a=[],o=[],c=[],h=!1,l=W){const u=new xt,g=n.text===null?f.signature.binary:f.signature.text;if(await Promise.all(t.map(async(y,A)=>{const p=a[A];if(!y.isPrivate())throw Error("Need private key for signing");const w=await y.getSigningKey(i[A],s,p,l);return Al(n,e.length?e:[y],w.keyPacket,{signatureType:g},s,o,c,h,l)})).then(y=>{u.push(...y)}),r){const y=r.packets.filterByTag(f.packet.signature);u.push(...y)}return u}async function Rs(n,t,e,r=new Date,i=!1,s=W){return Promise.all(n.filter(function(a){return["text","binary"].includes(f.read(f.signature,a.signatureType))}).map(async function(a){return async function(o,c,h,l=new Date,u=!1,g=W){let y,A;for(const k of h){const v=k.getKeys(o.issuerKeyID);if(v.length>0){y=k,A=v[0];break}}const p=o instanceof ye?o.correspondingSig:o,w={keyID:o.issuerKeyID,verified:(async()=>{if(!A)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(A.keyPacket,o.signatureType,c[0],l,u,g);const k=await p;if(A.getCreationTime()>k.created)throw Error("Key is newer than the signature");try{await y.getSigningKey(A.getKeyID(),k.created,void 0,g)}catch(v){if(!g.allowInsecureVerificationWithReformattedKeys||!v.message.match(/Signature creation time is in the future/))throw v;await y.getSigningKey(A.getKeyID(),l,void 0,g)}return!0})(),signature:(async()=>{const k=await p,v=new xt;return k&&v.push(k),new ic(v)})()};return w.signature.catch(()=>{}),w.verified.catch(()=>{}),w}(a,t,e,r,i,s)}))}async function El({armoredMessage:n,binaryMessage:t,config:e,...r}){e={...W,...e};let i=n||t;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(n&&!d.isString(n)&&!d.isStream(n))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!d.isUint8Array(t)&&!d.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(r);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=d.isStream(i);if(n){const{type:h,data:l}=await u3(i);if(h!==f.armor.message)throw Error("Armored text not of type message");i=l}const o=await xt.fromBinary(i,wl,e),c=new we(o);return c.fromStream=a,c}async function kl({message:n,decryptionKeys:t,passwords:e,sessionKeys:r,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:h,...l}){if(vl(h={...W,...h}),Bl(n),i=yi(i),t=yi(t),e=yi(e),r=yi(r),l.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(l.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const u=Object.keys(l);if(u.length>0)throw Error("Unknown option: "+u.join(", "));try{const g=await n.decrypt(t,e,r,c,h);i||(i=[]);const y={};if(y.signatures=o?await g.verifyDetached(o,i,c,h):await g.verify(i,c,h),y.data=a==="binary"?g.getLiteralData():g.getText(),y.filename=g.getFilename(),Cl(y,n),s){if(i.length===0)throw Error("Verification keys are required to verify message signatures");if(y.signatures.length===0)throw Error("Message is not signed");y.data=Wt([y.data,kr(async()=>(await d.anyPromise(y.signatures.map(A=>A.verified)),a==="binary"?new Uint8Array:""))])}return y.data=await Sl(y.data),y}catch(g){throw d.wrapError("Error decrypting message",g)}}function Bl(n){if(!(n instanceof we))throw Error("Parameter [message] needs to be of type Message")}const Il=Object.keys(W).length;function vl(n){const t=Object.keys(n);if(t.length!==Il){for(const e of t)if(W[e]===void 0)throw Error("Unknown config property: "+e)}}function yi(n){return n&&!d.isArray(n)&&(n=[n]),n}async function Sl(n){return d.isStream(n)==="array"?Ut(n):n}function Cl(n,t){n.data=Er(t.packets.stream,async(e,r)=>{await Mr(n.data,r,{preventClose:!0});const i=le(r);try{await Ut(e,s=>s),await i.close()}catch(s){await i.abort(s)}})}function Vi(n){if(!Number.isSafeInteger(n)||n<0)throw Error("positive integer expected, not "+n)}function ei(n,...t){if(!((e=n)instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"))throw Error("Uint8Array expected");var e;if(t.length>0&&!t.includes(n.length))throw Error(`Uint8Array expected of length ${t}, not of length=${n.length}`)}function dn(n,t=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(t&&n.finished)throw Error("Hash#digest() has already been called")}function sc(n,t){ei(n);const e=t.outputLen;if(n.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}const Jr=typeof Ot=="object"&&"crypto"in Ot?Ot.crypto:void 0,_s=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ke=(n,t)=>n<<32-t|n>>>t,Rr=(n,t)=>n<<t|n>>>32-t>>>0,g1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function y1(n){for(let e=0;e<n.length;e++)n[e]=(t=n[e])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function ac(n){if(typeof n!="string")throw Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))}function ri(n){return typeof n=="string"&&(n=ac(n)),ei(n),n}function oc(...n){let t=0;for(let r=0;r<n.length;r++){const i=n[r];ei(i),t+=i.length}const e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const s=n[r];e.set(s,i),i+=s.length}return e}class Na{clone(){return this._cloneInto()}}function er(n){const t=r=>n().update(ri(r)).digest(),e=n();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>n(),t}function za(n=32){if(Jr&&typeof Jr.getRandomValues=="function")return Jr.getRandomValues(new Uint8Array(n));if(Jr&&typeof Jr.randomBytes=="function")return Jr.randomBytes(n);throw Error("crypto.getRandomValues must be defined")}const cc=(n,t,e)=>n&t^~n&e,lc=(n,t,e)=>n&t^n&e^t&e;class cs extends Na{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=_s(this.buffer)}update(t){dn(this);const{view:e,buffer:r,blockLen:i}=this,s=(t=ri(t)).length;for(let a=0;a<s;){const o=Math.min(i-this.pos,s-a);if(o!==i)r.set(t.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(e,0),this.pos=0);else{const c=_s(t);for(;i<=s-a;a+=i)this.process(c,a)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){dn(this),sc(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(r,0),a=0);for(let u=a;u<i;u++)e[u]=0;(function(u,g,y,A){if(typeof u.setBigUint64=="function")return u.setBigUint64(g,y,A);const p=BigInt(32),w=BigInt(4294967295),k=Number(y>>p&w),v=Number(y&w),m=A?4:0,E=A?0:4;u.setUint32(g+m,k,A),u.setUint32(g+E,v,A)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);const o=_s(t),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,l=this.get();if(h>l.length)throw Error("_sha2: outputLen bigger than state");for(let u=0;u<h;u++)o.setUint32(4*u,l[u],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:s,destroyed:a,pos:o}=this;return t.length=i,t.pos=o,t.finished=s,t.destroyed=a,i%e&&t.buffer.set(r),t}}const xl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ir=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sr=new Uint32Array(64);class hc extends cs{constructor(){super(64,32,8,!1),this.A=0|ir[0],this.B=0|ir[1],this.C=0|ir[2],this.D=0|ir[3],this.E=0|ir[4],this.F=0|ir[5],this.G=0|ir[6],this.H=0|ir[7]}get(){const{A:t,B:e,C:r,D:i,E:s,F:a,G:o,H:c}=this;return[t,e,r,i,s,a,o,c]}set(t,e,r,i,s,a,o,c){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(t,e){for(let u=0;u<16;u++,e+=4)sr[u]=t.getUint32(e,!1);for(let u=16;u<64;u++){const g=sr[u-15],y=sr[u-2],A=ke(g,7)^ke(g,18)^g>>>3,p=ke(y,17)^ke(y,19)^y>>>10;sr[u]=p+sr[u-7]+A+sr[u-16]|0}let{A:r,B:i,C:s,D:a,E:o,F:c,G:h,H:l}=this;for(let u=0;u<64;u++){const g=l+(ke(o,6)^ke(o,11)^ke(o,25))+cc(o,c,h)+xl[u]+sr[u]|0,y=(ke(r,2)^ke(r,13)^ke(r,22))+lc(r,i,s)|0;l=h,h=c,c=o,o=a+g|0,a=s,s=i,i=r,r=g+y|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,h=h+this.G|0,l=l+this.H|0,this.set(r,i,s,a,o,c,h,l)}roundClean(){sr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Ul extends hc{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const ls=er(()=>new hc),Kl=er(()=>new Ul);class uc extends Na{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(a){if(typeof a!="function"||typeof a.create!="function")throw Error("Hash should be wrapped by utils.wrapConstructor");Vi(a.outputLen),Vi(a.blockLen)}(t);const r=ri(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return dn(this),this.iHash.update(t),this}digestInto(t){dn(this),ei(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return t.finished=i,t.destroyed=s,t.blockLen=a,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const fc=(n,t,e)=>new uc(n,t).update(e).digest();fc.create=(n,t)=>new uc(n,t);const Ha=BigInt(0),Zi=BigInt(1),Pl=BigInt(2);function zr(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function ni(n){if(!zr(n))throw Error("Uint8Array expected")}function Ze(n,t){if(typeof t!="boolean")throw Error(`${n} must be valid boolean, got "${t}".`)}const Dl=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function Hr(n){ni(n);let t="";for(let e=0;e<n.length;e++)t+=Dl[n[e]];return t}function cn(n){const t=n.toString(16);return 1&t.length?"0"+t:t}function Oa(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":"0x"+n)}const He={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function p1(n){return n>=He._0&&n<=He._9?n-He._0:n>=He._A&&n<=He._F?n-(He._A-10):n>=He._a&&n<=He._f?n-(He._a-10):void 0}function An(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);const t=n.length,e=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(e);for(let i=0,s=0;i<e;i++,s+=2){const a=p1(n.charCodeAt(s)),o=p1(n.charCodeAt(s+1));if(a===void 0||o===void 0){const c=n[s]+n[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=16*a+o}return r}function _r(n){return Oa(Hr(n))}function br(n){return ni(n),Oa(Hr(Uint8Array.from(n).reverse()))}function fn(n,t){return An(n.toString(16).padStart(2*t,"0"))}function wn(n,t){return fn(n,t).reverse()}function vt(n,t,e){let r;if(typeof t=="string")try{r=An(t)}catch(s){throw Error(`${n} must be valid hex string, got "${t}". Cause: ${s}`)}else{if(!zr(t))throw Error(n+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const i=r.length;if(typeof e=="number"&&i!==e)throw Error(`${n} expected ${e} bytes, got ${i}`);return r}function Or(...n){let t=0;for(let r=0;r<n.length;r++){const i=n[r];ni(i),t+=i.length}const e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const s=n[r];e.set(s,i),i+=s.length}return e}const Ts=n=>typeof n=="bigint"&&Ha<=n;function hs(n,t,e){return Ts(n)&&Ts(t)&&Ts(e)&&t<=n&&n<e}function Xt(n,t,e,r){if(!hs(t,e,r))throw Error(`expected valid ${n}: ${e} <= n < ${r}, got ${typeof t} ${t}`)}function gc(n){let t;for(t=0;n>Ha;n>>=Zi,t+=1);return t}const Fa=n=>(Pl<<BigInt(n-1))-Zi,Ls=n=>new Uint8Array(n),d1=n=>Uint8Array.from(n);function yc(n,t,e){if(typeof n!="number"||n<2)throw Error("hashLen must be a number");if(typeof t!="number"||t<2)throw Error("qByteLen must be a number");if(typeof e!="function")throw Error("hmacFn must be a function");let r=Ls(n),i=Ls(n),s=0;const a=()=>{r.fill(1),i.fill(0),s=0},o=(...l)=>e(i,r,...l),c=(l=Ls())=>{i=o(d1([0]),l),r=o(),l.length!==0&&(i=o(d1([1]),l),r=o())},h=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let l=0;const u=[];for(;l<t;){r=o();const g=r.slice();u.push(g),l+=r.length}return Or(...u)};return(l,u)=>{let g;for(a(),c(l);!(g=u(h()));)c();return a(),g}}const Ql={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||zr(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Fr(n,t,e={}){const r=(i,s,a)=>{const o=Ql[s];if(typeof o!="function")throw Error(`Invalid validator "${s}", expected function`);const c=n[i];if(!(a&&c===void 0||o(c,n)))throw Error(`Invalid param ${i+""}=${c} (${typeof c}), expected ${s}`)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(e))r(i,s,!0);return n}function Yn(n){const t=new WeakMap;return(e,...r)=>{const i=t.get(e);if(i!==void 0)return i;const s=n(e,...r);return t.set(e,s),s}}var Rl=Object.freeze({__proto__:null,aInRange:Xt,abool:Ze,abytes:ni,bitGet:function(n,t){return n>>BigInt(t)&Zi},bitLen:gc,bitMask:Fa,bitSet:function(n,t,e){return n|(e?Zi:Ha)<<BigInt(t)},bytesToHex:Hr,bytesToNumberBE:_r,bytesToNumberLE:br,concatBytes:Or,createHmacDrbg:yc,ensureBytes:vt,equalBytes:function(n,t){if(n.length!==t.length)return!1;let e=0;for(let r=0;r<n.length;r++)e|=n[r]^t[r];return e===0},hexToBytes:An,hexToNumber:Oa,inRange:hs,isBytes:zr,memoized:Yn,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:fn,numberToBytesLE:wn,numberToHexUnpadded:cn,numberToVarBytesBE:function(n){return An(cn(n))},utf8ToBytes:function(n){if(typeof n!="string")throw Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))},validateObject:Fr});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Pt=BigInt(0),St=BigInt(1),Kr=BigInt(2),_l=BigInt(3),Ms=BigInt(4),A1=BigInt(5),w1=BigInt(8);function bt(n,t){const e=n%t;return e>=Pt?e:t+e}function pc(n,t,e){if(e<=Pt||t<Pt)throw Error("Expected power/modulo > 0");if(e===St)return Pt;let r=St;for(;t>Pt;)t&St&&(r=r*n%e),n=n*n%e,t>>=St;return r}function wt(n,t,e){let r=n;for(;t-- >Pt;)r*=r,r%=e;return r}function ma(n,t){if(n===Pt||t<=Pt)throw Error(`invert: expected positive integers, got n=${n} mod=${t}`);let e=bt(n,t),r=t,i=Pt,s=St;for(;e!==Pt;){const a=r%e,o=i-s*(r/e);r=e,e=a,i=s,s=o}if(r!==St)throw Error("invert: does not exist");return bt(i,t)}function Tl(n){if(n%Ms===_l){const t=(n+St)/Ms;return function(e,r){const i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(n%w1===A1){const t=(n-A1)/w1;return function(e,r){const i=e.mul(r,Kr),s=e.pow(i,t),a=e.mul(r,s),o=e.mul(e.mul(a,Kr),s),c=e.mul(a,e.sub(o,e.ONE));if(!e.eql(e.sqr(c),r))throw Error("Cannot find square root");return c}}return function(t){const e=(t-St)/Kr;let r,i,s;for(r=t-St,i=0;r%Kr===Pt;r/=Kr,i++);for(s=Kr;s<t&&pc(s,e,t)!==t-St;s++);if(i===1){const o=(t+St)/Ms;return function(c,h){const l=c.pow(h,o);if(!c.eql(c.sqr(l),h))throw Error("Cannot find square root");return l}}const a=(r+St)/Kr;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw Error("Cannot find square root");let h=i,l=o.pow(o.mul(o.ONE,s),r),u=o.pow(c,a),g=o.pow(c,r);for(;!o.eql(g,o.ONE);){if(o.eql(g,o.ZERO))return o.ZERO;let y=1;for(let p=o.sqr(g);y<h&&!o.eql(p,o.ONE);y++)p=o.sqr(p);const A=o.pow(l,St<<BigInt(h-y-1));l=o.sqr(A),u=o.mul(u,A),g=o.mul(g,l),h=y}return u}}(n)}BigInt(9),BigInt(16);const Ll=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dc(n,t){const e=t!==void 0?t:n.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}function Le(n,t,e=!1,r={}){if(n<=Pt)throw Error("Expected Field ORDER > 0, got "+n);const{nBitLength:i,nByteLength:s}=dc(n,t);if(s>2048)throw Error("Field lengths over 2048 bytes are not supported");const a=Tl(n),o=Object.freeze({ORDER:n,BITS:i,BYTES:s,MASK:Fa(i),ZERO:Pt,ONE:St,create:c=>bt(c,n),isValid:c=>{if(typeof c!="bigint")throw Error("Invalid field element: expected bigint, got "+typeof c);return Pt<=c&&c<n},is0:c=>c===Pt,isOdd:c=>(c&St)===St,neg:c=>bt(-c,n),eql:(c,h)=>c===h,sqr:c=>bt(c*c,n),add:(c,h)=>bt(c+h,n),sub:(c,h)=>bt(c-h,n),mul:(c,h)=>bt(c*h,n),pow:(c,h)=>function(l,u,g){if(g<Pt)throw Error("Expected power > 0");if(g===Pt)return l.ONE;if(g===St)return u;let y=l.ONE,A=u;for(;g>Pt;)g&St&&(y=l.mul(y,A)),A=l.sqr(A),g>>=St;return y}(o,c,h),div:(c,h)=>bt(c*ma(h,n),n),sqrN:c=>c*c,addN:(c,h)=>c+h,subN:(c,h)=>c-h,mulN:(c,h)=>c*h,inv:c=>ma(c,n),sqrt:r.sqrt||(c=>a(o,c)),invertBatch:c=>function(h,l){const u=Array(l.length),g=l.reduce((A,p,w)=>h.is0(p)?A:(u[w]=A,h.mul(A,p)),h.ONE),y=h.inv(g);return l.reduceRight((A,p,w)=>h.is0(p)?A:(u[w]=h.mul(A,u[w]),h.mul(A,p)),y),u}(o,c),cmov:(c,h,l)=>l?h:c,toBytes:c=>e?wn(c,s):fn(c,s),fromBytes:c=>{if(c.length!==s)throw Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return e?br(c):_r(c)}});return Object.freeze(o)}function Ac(n){if(typeof n!="bigint")throw Error("field order must be bigint");const t=n.toString(2).length;return Math.ceil(t/8)}function b1(n){const t=Ac(n);return t+Math.ceil(t/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ml=BigInt(0),Ns=BigInt(1),zs=new WeakMap,m1=new WeakMap;function wc(n,t){const e=(s,a)=>{const o=a.negate();return s?o:a},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>t)throw Error(`Wrong window size=${s}, should be [1..${t}]`)},i=s=>(r(s),{windows:Math.ceil(t/s)+1,windowSize:2**(s-1)});return{constTimeNegate:e,unsafeLadder(s,a){let o=n.ZERO,c=s;for(;a>Ml;)a&Ns&&(o=o.add(c)),c=c.double(),a>>=Ns;return o},precomputeWindow(s,a){const{windows:o,windowSize:c}=i(a),h=[];let l=s,u=l;for(let g=0;g<o;g++){u=l,h.push(u);for(let y=1;y<c;y++)u=u.add(l),h.push(u);l=u.double()}return h},wNAF(s,a,o){const{windows:c,windowSize:h}=i(s);let l=n.ZERO,u=n.BASE;const g=BigInt(2**s-1),y=2**s,A=BigInt(s);for(let p=0;p<c;p++){const w=p*h;let k=Number(o&g);o>>=A,k>h&&(k-=y,o+=Ns);const v=w,m=w+Math.abs(k)-1,E=p%2!=0,U=k<0;k===0?u=u.add(e(E,a[v])):l=l.add(e(U,a[m]))}return{p:l,f:u}},wNAFCached(s,a,o){const c=m1.get(s)||1;let h=zs.get(s);return h||(h=this.precomputeWindow(s,c),c!==1&&zs.set(s,o(h))),this.wNAF(c,h,a)},setWindowSize(s,a){r(a),m1.set(s,a),zs.delete(s)}}}function bc(n,t,e,r){if(!Array.isArray(e)||!Array.isArray(r)||r.length!==e.length)throw Error("arrays of points and scalars must have equal length");r.forEach((l,u)=>{if(!t.isValid(l))throw Error("wrong scalar at index "+u)}),e.forEach((l,u)=>{if(!(l instanceof n))throw Error("wrong point at index "+u)});const i=gc(BigInt(e.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,o=Array(a+1).fill(n.ZERO),c=Math.floor((t.BITS-1)/s)*s;let h=n.ZERO;for(let l=c;l>=0;l-=s){o.fill(n.ZERO);for(let g=0;g<r.length;g++){const y=r[g],A=Number(y>>BigInt(l)&BigInt(a));o[A]=o[A].add(e[g])}let u=n.ZERO;for(let g=o.length-1,y=n.ZERO;g>0;g--)y=y.add(o[g]),u=u.add(y);if(h=h.add(u),l!==0)for(let g=0;g<s;g++)h=h.double()}return h}function Ga(n){return Fr(n.Fp,Ll.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Fr(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dc(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function E1(n){n.lowS!==void 0&&Ze("lowS",n.lowS),n.prehash!==void 0&&Ze("prehash",n.prehash)}const{bytesToNumberBE:Nl,hexToBytes:zl}=Rl,je={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(n,t)=>{const{Err:e}=je;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(1&t.length)throw new e("tlv.encode: unpadded data");const r=t.length/2,i=cn(r);if(i.length/2&128)throw new e("tlv.encode: long form length too big");const s=r>127?cn(i.length/2|128):"";return`${cn(n)}${s}${i}${t}`},decode(n,t){const{Err:e}=je;let r=0;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==n)throw new e("tlv.decode: wrong tlv");const i=t[r++];let s=0;if(128&i){const o=127&i;if(!o)throw new e("tlv.decode(long): indefinite length not supported");if(o>4)throw new e("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+o);if(c.length!==o)throw new e("tlv.decode: length bytes not complete");if(c[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const h of c)s=s<<8|h;if(r+=o,s<128)throw new e("tlv.decode(long): not minimal encoding")}else s=i;const a=t.subarray(r,r+s);if(a.length!==s)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+s)}}},_int:{encode(n){const{Err:t}=je;if(n<Ve)throw new t("integer: negative integers are not allowed");let e=cn(n);if(8&Number.parseInt(e[0],16)&&(e="00"+e),1&e.length)throw new t("unexpected assertion");return e},decode(n){const{Err:t}=je;if(128&n[0])throw new t("Invalid signature integer: negative");if(n[0]===0&&!(128&n[1]))throw new t("Invalid signature integer: unnecessary leading zero");return Nl(n)}},toSig(n){const{Err:t,_int:e,_tlv:r}=je,i=typeof n=="string"?zl(n):n;ni(i);const{v:s,l:a}=r.decode(48,i);if(a.length)throw new t("Invalid signature: left bytes after parsing");const{v:o,l:c}=r.decode(2,s),{v:h,l}=r.decode(2,c);if(l.length)throw new t("Invalid signature: left bytes after parsing");return{r:e.decode(o),s:e.decode(h)}},hexFromSig(n){const{_tlv:t,_int:e}=je,r=`${t.encode(2,e.encode(n.r))}${t.encode(2,e.encode(n.s))}`;return t.encode(48,r)}},Ve=BigInt(0),Kt=BigInt(1);BigInt(2);const k1=BigInt(3);function Hl(n){const t=function(A){const p=Ga(A);Fr(p,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:w,Fp:k,a:v}=p;if(w){if(!k.eql(v,k.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof w!="object"||typeof w.beta!="bigint"||typeof w.splitScalar!="function")throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...p})}(n),{Fp:e}=t,r=Le(t.n,t.nBitLength),i=t.toBytes||((A,p,w)=>{const k=p.toAffine();return Or(Uint8Array.from([4]),e.toBytes(k.x),e.toBytes(k.y))}),s=t.fromBytes||(A=>{const p=A.subarray(1);return{x:e.fromBytes(p.subarray(0,e.BYTES)),y:e.fromBytes(p.subarray(e.BYTES,2*e.BYTES))}});function a(A){const{a:p,b:w}=t,k=e.sqr(A),v=e.mul(k,A);return e.add(e.add(v,e.mul(A,p)),w)}if(!e.eql(e.sqr(t.Gy),a(t.Gx)))throw Error("bad generator point: equation left != right");function o(A){const{allowedPrivateKeyLengths:p,nByteLength:w,wrapPrivateKey:k,n:v}=t;if(p&&typeof A!="bigint"){if(zr(A)&&(A=Hr(A)),typeof A!="string"||!p.includes(A.length))throw Error("Invalid key");A=A.padStart(2*w,"0")}let m;try{m=typeof A=="bigint"?A:_r(vt("private key",A,w))}catch{throw Error(`private key must be ${w} bytes, hex or bigint, not ${typeof A}`)}return k&&(m=bt(m,v)),Xt("private key",m,Kt,v),m}function c(A){if(!(A instanceof u))throw Error("ProjectivePoint expected")}const h=Yn((A,p)=>{const{px:w,py:k,pz:v}=A;if(e.eql(v,e.ONE))return{x:w,y:k};const m=A.is0();p==null&&(p=m?e.ONE:e.inv(v));const E=e.mul(w,p),U=e.mul(k,p),K=e.mul(v,p);if(m)return{x:e.ZERO,y:e.ZERO};if(!e.eql(K,e.ONE))throw Error("invZ was invalid");return{x:E,y:U}}),l=Yn(A=>{if(A.is0()){if(t.allowInfinityPoint&&!e.is0(A.py))return;throw Error("bad point: ZERO")}const{x:p,y:w}=A.toAffine();if(!e.isValid(p)||!e.isValid(w))throw Error("bad point: x or y not FE");const k=e.sqr(w),v=a(p);if(!e.eql(k,v))throw Error("bad point: equation left != right");if(!A.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class u{constructor(p,w,k){if(this.px=p,this.py=w,this.pz=k,p==null||!e.isValid(p))throw Error("x required");if(w==null||!e.isValid(w))throw Error("y required");if(k==null||!e.isValid(k))throw Error("z required");Object.freeze(this)}static fromAffine(p){const{x:w,y:k}=p||{};if(!p||!e.isValid(w)||!e.isValid(k))throw Error("invalid affine point");if(p instanceof u)throw Error("projective point not allowed");const v=m=>e.eql(m,e.ZERO);return v(w)&&v(k)?u.ZERO:new u(w,k,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const w=e.invertBatch(p.map(k=>k.pz));return p.map((k,v)=>k.toAffine(w[v])).map(u.fromAffine)}static fromHex(p){const w=u.fromAffine(s(vt("pointHex",p)));return w.assertValidity(),w}static fromPrivateKey(p){return u.BASE.multiply(o(p))}static msm(p,w){return bc(u,r,p,w)}_setWindowSize(p){y.setWindowSize(this,p)}assertValidity(){l(this)}hasEvenY(){const{y:p}=this.toAffine();if(e.isOdd)return!e.isOdd(p);throw Error("Field doesn't support isOdd")}equals(p){c(p);const{px:w,py:k,pz:v}=this,{px:m,py:E,pz:U}=p,K=e.eql(e.mul(w,U),e.mul(m,v)),P=e.eql(e.mul(k,U),e.mul(E,v));return K&&P}negate(){return new u(this.px,e.neg(this.py),this.pz)}double(){const{a:p,b:w}=t,k=e.mul(w,k1),{px:v,py:m,pz:E}=this;let U=e.ZERO,K=e.ZERO,P=e.ZERO,B=e.mul(v,v),b=e.mul(m,m),x=e.mul(E,E),C=e.mul(v,m);return C=e.add(C,C),P=e.mul(v,E),P=e.add(P,P),U=e.mul(p,P),K=e.mul(k,x),K=e.add(U,K),U=e.sub(b,K),K=e.add(b,K),K=e.mul(U,K),U=e.mul(C,U),P=e.mul(k,P),x=e.mul(p,x),C=e.sub(B,x),C=e.mul(p,C),C=e.add(C,P),P=e.add(B,B),B=e.add(P,B),B=e.add(B,x),B=e.mul(B,C),K=e.add(K,B),x=e.mul(m,E),x=e.add(x,x),B=e.mul(x,C),U=e.sub(U,B),P=e.mul(x,b),P=e.add(P,P),P=e.add(P,P),new u(U,K,P)}add(p){c(p);const{px:w,py:k,pz:v}=this,{px:m,py:E,pz:U}=p;let K=e.ZERO,P=e.ZERO,B=e.ZERO;const b=t.a,x=e.mul(t.b,k1);let C=e.mul(w,m),S=e.mul(k,E),I=e.mul(v,U),D=e.add(w,k),Q=e.add(m,E);D=e.mul(D,Q),Q=e.add(C,S),D=e.sub(D,Q),Q=e.add(w,v);let R=e.add(m,U);return Q=e.mul(Q,R),R=e.add(C,I),Q=e.sub(Q,R),R=e.add(k,v),K=e.add(E,U),R=e.mul(R,K),K=e.add(S,I),R=e.sub(R,K),B=e.mul(b,Q),K=e.mul(x,I),B=e.add(K,B),K=e.sub(S,B),B=e.add(S,B),P=e.mul(K,B),S=e.add(C,C),S=e.add(S,C),I=e.mul(b,I),Q=e.mul(x,Q),S=e.add(S,I),I=e.sub(C,I),I=e.mul(b,I),Q=e.add(Q,I),C=e.mul(S,Q),P=e.add(P,C),C=e.mul(R,Q),K=e.mul(D,K),K=e.sub(K,C),C=e.mul(D,S),B=e.mul(R,B),B=e.add(B,C),new u(K,P,B)}subtract(p){return this.add(p.negate())}is0(){return this.equals(u.ZERO)}wNAF(p){return y.wNAFCached(this,p,u.normalizeZ)}multiplyUnsafe(p){Xt("scalar",p,Ve,t.n);const w=u.ZERO;if(p===Ve)return w;if(p===Kt)return this;const{endo:k}=t;if(!k)return y.unsafeLadder(this,p);let{k1neg:v,k1:m,k2neg:E,k2:U}=k.splitScalar(p),K=w,P=w,B=this;for(;m>Ve||U>Ve;)m&Kt&&(K=K.add(B)),U&Kt&&(P=P.add(B)),B=B.double(),m>>=Kt,U>>=Kt;return v&&(K=K.negate()),E&&(P=P.negate()),P=new u(e.mul(P.px,k.beta),P.py,P.pz),K.add(P)}multiply(p){const{endo:w,n:k}=t;let v,m;if(Xt("scalar",p,Kt,k),w){const{k1neg:E,k1:U,k2neg:K,k2:P}=w.splitScalar(p);let{p:B,f:b}=this.wNAF(U),{p:x,f:C}=this.wNAF(P);B=y.constTimeNegate(E,B),x=y.constTimeNegate(K,x),x=new u(e.mul(x.px,w.beta),x.py,x.pz),v=B.add(x),m=b.add(C)}else{const{p:E,f:U}=this.wNAF(p);v=E,m=U}return u.normalizeZ([v,m])[0]}multiplyAndAddUnsafe(p,w,k){const v=u.BASE,m=(U,K)=>K!==Ve&&K!==Kt&&U.equals(v)?U.multiply(K):U.multiplyUnsafe(K),E=m(this,w).add(m(p,k));return E.is0()?void 0:E}toAffine(p){return h(this,p)}isTorsionFree(){const{h:p,isTorsionFree:w}=t;if(p===Kt)return!0;if(w)return w(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:w}=t;return p===Kt?this:w?w(u,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return Ze("isCompressed",p),this.assertValidity(),i(u,this,p)}toHex(p=!0){return Ze("isCompressed",p),Hr(this.toRawBytes(p))}}u.BASE=new u(t.Gx,t.Gy,e.ONE),u.ZERO=new u(e.ZERO,e.ONE,e.ZERO);const g=t.nBitLength,y=wc(u,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(A){return hs(A,Kt,t.n)}}}function Ol(n){const t=function(b){const x=Ga(b);return Fr(x,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...x})}(n),{Fp:e,n:r}=t,i=e.BYTES+1,s=2*e.BYTES+1;function a(b){return bt(b,r)}function o(b){return ma(b,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:h,weierstrassEquation:l,isWithinCurveOrder:u}=Hl({...t,toBytes(b,x,C){const S=x.toAffine(),I=e.toBytes(S.x),D=Or;return Ze("isCompressed",C),C?D(Uint8Array.from([x.hasEvenY()?2:3]),I):D(Uint8Array.from([4]),I,e.toBytes(S.y))},fromBytes(b){const x=b.length,C=b[0],S=b.subarray(1);if(x!==i||C!==2&&C!==3){if(x===s&&C===4)return{x:e.fromBytes(S.subarray(0,e.BYTES)),y:e.fromBytes(S.subarray(e.BYTES,2*e.BYTES))};throw Error(`Point of length ${x} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const I=_r(S);if(!hs(I,Kt,e.ORDER))throw Error("Point is not on curve");const D=l(I);let Q;try{Q=e.sqrt(D)}catch(R){const T=R instanceof Error?": "+R.message:"";throw Error("Point is not on curve"+T)}return!(1&~C)!=((Q&Kt)===Kt)&&(Q=e.neg(Q)),{x:I,y:Q}}}}),g=b=>Hr(fn(b,t.nByteLength));function y(b){return b>r>>Kt}const A=(b,x,C)=>_r(b.slice(x,C));class p{constructor(x,C,S){this.r=x,this.s=C,this.recovery=S,this.assertValidity()}static fromCompact(x){const C=t.nByteLength;return x=vt("compactSignature",x,2*C),new p(A(x,0,C),A(x,C,2*C))}static fromDER(x){const{r:C,s:S}=je.toSig(vt("DER",x));return new p(C,S)}assertValidity(){Xt("r",this.r,Kt,r),Xt("s",this.s,Kt,r)}addRecoveryBit(x){return new p(this.r,this.s,x)}recoverPublicKey(x){const{r:C,s:S,recovery:I}=this,D=m(vt("msgHash",x));if(I==null||![0,1,2,3].includes(I))throw Error("recovery id invalid");const Q=I===2||I===3?C+t.n:C;if(Q>=e.ORDER)throw Error("recovery id 2 or 3 invalid");const R=1&I?"03":"02",T=c.fromHex(R+g(Q)),G=o(Q),H=a(-D*G),L=a(S*G),M=c.BASE.multiplyAndAddUnsafe(T,H,L);if(!M)throw Error("point at infinify");return M.assertValidity(),M}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return An(this.toDERHex())}toDERHex(){return je.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return An(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const w={isValidPrivateKey(b){try{return h(b),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const b=b1(t.n);return function(x,C,S=!1){const I=x.length,D=Ac(C),Q=b1(C);if(I<16||I<Q||I>1024)throw Error(`expected ${Q}-1024 bytes of input, got ${I}`);const R=bt(S?_r(x):br(x),C-St)+St;return S?wn(R,D):fn(R,D)}(t.randomBytes(b),t.n)},precompute:(b=8,x=c.BASE)=>(x._setWindowSize(b),x.multiply(BigInt(3)),x)};function k(b){const x=zr(b),C=typeof b=="string",S=(x||C)&&b.length;return x?S===i||S===s:C?S===2*i||S===2*s:b instanceof c}const v=t.bits2int||function(b){const x=_r(b),C=8*b.length-t.nBitLength;return C>0?x>>BigInt(C):x},m=t.bits2int_modN||function(b){return a(v(b))},E=Fa(t.nBitLength);function U(b){return Xt("num < 2^"+t.nBitLength,b,Ve,E),fn(b,t.nByteLength)}function K(b,x,C=P){if(["recovered","canonical"].some(_=>_ in C))throw Error("sign() legacy options not supported");const{hash:S,randomBytes:I}=t;let{lowS:D,prehash:Q,extraEntropy:R}=C;D==null&&(D=!0),b=vt("msgHash",b),E1(C),Q&&(b=vt("prehashed msgHash",S(b)));const T=m(b),G=h(x),H=[U(G),U(T)];if(R!=null&&R!==!1){const _=R===!0?I(e.BYTES):R;H.push(vt("extraEntropy",_))}const L=Or(...H),M=T;return{seed:L,k2sig:function(_){const z=v(_);if(!u(z))return;const N=o(z),O=c.BASE.multiply(z).toAffine(),q=a(O.x);if(q===Ve)return;const X=a(N*a(M+q*G));if(X===Ve)return;let Y=(O.x===q?0:2)|Number(O.y&Kt),nt=X;return D&&y(X)&&(nt=function(tt){return y(tt)?a(-tt):tt}(X),Y^=1),new p(q,nt,Y)}}}const P={lowS:t.lowS,prehash:!1},B={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(b,x=!0){return c.fromPrivateKey(b).toRawBytes(x)},getSharedSecret:function(b,x,C=!0){if(k(b))throw Error("first arg must be private key");if(!k(x))throw Error("second arg must be public key");return c.fromHex(x).multiply(h(b)).toRawBytes(C)},sign:function(b,x,C=P){const{seed:S,k2sig:I}=K(b,x,C),D=t;return yc(D.hash.outputLen,D.nByteLength,D.hmac)(S,I)},verify:function(b,x,C,S=B){const I=b;if(x=vt("msgHash",x),C=vt("publicKey",C),"strict"in S)throw Error("options.strict was renamed to lowS");E1(S);const{lowS:D,prehash:Q}=S;let R,T;try{if(typeof I=="string"||zr(I))try{R=p.fromDER(I)}catch(O){if(!(O instanceof je.Err))throw O;R=p.fromCompact(I)}else{if(typeof I!="object"||typeof I.r!="bigint"||typeof I.s!="bigint")throw Error("PARSE");{const{r:O,s:q}=I;R=new p(O,q)}}T=c.fromHex(C)}catch(O){if(O.message==="PARSE")throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(D&&R.hasHighS())return!1;Q&&(x=t.hash(x));const{r:G,s:H}=R,L=m(x),M=o(H),_=a(L*M),z=a(G*M),N=c.BASE.multiplyAndAddUnsafe(T,_,z)?.toAffine();return!!N&&a(N.x)===G},ProjectivePoint:c,Signature:p,utils:w}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Fl(n){return{hash:n,hmac:(t,...e)=>fc(n,t,oc(...e)),randomBytes:za}}function $r(n,t){const e=r=>Ol({...n,...Fl(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);const B1=Le(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Gl=$r({a:B1.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:B1,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},ls),pi=BigInt(2**32-1),Ea=BigInt(32);function mc(n,t=!1){return t?{h:Number(n&pi),l:Number(n>>Ea&pi)}:{h:0|Number(n>>Ea&pi),l:0|Number(n&pi)}}function Ec(n,t=!1){let e=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:s,l:a}=mc(n[i],t);[e[i],r[i]]=[s,a]}return[e,r]}const kc=(n,t,e)=>n<<e|t>>>32-e,Bc=(n,t,e)=>t<<e|n>>>32-e,Ic=(n,t,e)=>t<<e-32|n>>>64-e,vc=(n,t,e)=>n<<e-32|t>>>64-e,et={fromBig:mc,split:Ec,toBig:(n,t)=>BigInt(n>>>0)<<Ea|BigInt(t>>>0),shrSH:(n,t,e)=>n>>>e,shrSL:(n,t,e)=>n<<32-e|t>>>e,rotrSH:(n,t,e)=>n>>>e|t<<32-e,rotrSL:(n,t,e)=>n<<32-e|t>>>e,rotrBH:(n,t,e)=>n<<64-e|t>>>e-32,rotrBL:(n,t,e)=>n>>>e-32|t<<64-e,rotr32H:(n,t)=>t,rotr32L:(n,t)=>n,rotlSH:kc,rotlSL:Bc,rotlBH:Ic,rotlBL:vc,add:function(n,t,e,r){const i=(t>>>0)+(r>>>0);return{h:n+e+(i/2**32|0)|0,l:0|i}},add3L:(n,t,e)=>(n>>>0)+(t>>>0)+(e>>>0),add3H:(n,t,e,r)=>t+e+r+(n/2**32|0)|0,add4L:(n,t,e,r)=>(n>>>0)+(t>>>0)+(e>>>0)+(r>>>0),add4H:(n,t,e,r,i)=>t+e+r+i+(n/2**32|0)|0,add5H:(n,t,e,r,i,s)=>t+e+r+i+s+(n/2**32|0)|0,add5L:(n,t,e,r,i)=>(n>>>0)+(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)},[ql,$l]=et.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),ar=new Uint32Array(80),or=new Uint32Array(80);class Sc extends cs{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:h,El:l,Fh:u,Fl:g,Gh:y,Gl:A,Hh:p,Hl:w}=this;return[t,e,r,i,s,a,o,c,h,l,u,g,y,A,p,w]}set(t,e,r,i,s,a,o,c,h,l,u,g,y,A,p,w){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|h,this.El=0|l,this.Fh=0|u,this.Fl=0|g,this.Gh=0|y,this.Gl=0|A,this.Hh=0|p,this.Hl=0|w}process(t,e){for(let m=0;m<16;m++,e+=4)ar[m]=t.getUint32(e),or[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){const E=0|ar[m-15],U=0|or[m-15],K=et.rotrSH(E,U,1)^et.rotrSH(E,U,8)^et.shrSH(E,U,7),P=et.rotrSL(E,U,1)^et.rotrSL(E,U,8)^et.shrSL(E,U,7),B=0|ar[m-2],b=0|or[m-2],x=et.rotrSH(B,b,19)^et.rotrBH(B,b,61)^et.shrSH(B,b,6),C=et.rotrSL(B,b,19)^et.rotrBL(B,b,61)^et.shrSL(B,b,6),S=et.add4L(P,C,or[m-7],or[m-16]),I=et.add4H(S,K,x,ar[m-7],ar[m-16]);ar[m]=0|I,or[m]=0|S}let{Ah:r,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:h,Dl:l,Eh:u,El:g,Fh:y,Fl:A,Gh:p,Gl:w,Hh:k,Hl:v}=this;for(let m=0;m<80;m++){const E=et.rotrSH(u,g,14)^et.rotrSH(u,g,18)^et.rotrBH(u,g,41),U=et.rotrSL(u,g,14)^et.rotrSL(u,g,18)^et.rotrBL(u,g,41),K=u&y^~u&p,P=g&A^~g&w,B=et.add5L(v,U,P,$l[m],or[m]),b=et.add5H(B,k,E,K,ql[m],ar[m]),x=0|B,C=et.rotrSH(r,i,28)^et.rotrBH(r,i,34)^et.rotrBH(r,i,39),S=et.rotrSL(r,i,28)^et.rotrBL(r,i,34)^et.rotrBL(r,i,39),I=r&s^r&o^s&o,D=i&a^i&c^a&c;k=0|p,v=0|w,p=0|y,w=0|A,y=0|u,A=0|g,{h:u,l:g}=et.add(0|h,0|l,0|b,0|x),h=0|o,l=0|c,o=0|s,c=0|a,s=0|r,a=0|i;const Q=et.add3L(x,S,D);r=et.add3H(Q,b,C,I),i=0|Q}({h:r,l:i}=et.add(0|this.Ah,0|this.Al,0|r,0|i)),{h:s,l:a}=et.add(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=et.add(0|this.Ch,0|this.Cl,0|o,0|c),{h,l}=et.add(0|this.Dh,0|this.Dl,0|h,0|l),{h:u,l:g}=et.add(0|this.Eh,0|this.El,0|u,0|g),{h:y,l:A}=et.add(0|this.Fh,0|this.Fl,0|y,0|A),{h:p,l:w}=et.add(0|this.Gh,0|this.Gl,0|p,0|w),{h:k,l:v}=et.add(0|this.Hh,0|this.Hl,0|k,0|v),this.set(r,i,s,a,o,c,h,l,u,g,y,A,p,w,k,v)}roundClean(){ar.fill(0),or.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class jl extends Sc{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const qa=er(()=>new Sc),$a=er(()=>new jl),I1=Le(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),Vl=$r({a:I1.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:I1,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},$a),ka=Le(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),Wr={a:ka.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:ka,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},Zl=$r({a:Wr.a,b:Wr.b,Fp:ka,n:Wr.n,Gx:Wr.Gx,Gy:Wr.Gy,h:Wr.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},qa),Cc=[],xc=[],Uc=[],Yl=BigInt(0),Cn=BigInt(1),Jl=BigInt(2),Wl=BigInt(7),Xl=BigInt(256),t2=BigInt(113);for(let n=0,t=Cn,e=1,r=0;n<24;n++){[e,r]=[r,(2*e+3*r)%5],Cc.push(2*(5*r+e)),xc.push((n+1)*(n+2)/2%64);let i=Yl;for(let s=0;s<7;s++)t=(t<<Cn^(t>>Wl)*t2)%Xl,t&Jl&&(i^=Cn<<(Cn<<BigInt(s))-Cn);Uc.push(i)}const[e2,r2]=Ec(Uc,!0),v1=(n,t,e)=>e>32?Ic(n,t,e):kc(n,t,e),S1=(n,t,e)=>e>32?vc(n,t,e):Bc(n,t,e);class us extends Na{constructor(t,e,r,i=!1,s=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Vi(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}keccak(){g1||y1(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,h=(o+2)%10,l=r[h],u=r[h+1],g=v1(l,u,1)^r[c],y=S1(l,u,1)^r[c+1];for(let A=0;A<50;A+=10)t[o+A]^=g,t[o+A+1]^=y}let s=t[2],a=t[3];for(let o=0;o<24;o++){const c=xc[o],h=v1(s,a,c),l=S1(s,a,c),u=Cc[o];s=t[u],a=t[u+1],t[u]=h,t[u+1]=l}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=e2[i],t[1]^=r2[i]}r.fill(0)}(this.state32,this.rounds),g1||y1(this.state32),this.posOut=0,this.pos=0}update(t){dn(this);const{blockLen:e,state:r}=this,i=(t=ri(t)).length;for(let s=0;s<i;){const a=Math.min(e-this.pos,i-s);for(let o=0;o<a;o++)r[this.pos++]^=t[s++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:i}=this;t[r]^=e,128&e&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){dn(this,!1),ei(t),this.finish();const e=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const a=Math.min(r-this.posOut,s-i);t.set(e.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Vi(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(sc(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:i,rounds:s,enableXOF:a}=this;return t||(t=new us(e,r,i,a,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=a,t.destroyed=this.destroyed,t}}const Kc=(n,t,e)=>er(()=>new us(t,n,e)),n2=Kc(6,136,32),i2=Kc(6,72,64),Pc=((n,t,e)=>function(r){const i=(a,o)=>r(o).update(ri(a)).digest(),s=r({});return i.outputLen=s.outputLen,i.blockLen=s.blockLen,i.create=a=>r(a),i}((r={})=>new us(t,n,r.dkLen===void 0?e:r.dkLen,!0)))(31,136,32),de=BigInt(0),jt=BigInt(1),di=BigInt(2),s2=BigInt(8),a2={zip215:!0};function o2(n){const t=function(S){const I=Ga(S);return Fr(S,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...I})}(n),{Fp:e,n:r,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=t,h=di<<BigInt(8*o)-jt,l=e.create,u=Le(t.n,t.nBitLength),g=t.uvRatio||((S,I)=>{try{return{isValid:!0,value:e.sqrt(S*e.inv(I))}}catch{return{isValid:!1,value:de}}}),y=t.adjustScalarBytes||(S=>S),A=t.domain||((S,I,D)=>{if(Ze("phflag",D),I.length||D)throw Error("Contexts/pre-hash are not supported");return S});function p(S,I){Xt("coordinate "+S,I,de,h)}function w(S){if(!(S instanceof m))throw Error("ExtendedPoint expected")}const k=Yn((S,I)=>{const{ex:D,ey:Q,ez:R}=S,T=S.is0();I==null&&(I=T?s2:e.inv(R));const G=l(D*I),H=l(Q*I),L=l(R*I);if(T)return{x:de,y:jt};if(L!==jt)throw Error("invZ was invalid");return{x:G,y:H}}),v=Yn(S=>{const{a:I,d:D}=t;if(S.is0())throw Error("bad point: ZERO");const{ex:Q,ey:R,ez:T,et:G}=S,H=l(Q*Q),L=l(R*R),M=l(T*T),_=l(M*M),z=l(H*I);if(l(M*l(z+L))!==l(_+l(D*l(H*L))))throw Error("bad point: equation left != right (1)");if(l(Q*R)!==l(T*G))throw Error("bad point: equation left != right (2)");return!0});class m{constructor(I,D,Q,R){this.ex=I,this.ey=D,this.ez=Q,this.et=R,p("x",I),p("y",D),p("z",Q),p("t",R),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(I){if(I instanceof m)throw Error("extended point not allowed");const{x:D,y:Q}=I||{};return p("x",D),p("y",Q),new m(D,Q,jt,l(D*Q))}static normalizeZ(I){const D=e.invertBatch(I.map(Q=>Q.ez));return I.map((Q,R)=>Q.toAffine(D[R])).map(m.fromAffine)}static msm(I,D){return bc(m,u,I,D)}_setWindowSize(I){K.setWindowSize(this,I)}assertValidity(){v(this)}equals(I){w(I);const{ex:D,ey:Q,ez:R}=this,{ex:T,ey:G,ez:H}=I,L=l(D*H),M=l(T*R),_=l(Q*H),z=l(G*R);return L===M&&_===z}is0(){return this.equals(m.ZERO)}negate(){return new m(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:I}=t,{ex:D,ey:Q,ez:R}=this,T=l(D*D),G=l(Q*Q),H=l(di*l(R*R)),L=l(I*T),M=D+Q,_=l(l(M*M)-T-G),z=L+G,N=z-H,O=L-G,q=l(_*N),X=l(z*O),Y=l(_*O),nt=l(N*z);return new m(q,X,nt,Y)}add(I){w(I);const{a:D,d:Q}=t,{ex:R,ey:T,ez:G,et:H}=this,{ex:L,ey:M,ez:_,et:z}=I;if(D===BigInt(-1)){const bn=l((T-R)*(M+L)),Vr=l((T+R)*(M-L)),fs=l(Vr-bn);if(fs===de)return this.double();const Ja=l(G*di*z),Wa=l(H*di*_),Xa=Wa+Ja,to=Vr+bn,eo=Wa-Ja,Gc=l(Xa*fs),qc=l(to*eo),$c=l(Xa*eo),jc=l(fs*to);return new m(Gc,qc,jc,$c)}const N=l(R*L),O=l(T*M),q=l(H*Q*z),X=l(G*_),Y=l((R+T)*(L+M)-N-O),nt=X-q,tt=X+q,ot=l(O-D*N),ht=l(Y*nt),mt=l(tt*ot),kt=l(Y*ot),Bt=l(nt*tt);return new m(ht,mt,Bt,kt)}subtract(I){return this.add(I.negate())}wNAF(I){return K.wNAFCached(this,I,m.normalizeZ)}multiply(I){const D=I;Xt("scalar",D,jt,r);const{p:Q,f:R}=this.wNAF(D);return m.normalizeZ([Q,R])[0]}multiplyUnsafe(I){const D=I;return Xt("scalar",D,de,r),D===de?U:this.equals(U)||D===jt?this:this.equals(E)?this.wNAF(D).p:K.unsafeLadder(this,D)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return K.unsafeLadder(this,r).is0()}toAffine(I){return k(this,I)}clearCofactor(){const{h:I}=t;return I===jt?this:this.multiplyUnsafe(I)}static fromHex(I,D=!1){const{d:Q,a:R}=t,T=e.BYTES;I=vt("pointHex",I,T),Ze("zip215",D);const G=I.slice(),H=I[T-1];G[T-1]=-129&H;const L=br(G),M=D?h:e.ORDER;Xt("pointHex.y",L,de,M);const _=l(L*L),z=l(_-jt),N=l(Q*_-R);let{isValid:O,value:q}=g(z,N);if(!O)throw Error("Point.fromHex: invalid y coordinate");const X=(q&jt)===jt,Y=!!(128&H);if(!D&&q===de&&Y)throw Error("Point.fromHex: x=0 and x_0=1");return Y!==X&&(q=l(-q)),m.fromAffine({x:q,y:L})}static fromPrivateKey(I){return b(I).point}toRawBytes(){const{x:I,y:D}=this.toAffine(),Q=wn(D,e.BYTES);return Q[Q.length-1]|=I&jt?128:0,Q}toHex(){return Hr(this.toRawBytes())}}m.BASE=new m(t.Gx,t.Gy,jt,l(t.Gx*t.Gy)),m.ZERO=new m(de,jt,jt,de);const{BASE:E,ZERO:U}=m,K=wc(m,8*o);function P(S){return bt(S,r)}function B(S){return P(br(S))}function b(S){const I=o;S=vt("private key",S,I);const D=vt("hashed private key",s(S),2*I),Q=y(D.slice(0,I)),R=D.slice(I,2*I),T=B(Q),G=E.multiply(T),H=G.toRawBytes();return{head:Q,prefix:R,scalar:T,point:G,pointBytes:H}}function x(S=new Uint8Array,...I){const D=Or(...I);return B(s(A(D,vt("context",S),!!i)))}const C=a2;return E._setWindowSize(8),{CURVE:t,getPublicKey:function(S){return b(S).pointBytes},sign:function(S,I,D={}){S=vt("message",S),i&&(S=i(S));const{prefix:Q,scalar:R,pointBytes:T}=b(I),G=x(D.context,Q,S),H=E.multiply(G).toRawBytes(),L=P(G+x(D.context,H,T,S)*R);return Xt("signature.s",L,de,r),vt("result",Or(H,wn(L,e.BYTES)),2*o)},verify:function(S,I,D,Q=C){const{context:R,zip215:T}=Q,G=e.BYTES;S=vt("signature",S,2*G),I=vt("message",I),T!==void 0&&Ze("zip215",T),i&&(I=i(I));const H=br(S.slice(G,2*G));let L,M,_;try{L=m.fromHex(D,T),M=m.fromHex(S.slice(0,G),T),_=E.multiplyUnsafe(H)}catch{return!1}if(!T&&L.isSmallOrder())return!1;const z=x(R,M.toRawBytes(),L.toRawBytes(),I);return M.add(L.multiplyUnsafe(z)).subtract(_).clearCofactor().equals(m.ZERO)},ExtendedPoint:m,utils:{getExtendedPublicKey:b,randomPrivateKey:()=>a(e.BYTES),precompute:(S=8,I=m.BASE)=>(I._setWindowSize(S),I.multiply(BigInt(3)),I)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xr=BigInt(0),Hs=BigInt(1);function c2(n){const t=(Fr(e=n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e}));var e;const{P:r}=t,i=w=>bt(w,r),s=t.montgomeryBits,a=Math.ceil(s/8),o=t.nByteLength,c=t.adjustScalarBytes||(w=>w),h=t.powPminus2||(w=>pc(w,r-BigInt(2),r));function l(w,k,v){const m=i(w*(k-v));return[k=i(k-m),v=i(v+m)]}const u=(t.a-BigInt(2))/BigInt(4);function g(w){return wn(i(w),a)}function y(w,k){const v=function(U){const K=vt("u coordinate",U,a);return o===32&&(K[31]&=127),br(K)}(k),m=function(U){const K=vt("scalar",U),P=K.length;if(P!==a&&P!==o)throw Error(`Expected ${a} or ${o} bytes, got ${P}`);return br(c(K))}(w),E=function(U,K){Xt("u",U,Xr,r),Xt("scalar",K,Xr,r);const P=K,B=U;let b,x=Hs,C=Xr,S=U,I=Hs,D=Xr;for(let R=BigInt(s-1);R>=Xr;R--){const T=P>>R&Hs;D^=T,b=l(D,x,S),x=b[0],S=b[1],b=l(D,C,I),C=b[0],I=b[1],D=T;const G=x+C,H=i(G*G),L=x-C,M=i(L*L),_=H-M,z=S+I,N=i((S-I)*G),O=i(z*L),q=N+O,X=N-O;S=i(q*q),I=i(B*i(X*X)),x=i(H*M),C=i(_*(H+i(u*_)))}b=l(D,x,S),x=b[0],S=b[1],b=l(D,C,I),C=b[0],I=b[1];const Q=h(C);return i(x*Q)}(v,m);if(E===Xr)throw Error("Invalid private or public key received");return g(E)}const A=g(t.Gu);function p(w){return y(w,A)}return{scalarMult:y,scalarMultBase:p,getSharedSecret:(w,k)=>y(w,k),getPublicKey:w=>p(w),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const l2=er(()=>Pc.create({dkLen:114})),Jn=(er(()=>Pc.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),h2=BigInt(1),C1=BigInt(2),x1=BigInt(3);BigInt(4);const u2=BigInt(11),f2=BigInt(22),U1=BigInt(44),g2=BigInt(88),y2=BigInt(223);function Dc(n){const t=Jn,e=n*n*n%t,r=e*e*n%t,i=wt(r,x1,t)*r%t,s=wt(i,x1,t)*r%t,a=wt(s,C1,t)*e%t,o=wt(a,u2,t)*a%t,c=wt(o,f2,t)*o%t,h=wt(c,U1,t)*c%t,l=wt(h,g2,t)*h%t,u=wt(l,U1,t)*c%t,g=wt(u,C1,t)*e%t,y=wt(g,h2,t)*n%t;return wt(y,y2,t)*g%t}function Qc(n){return n[0]&=252,n[55]|=128,n[56]=0,n}const Rc=Le(Jn,456,!0),p2={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Rc,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:l2,randomBytes:za,adjustScalarBytes:Qc,domain:(n,t,e)=>{if(t.length>255)throw Error("Context is too big: "+t.length);return oc(ac("SigEd448"),new Uint8Array([e?1:0,t.length]),t,n)},uvRatio:function(n,t){const e=Jn,r=bt(n*n*t,e),i=bt(r*n,e),s=bt(i*r*t,e),a=bt(i*Dc(s),e),o=bt(a*a,e);return{isValid:bt(o*t,e)===n,value:a}}},d2=o2(p2),A2=c2({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:Jn,Gu:BigInt(5),powPminus2:n=>{const t=Jn;return bt(wt(Dc(n),BigInt(2),t)*n,t)},adjustScalarBytes:Qc,randomBytes:za});Rc.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const K1=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),P1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),w2=BigInt(1),Ba=BigInt(2),D1=(n,t)=>(n+t/Ba)/t,Ia=Le(K1,void 0,void 0,{sqrt:function(n){const t=K1,e=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),h=n*n*n%t,l=h*h*n%t,u=wt(l,e,t)*l%t,g=wt(u,e,t)*l%t,y=wt(g,Ba,t)*h%t,A=wt(y,i,t)*y%t,p=wt(A,s,t)*A%t,w=wt(p,o,t)*p%t,k=wt(w,c,t)*w%t,v=wt(k,o,t)*p%t,m=wt(v,e,t)*l%t,E=wt(m,a,t)*A%t,U=wt(E,r,t)*h%t,K=wt(U,Ba,t);if(!Ia.eql(Ia.sqr(K),n))throw Error("Cannot find square root");return K}}),_c=$r({a:BigInt(0),b:BigInt(7),Fp:Ia,n:P1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const t=P1,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-w2*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,a=BigInt("0x100000000000000000000000000000000"),o=D1(s*n,t),c=D1(-r*n,t);let h=bt(n-o*e-c*i,t),l=bt(-o*r-c*s,t);const u=h>a,g=l>a;if(u&&(h=t-h),g&&(l=t-l),h>a||l>a)throw Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:u,k1:h,k2neg:g,k2:l}}}},ls);BigInt(0),_c.ProjectivePoint;const Q1=Le(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),b2=$r({a:Q1.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Q1,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},ls),R1=Le(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),m2=$r({a:R1.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:R1,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},$a),_1=Le(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),E2=$r({a:_1.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:_1,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},qa),k2=new Map(Object.entries({nistP256:Gl,nistP384:Vl,nistP521:Zl,brainpoolP256r1:b2,brainpoolP384r1:m2,brainpoolP512r1:E2,secp256k1:_c,x448:A2,ed448:d2}));var B2=Object.freeze({__proto__:null,nobleCurves:k2});function Os(n,t,e,r,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],h=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],g=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let A,p,w,k,v,m,E,U,K,P,B=0,b=t.length;const x=n.length===32?3:9;U=x===3?e?[0,32,2]:[30,-2,-2]:e?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],e&&(t=function(I){const D=8-I.length%8;let Q;if(!(D<8)){if(D===8)return I;throw Error("des: invalid padding")}Q=0;const R=new Uint8Array(I.length+D);for(let T=0;T<I.length;T++)R[T]=I[T];for(let T=0;T<D;T++)R[I.length+T]=Q;return R}(t),b=t.length);let C=new Uint8Array(b),S=0;for(;B<b;){for(m=t[B++]<<24|t[B++]<<16|t[B++]<<8|t[B++],E=t[B++]<<24|t[B++]<<16|t[B++]<<8|t[B++],w=252645135&(m>>>4^E),E^=w,m^=w<<4,w=65535&(m>>>16^E),E^=w,m^=w<<16,w=858993459&(E>>>2^m),m^=w,E^=w<<2,w=16711935&(E>>>8^m),m^=w,E^=w<<8,w=1431655765&(m>>>1^E),E^=w,m^=w<<1,m=m<<1|m>>>31,E=E<<1|E>>>31,p=0;p<x;p+=3){for(K=U[p+1],P=U[p+2],A=U[p];A!==K;A+=P)k=E^n[A],v=(E>>>4|E<<28)^n[A+1],w=m,m=E,E=w^(o[k>>>24&63]|h[k>>>16&63]|u[k>>>8&63]|y[63&k]|a[v>>>24&63]|c[v>>>16&63]|l[v>>>8&63]|g[63&v]);w=m,m=E,E=w}m=m>>>1|m<<31,E=E>>>1|E<<31,w=1431655765&(m>>>1^E),E^=w,m^=w<<1,w=16711935&(E>>>8^m),m^=w,E^=w<<8,w=858993459&(E>>>2^m),m^=w,E^=w<<2,w=65535&(m>>>16^E),E^=w,m^=w<<16,w=252645135&(m>>>4^E),E^=w,m^=w<<4,C[S++]=m>>>24,C[S++]=m>>>16&255,C[S++]=m>>>8&255,C[S++]=255&m,C[S++]=E>>>24,C[S++]=E>>>16&255,C[S++]=E>>>8&255,C[S++]=255&E}return e||(C=function(I){let D,Q=null;if(D=0,!Q){for(Q=1;I[I.length-Q]===D;)Q++;Q--}return I.subarray(0,I.length-Q)}(C)),C}function Fs(n){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],e=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],h=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],u=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],g=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],A=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=n.length>8?3:1,w=Array(32*p),k=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let v,m,E,U=0,K=0;for(let P=0;P<p;P++){let B=n[U++]<<24|n[U++]<<16|n[U++]<<8|n[U++],b=n[U++]<<24|n[U++]<<16|n[U++]<<8|n[U++];E=252645135&(B>>>4^b),b^=E,B^=E<<4,E=65535&(b>>>-16^B),B^=E,b^=E<<-16,E=858993459&(B>>>2^b),b^=E,B^=E<<2,E=65535&(b>>>-16^B),B^=E,b^=E<<-16,E=1431655765&(B>>>1^b),b^=E,B^=E<<1,E=16711935&(b>>>8^B),B^=E,b^=E<<8,E=1431655765&(B>>>1^b),b^=E,B^=E<<1,E=B<<8|b>>>20&240,B=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=E;for(let x=0;x<16;x++)k[x]?(B=B<<2|B>>>26,b=b<<2|b>>>26):(B=B<<1|B>>>27,b=b<<1|b>>>27),B&=-15,b&=-15,v=t[B>>>28]|e[B>>>24&15]|r[B>>>20&15]|i[B>>>16&15]|s[B>>>12&15]|a[B>>>8&15]|o[B>>>4&15],m=c[b>>>28]|h[b>>>24&15]|l[b>>>20&15]|u[b>>>16&15]|g[b>>>12&15]|y[b>>>8&15]|A[b>>>4&15],E=65535&(m>>>16^v),w[K++]=v^E,w[K++]=m^E<<16}return w}function Tn(n){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(n.subarray(8*t,8*t+8)));this.encrypt=function(t){return Os(Fs(this.key[2]),Os(Fs(this.key[1]),Os(Fs(this.key[0]),t,!0),!1),!0)}}function I2(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let h,l=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],u=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];h=u,u=l^e(u,this.masking[0],this.rotate[0]),l=h,h=u,u=l^r(u,this.masking[1],this.rotate[1]),l=h,h=u,u=l^i(u,this.masking[2],this.rotate[2]),l=h,h=u,u=l^e(u,this.masking[3],this.rotate[3]),l=h,h=u,u=l^r(u,this.masking[4],this.rotate[4]),l=h,h=u,u=l^i(u,this.masking[5],this.rotate[5]),l=h,h=u,u=l^e(u,this.masking[6],this.rotate[6]),l=h,h=u,u=l^r(u,this.masking[7],this.rotate[7]),l=h,h=u,u=l^i(u,this.masking[8],this.rotate[8]),l=h,h=u,u=l^e(u,this.masking[9],this.rotate[9]),l=h,h=u,u=l^r(u,this.masking[10],this.rotate[10]),l=h,h=u,u=l^i(u,this.masking[11],this.rotate[11]),l=h,h=u,u=l^e(u,this.masking[12],this.rotate[12]),l=h,h=u,u=l^r(u,this.masking[13],this.rotate[13]),l=h,h=u,u=l^i(u,this.masking[14],this.rotate[14]),l=h,h=u,u=l^e(u,this.masking[15],this.rotate[15]),l=h,o[c]=u>>>24&255,o[c+1]=u>>>16&255,o[c+2]=u>>>8&255,o[c+3]=255&u,o[c+4]=l>>>24&255,o[c+5]=l>>>16&255,o[c+6]=l>>>8&255,o[c+7]=255&l}return o},this.decrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let h,l=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],u=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];h=u,u=l^e(u,this.masking[15],this.rotate[15]),l=h,h=u,u=l^i(u,this.masking[14],this.rotate[14]),l=h,h=u,u=l^r(u,this.masking[13],this.rotate[13]),l=h,h=u,u=l^e(u,this.masking[12],this.rotate[12]),l=h,h=u,u=l^i(u,this.masking[11],this.rotate[11]),l=h,h=u,u=l^r(u,this.masking[10],this.rotate[10]),l=h,h=u,u=l^e(u,this.masking[9],this.rotate[9]),l=h,h=u,u=l^i(u,this.masking[8],this.rotate[8]),l=h,h=u,u=l^r(u,this.masking[7],this.rotate[7]),l=h,h=u,u=l^e(u,this.masking[6],this.rotate[6]),l=h,h=u,u=l^i(u,this.masking[5],this.rotate[5]),l=h,h=u,u=l^r(u,this.masking[4],this.rotate[4]),l=h,h=u,u=l^e(u,this.masking[3],this.rotate[3]),l=h,h=u,u=l^i(u,this.masking[2],this.rotate[2]),l=h,h=u,u=l^r(u,this.masking[1],this.rotate[1]),l=h,h=u,u=l^e(u,this.masking[0],this.rotate[0]),l=h,o[c]=u>>>24&255,o[c+1]=u>>>16&255,o[c+2]=u>>>8&255,o[c+3]=255&u,o[c+4]=l>>>24&255,o[c+5]=l>>16&255,o[c+6]=l>>8&255,o[c+7]=255&l}return o};const n=[,,,,];n[0]=[,,,,],n[0][0]=[4,0,13,15,12,14,8],n[0][1]=[5,2,16,18,17,19,10],n[0][2]=[6,3,23,22,21,20,9],n[0][3]=[7,1,26,25,27,24,11],n[1]=[,,,,],n[1][0]=[0,6,21,23,20,22,16],n[1][1]=[1,4,0,2,1,3,18],n[1][2]=[2,5,7,6,5,4,17],n[1][3]=[3,7,10,9,11,8,19],n[2]=[,,,,],n[2][0]=[4,0,13,15,12,14,8],n[2][1]=[5,2,16,18,17,19,10],n[2][2]=[6,3,23,22,21,20,9],n[2][3]=[7,1,26,25,27,24,11],n[3]=[,,,,],n[3][0]=[0,6,21,23,20,22,16],n[3][1]=[1,4,0,2,1,3,18],n[3][2]=[2,5,7,6,5,4,17],n[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function e(a,o,c){const h=o+a,l=h<<c|h>>>32-c;return(s[0][l>>>24]^s[1][l>>>16&255])-s[2][l>>>8&255]+s[3][255&l]}function r(a,o,c){const h=o^a,l=h<<c|h>>>32-c;return s[0][l>>>24]-s[1][l>>>16&255]+s[2][l>>>8&255]^s[3][255&l]}function i(a,o,c){const h=o-a,l=h<<c|h>>>32-c;return(s[0][l>>>24]+s[1][l>>>16&255]^s[2][l>>>8&255])-s[3][255&l]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(a){const o=[,,,,,,,,],c=Array(32);let h;for(let y=0;y<4;y++)h=4*y,o[y]=a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3];const l=[6,7,4,5];let u,g=0;for(let y=0;y<2;y++)for(let A=0;A<4;A++){for(h=0;h<4;h++){const p=n[A][h];u=o[p[1]],u^=s[4][o[p[2]>>>2]>>>24-8*(3&p[2])&255],u^=s[5][o[p[3]>>>2]>>>24-8*(3&p[3])&255],u^=s[6][o[p[4]>>>2]>>>24-8*(3&p[4])&255],u^=s[7][o[p[5]>>>2]>>>24-8*(3&p[5])&255],u^=s[l[h]][o[p[6]>>>2]>>>24-8*(3&p[6])&255],o[p[0]]=u}for(h=0;h<4;h++){const p=t[A][h];u=s[4][o[p[0]>>>2]>>>24-8*(3&p[0])&255],u^=s[5][o[p[1]>>>2]>>>24-8*(3&p[1])&255],u^=s[6][o[p[2]>>>2]>>>24-8*(3&p[2])&255],u^=s[7][o[p[3]>>>2]>>>24-8*(3&p[3])&255],u^=s[4+h][o[p[4]>>>2]>>>24-8*(3&p[4])&255],c[g]=u,g++}}for(let y=0;y<16;y++)this.masking[y]=c[y],this.rotate[y]=31&c[16+y]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Ln(n){this.cast5=new I2,this.cast5.setKey(n),this.encrypt=function(t){return this.cast5.encrypt(t)}}Tn.keySize=Tn.prototype.keySize=24,Tn.blockSize=Tn.prototype.blockSize=8,Ln.blockSize=Ln.prototype.blockSize=8,Ln.keySize=Ln.prototype.keySize=16;const he=4294967295;function Be(n,t){return(n<<t|n>>>32-t)&he}function Oe(n,t){return n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24}function cr(n,t,e){n.splice(t,4,255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function J(n,t){return n>>>8*t&255}function Mn(n){this.tf=function(){let t=null,e=null,r=-1,i=[],s=[[],[],[],[]];function a(l){return s[0][J(l,0)]^s[1][J(l,1)]^s[2][J(l,2)]^s[3][J(l,3)]}function o(l){return s[0][J(l,3)]^s[1][J(l,0)]^s[2][J(l,1)]^s[3][J(l,2)]}function c(l,u){let g=a(u[0]),y=o(u[1]);u[2]=Be(u[2]^g+y+i[4*l+8]&he,31),u[3]=Be(u[3],1)^g+2*y+i[4*l+9]&he,g=a(u[2]),y=o(u[3]),u[0]=Be(u[0]^g+y+i[4*l+10]&he,31),u[1]=Be(u[1],1)^g+2*y+i[4*l+11]&he}function h(l,u){let g=a(u[0]),y=o(u[1]);u[2]=Be(u[2],1)^g+y+i[4*l+10]&he,u[3]=Be(u[3]^g+2*y+i[4*l+11]&he,31),g=a(u[2]),y=o(u[3]),u[0]=Be(u[0],1)^g+y+i[4*l+8]&he,u[1]=Be(u[1]^g+2*y+i[4*l+9]&he,31)}return{name:"twofish",blocksize:16,open:function(l){let u,g,y,A,p;t=l;const w=[],k=[],v=[];let m;const E=[];let U,K,P;const B=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],b=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],x=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],C=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],S=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],I=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],D=[[],[]],Q=[[],[],[],[]];function R(M){return M^M>>2^[0,90,180,238][3&M]}function T(M){return M^M>>1^M>>2^[0,238,180,90][3&M]}function G(M,_){let z,N,O;for(z=0;z<8;z++)N=_>>>24,_=_<<8&he|M>>>24,M=M<<8&he,O=N<<1,128&N&&(O^=333),_^=N^O<<16,O^=N>>>1,1&N&&(O^=166),_^=O<<24|O<<8;return _}function H(M,_){const z=_>>4,N=15&_,O=B[M][z^N],q=b[M][S[N]^I[z]];return C[M][S[q]^I[O]]<<4|x[M][O^q]}function L(M,_){let z=J(M,0),N=J(M,1),O=J(M,2),q=J(M,3);switch(m){case 4:z=D[1][z]^J(_[3],0),N=D[0][N]^J(_[3],1),O=D[0][O]^J(_[3],2),q=D[1][q]^J(_[3],3);case 3:z=D[1][z]^J(_[2],0),N=D[1][N]^J(_[2],1),O=D[0][O]^J(_[2],2),q=D[0][q]^J(_[2],3);case 2:z=D[0][D[0][z]^J(_[1],0)]^J(_[0],0),N=D[0][D[1][N]^J(_[1],1)]^J(_[0],1),O=D[1][D[0][O]^J(_[1],2)]^J(_[0],2),q=D[1][D[1][q]^J(_[1],3)]^J(_[0],3)}return Q[0][z]^Q[1][N]^Q[2][O]^Q[3][q]}for(t=t.slice(0,32),u=t.length;u!==16&&u!==24&&u!==32;)t[u++]=0;for(u=0;u<t.length;u+=4)v[u>>2]=Oe(t,u);for(u=0;u<256;u++)D[0][u]=H(0,u),D[1][u]=H(1,u);for(u=0;u<256;u++)U=D[1][u],K=R(U),P=T(U),Q[0][u]=U+(K<<8)+(P<<16)+(P<<24),Q[2][u]=K+(P<<8)+(U<<16)+(P<<24),U=D[0][u],K=R(U),P=T(U),Q[1][u]=P+(P<<8)+(K<<16)+(U<<24),Q[3][u]=K+(U<<8)+(P<<16)+(K<<24);for(m=v.length/2,u=0;u<m;u++)g=v[u+u],w[u]=g,y=v[u+u+1],k[u]=y,E[m-u-1]=G(g,y);for(u=0;u<40;u+=2)g=16843009*u,y=g+16843009,g=L(g,w),y=Be(L(y,k),8),i[u]=g+y&he,i[u+1]=Be(g+2*y,9);for(u=0;u<256;u++)switch(g=y=A=p=u,m){case 4:g=D[1][g]^J(E[3],0),y=D[0][y]^J(E[3],1),A=D[0][A]^J(E[3],2),p=D[1][p]^J(E[3],3);case 3:g=D[1][g]^J(E[2],0),y=D[1][y]^J(E[2],1),A=D[0][A]^J(E[2],2),p=D[0][p]^J(E[2],3);case 2:s[0][u]=Q[0][D[0][D[0][g]^J(E[1],0)]^J(E[0],0)],s[1][u]=Q[1][D[0][D[1][y]^J(E[1],1)]^J(E[0],1)],s[2][u]=Q[2][D[1][D[0][A]^J(E[1],2)]^J(E[0],2)],s[3][u]=Q[3][D[1][D[1][p]^J(E[1],3)]^J(E[0],3)]}},close:function(){i=[],s=[[],[],[],[]]},encrypt:function(l,u){e=l,r=u;const g=[Oe(e,r)^i[0],Oe(e,r+4)^i[1],Oe(e,r+8)^i[2],Oe(e,r+12)^i[3]];for(let y=0;y<8;y++)c(y,g);return cr(e,r,g[2]^i[4]),cr(e,r+4,g[3]^i[5]),cr(e,r+8,g[0]^i[6]),cr(e,r+12,g[1]^i[7]),r+=16,e},decrypt:function(l,u){e=l,r=u;const g=[Oe(e,r)^i[4],Oe(e,r+4)^i[5],Oe(e,r+8)^i[6],Oe(e,r+12)^i[7]];for(let y=7;y>=0;y--)h(y,g);cr(e,r,g[2]^i[0]),cr(e,r+4,g[3]^i[1]),cr(e,r+8,g[0]^i[2]),cr(e,r+12,g[1]^i[3]),r+=16},finalize:function(){return e}}}(),this.tf.open(Array.from(n),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function Ae(){}function Nn(n){this.bf=new Ae,this.bf.init(n),this.encrypt=function(t){return this.bf.encryptBlock(t)}}Mn.keySize=Mn.prototype.keySize=32,Mn.blockSize=Mn.prototype.blockSize=16,Ae.prototype.BLOCKSIZE=8,Ae.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],Ae.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Ae.prototype.NN=16,Ae.prototype._clean=function(n){return n<0&&(n=(2147483647&n)+2147483648),n},Ae.prototype._F=function(n){let t;const e=255&n,r=255&(n>>>=8),i=255&(n>>>=8),s=255&(n>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][i],t^=this.sboxes[2][r],t+=this.sboxes[3][e],t},Ae.prototype._encryptBlock=function(n){let t,e=n[0],r=n[1];for(t=0;t<this.NN;++t){e^=this.parray[t],r=this._F(e)^r;const i=e;e=r,r=i}e^=this.parray[this.NN+0],r^=this.parray[this.NN+1],n[0]=this._clean(r),n[1]=this._clean(e)},Ae.prototype.encryptBlock=function(n){let t;const e=[0,0],r=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)e[0]=e[0]<<8|255&n[t+0],e[1]=e[1]<<8|255&n[t+r];this._encryptBlock(e);const i=[];for(t=0;t<this.BLOCKSIZE/2;++t)i[t+0]=e[0]>>>24-8*t&255,i[t+r]=e[1]>>>24-8*t&255;return i},Ae.prototype._decryptBlock=function(n){let t,e=n[0],r=n[1];for(t=this.NN+1;t>1;--t){e^=this.parray[t],r=this._F(e)^r;const i=e;e=r,r=i}e^=this.parray[1],r^=this.parray[0],n[0]=this._clean(r),n[1]=this._clean(e)},Ae.prototype.init=function(n){let t,e=0;for(this.parray=[],t=0;t<this.NN+2;++t){let i=0;for(let s=0;s<4;++s)i=i<<8|255&n[e],++e>=n.length&&(e=0);this.parray[t]=this.PARRAY[t]^i}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],e=0;e<256;++e)this.sboxes[t][e]=this.SBOXES[t][e];const r=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(r),this.parray[t+0]=r[0],this.parray[t+1]=r[1];for(t=0;t<4;++t)for(e=0;e<256;e+=2)this._encryptBlock(r),this.sboxes[t][e+0]=r[0],this.sboxes[t][e+1]=r[1]},Nn.keySize=Nn.prototype.keySize=16,Nn.blockSize=Nn.prototype.blockSize=8;const v2=new Map([[f.symmetric.tripledes,Tn],[f.symmetric.cast5,Ln],[f.symmetric.blowfish,Nn],[f.symmetric.twofish,Mn]]);var S2=Object.freeze({__proto__:null,legacyCiphers:v2});const xn=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),lr=new Uint32Array(80);class C2 extends cs{constructor(){super(64,20,8,!1),this.A=0|xn[0],this.B=0|xn[1],this.C=0|xn[2],this.D=0|xn[3],this.E=0|xn[4]}get(){const{A:t,B:e,C:r,D:i,E:s}=this;return[t,e,r,i,s]}set(t,e,r,i,s){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|s}process(t,e){for(let c=0;c<16;c++,e+=4)lr[c]=t.getUint32(e,!1);for(let c=16;c<80;c++)lr[c]=Rr(lr[c-3]^lr[c-8]^lr[c-14]^lr[c-16],1);let{A:r,B:i,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let h,l;c<20?(h=cc(i,s,a),l=1518500249):c<40?(h=i^s^a,l=1859775393):c<60?(h=lc(i,s,a),l=2400959708):(h=i^s^a,l=3395469782);const u=Rr(r,5)+h+o+l+lr[c]|0;o=a,a=s,s=Rr(i,30),i=r,r=u}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(r,i,s,a,o)}roundClean(){lr.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const x2=er(()=>new C2),U2=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Tc=new Uint8Array(Array(16).fill(0).map((n,t)=>t)),K2=Tc.map(n=>(9*n+5)%16);let ja=[Tc],Va=[K2];for(let n=0;n<4;n++)for(let t of[ja,Va])t.push(t[n].map(e=>U2[e]));const Lc=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(n=>new Uint8Array(n)),P2=ja.map((n,t)=>n.map(e=>Lc[t][e])),D2=Va.map((n,t)=>n.map(e=>Lc[t][e])),Q2=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),R2=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function T1(n,t,e,r){return n===0?t^e^r:n===1?t&e|~t&r:n===2?(t|~e)^r:n===3?t&r|e&~r:t^(e|~r)}const Ai=new Uint32Array(16);class _2 extends cs{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:i,h4:s}=this;return[t,e,r,i,s]}set(t,e,r,i,s){this.h0=0|t,this.h1=0|e,this.h2=0|r,this.h3=0|i,this.h4=0|s}process(t,e){for(let y=0;y<16;y++,e+=4)Ai[y]=t.getUint32(e,!0);let r=0|this.h0,i=r,s=0|this.h1,a=s,o=0|this.h2,c=o,h=0|this.h3,l=h,u=0|this.h4,g=u;for(let y=0;y<5;y++){const A=4-y,p=Q2[y],w=R2[y],k=ja[y],v=Va[y],m=P2[y],E=D2[y];for(let U=0;U<16;U++){const K=Rr(r+T1(y,s,o,h)+Ai[k[U]]+p,m[U])+u|0;r=u,u=h,h=0|Rr(o,10),o=s,s=K}for(let U=0;U<16;U++){const K=Rr(i+T1(A,a,c,l)+Ai[v[U]]+w,E[U])+g|0;i=g,g=l,l=0|Rr(c,10),c=a,a=K}}this.set(this.h1+o+l|0,this.h2+h+g|0,this.h3+u+i|0,this.h4+r+a|0,this.h0+s+c|0)}roundClean(){Ai.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const T2=new Map(Object.entries({sha1:x2,sha224:Kl,sha256:ls,sha384:$a,sha512:qa,sha3_256:n2,sha3_512:i2,ripemd160:er(()=>new _2)}));var L2=Object.freeze({__proto__:null,nobleHashes:T2});function tn(n,t,e,r){n[t]+=e[r],n[t+1]+=e[r+1]+(n[t]<e[r])}function L1(n,t){n[0]+=t,n[1]+=n[0]<t}function hr(n,t,e,r,i,s,a,o){tn(n,e,n,r),tn(n,e,t,a);let c=n[s]^n[e],h=n[s+1]^n[e+1];n[s]=h,n[s+1]=c,tn(n,i,n,s),c=n[r]^n[i],h=n[r+1]^n[i+1],n[r]=c>>>24^h<<8,n[r+1]=h>>>24^c<<8,tn(n,e,n,r),tn(n,e,t,o),c=n[s]^n[e],h=n[s+1]^n[e+1],n[s]=c>>>16^h<<16,n[s+1]=h>>>16^c<<16,tn(n,i,n,s),c=n[r]^n[i],h=n[r+1]^n[i+1],n[r]=h>>>31^c<<1,n[r+1]=c>>>31^h<<1}const Mc=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Ht=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(n=>2*n));function M1(n,t){const e=new Uint32Array(32),r=new Uint32Array(n.b.buffer,n.b.byteOffset,32);for(let s=0;s<16;s++)e[s]=n.h[s],e[s+16]=Mc[s];e[24]^=n.t0[0],e[25]^=n.t0[1];const i=t?4294967295:0;e[28]^=i,e[29]^=i;for(let s=0;s<12;s++){const a=s<<4;hr(e,r,0,8,16,24,Ht[a+0],Ht[a+1]),hr(e,r,2,10,18,26,Ht[a+2],Ht[a+3]),hr(e,r,4,12,20,28,Ht[a+4],Ht[a+5]),hr(e,r,6,14,22,30,Ht[a+6],Ht[a+7]),hr(e,r,0,10,20,30,Ht[a+8],Ht[a+9]),hr(e,r,2,12,22,24,Ht[a+10],Ht[a+11]),hr(e,r,4,14,16,26,Ht[a+12],Ht[a+13]),hr(e,r,6,8,18,28,Ht[a+14],Ht[a+15])}for(let s=0;s<16;s++)n.h[s]^=e[s]^e[s+16]}class M2{constructor(t,e,r,i){const s=new Uint8Array(64);this.S={b:new Uint8Array(Un),h:new Uint32Array(va/4),t0:new Uint32Array(2),c:0,outlen:t},s[0]=t,e&&(s[1]=e.length),s[2]=1,s[3]=1,r&&s.set(r,32),i&&s.set(i,48);const a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=Mc[o]^a[o];if(e){const o=new Uint8Array(Un);o.set(e),this.update(o)}}update(t){if(!(t instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let e=0;for(;e<t.length;){this.S.c===Un&&(L1(this.S.t0,this.S.c),M1(this.S,!1),this.S.c=0);let r=Un-this.S.c;this.S.b.set(t.subarray(e,e+r),this.S.c);const i=Math.min(r,t.length-e);this.S.c+=i,e+=i}return this}digest(t){L1(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=Un,M1(this.S,!0);const e=t||new Uint8Array(this.S.outlen);for(let r=0;r<this.S.outlen;r++)e[r]=this.S.h[r>>2]>>8*(3&r);return this.S.h=null,e.buffer}}function xi(n,t,e,r){if(n>va)throw Error(`outlen must be at most ${va} (given: ${n})`);return new M2(n,t,e,r)}const va=64,Un=128,Sa=2,N1=19,N2=4294967295,z2=4,H2=4294967295,O2=8,F2=4294967295,G2=8,q2=4294967295,$2=4294967295,j2=32,Fe=1024,V2=64,Z2=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function Zt(n,t,e){return n[e+0]=t,n[e+1]=t>>8,n[e+2]=t>>16,n[e+3]=t>>24,n}function Pr(n,t,e){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let r=t;for(let i=e;i<e+7;i++)n[i]=r,r=(r-n[i])/256;return n}function Gs(n,t,e){const r=new Uint8Array(64),i=new Uint8Array(4+t.length);if(Zt(i,n,0),i.set(t,4),n<=64)return xi(n).update(i).digest(e),e;const s=Math.ceil(n/32)-2;for(let o=0;o<s;o++)xi(64).update(o===0?i:r).digest(r),e.set(r.subarray(0,32),32*o);const a=new Uint8Array(xi(n-32*s).update(r).digest());return e.set(a,32*s),e}function z1(n,t,e,r){return n.fn.XOR(t.byteOffset,e.byteOffset,r.byteOffset),t}function Y2(n,t,e,r){return n.fn.G(t.byteOffset,e.byteOffset,r.byteOffset,n.refs.gZ.byteOffset),r}function J2(n,t,e,r){return n.fn.G2(t.byteOffset,e.byteOffset,r.byteOffset,n.refs.gZ.byteOffset),r}function*W2(n,t,e,r,i,s,a,o){n.refs.prngTmp.fill(0);const c=n.refs.prngTmp.subarray(0,48);Pr(c,t,0),Pr(c,e,8),Pr(c,r,16),Pr(c,i,24),Pr(c,s,32),Pr(c,Sa,40);for(let h=1;h<=a;h++){Pr(n.refs.prngTmp,h,c.length);const l=J2(n,n.refs.ZERO1024,n.refs.prngTmp,n.refs.prngR);for(let u=h===1?8*o:0;u<l.length;u+=8)yield l.subarray(u,u+8)}return[]}const Nc=1024,X2=64*Nc;function th(n,{memory:t,instance:e}){if(!Z2)throw Error("BigEndian system not supported");const r=function({type:b,version:x,tagLength:C,password:S,salt:I,ad:D,secret:Q,parallelism:R,memorySize:T,passes:G}){const H=(L,M,_,z)=>{if(M<_||M>z)throw Error(`${L} size should be between ${_} and ${z} bytes`)};if(b!==Sa||x!==N1)throw Error("Unsupported type or version");return H("password",S,G2,F2),H("salt",I,O2,H2),H("tag",C,z2,N2),H("memory",T,8*R,q2),D&&H("associated data",D,0,$2),Q&&H("secret",Q,0,j2),{type:b,version:x,tagLength:C,password:S,salt:I,ad:D,secret:Q,lanes:R,memorySize:T,passes:G}}({type:Sa,version:N1,...n}),{G:i,G2:s,xor:a,getLZ:o}=e.exports,c={},h={};h.G=i,h.G2=s,h.XOR=a;const l=4*r.lanes*Math.floor(r.memorySize/(4*r.lanes)),u=l*Fe+10*Nc;if(t.buffer.byteLength<u){const b=Math.ceil((u-t.buffer.byteLength)/X2);t.grow(b)}let g=0;c.gZ=new Uint8Array(t.buffer,g,Fe),g+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,g,Fe),g+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,g,Fe),g+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,g,1024),g+=c.ZERO1024.length;const y=new Uint32Array(t.buffer,g,2);g+=y.length*Uint32Array.BYTES_PER_ELEMENT;const A={fn:h,refs:c},p=new Uint8Array(t.buffer,g,Fe);g+=p.length;const w=new Uint8Array(t.buffer,g,r.memorySize*Fe),k=new Uint8Array(t.buffer,0,g),v=function(b){const x=xi(V2),C=new Uint8Array(4),S=new Uint8Array(24);Zt(S,b.lanes,0),Zt(S,b.tagLength,4),Zt(S,b.memorySize,8),Zt(S,b.passes,12),Zt(S,b.version,16),Zt(S,b.type,20);const I=[S];b.password?(I.push(Zt(new Uint8Array(4),b.password.length,0)),I.push(b.password)):I.push(C),b.salt?(I.push(Zt(new Uint8Array(4),b.salt.length,0)),I.push(b.salt)):I.push(C),b.secret?(I.push(Zt(new Uint8Array(4),b.secret.length,0)),I.push(b.secret)):I.push(C),b.ad?(I.push(Zt(new Uint8Array(4),b.ad.length,0)),I.push(b.ad)):I.push(C),x.update(function(Q){if(Q.length===1)return Q[0];let R=0;for(let H=0;H<Q.length;H++){if(!(Q[H]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");R+=Q[H].length}const T=new Uint8Array(R);let G=0;return Q.forEach(H=>{T.set(H,G),G+=H.length}),T}(I));const D=x.digest();return new Uint8Array(D)}(r),m=l/r.lanes,E=Array(r.lanes).fill(null).map(()=>Array(m)),U=(b,x)=>(E[b][x]=w.subarray(b*m*1024+1024*x,b*m*1024+1024*x+Fe),E[b][x]);for(let b=0;b<r.lanes;b++){const x=new Uint8Array(v.length+8);x.set(v),Zt(x,0,v.length),Zt(x,b,v.length+4),Gs(Fe,x,U(b,0)),Zt(x,1,v.length),Gs(Fe,x,U(b,1))}const K=m/4;for(let b=0;b<r.passes;b++)for(let x=0;x<4;x++){const C=b===0&&x<=1;for(let S=0;S<r.lanes;S++){let I=x===0&&b===0?2:0;const D=C?W2(A,b,S,x,l,r.passes,K,I):null;for(;I<K;I++){const Q=x*K+I,R=Q>0?E[S][Q-1]:E[S][m-1],T=C?D.next().value:R;o(y.byteOffset,T.byteOffset,S,r.lanes,b,x,I,4,K);const G=y[0],H=y[1];b===0&&U(S,Q),Y2(A,R,E[G][H],b>0?p:E[S][Q]),b>0&&z1(A,E[S][Q],p,E[S][Q])}}}const P=E[0][m-1];for(let b=1;b<r.lanes;b++)z1(A,P,P,E[b][m-1]);const B=Gs(r.tagLength,P,new Uint8Array(r.tagLength));return k.fill(0),t.grow(0),B}let wi;async function eh(n,t){const e=new WebAssembly.Memory({initial:1040,maximum:65536}),r=await async function(i,s,a){const o={env:{memory:i}};if(wi===void 0)try{const c=await s(o);return wi=!0,c}catch{wi=!1}return(wi?s:a)(o)}(e,n,t);return i=>th(i,{instance:r.instance,memory:e})}function H1(n,t,e,r){var i=null,s=Ot.atob(e),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)i[o]=s.charCodeAt(o);return function(c,h){var l=WebAssembly.instantiate,u=WebAssembly.compile;return h?l(c,h):u(c)}(i,r)}var rh=Object.freeze({__proto__:null,default:async()=>eh(n=>H1(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",n),n=>H1(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",n))}),O1=[0,1,3,7,15,31,63,127,255],zn=function(n){this.stream=n,this.bitOffset=0,this.curByte=0,this.hasByte=!1};zn.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},zn.prototype.read=function(n){for(var t=0;n>0;){this._ensureByte();var e=8-this.bitOffset;if(n>=e)t<<=e,t|=O1[e]&this.curByte,this.hasByte=!1,this.bitOffset=0,n-=e;else{t<<=n;var r=e-n;t|=(this.curByte&O1[n]<<r)>>r,this.bitOffset+=n,n=0}}return t},zn.prototype.seek=function(n){var t=n%8,e=(n-t)/8;this.bitOffset=t,this.stream.seek(e),this.hasByte=!1},zn.prototype.pi=function(){var n,t=new Uint8Array(6);for(n=0;n<t.length;n++)t[n]=this.read(8);return function(e){return Array.prototype.map.call(e,r=>("00"+r.toString(16)).slice(-2)).join("")}(t)};var nh=zn,Dr=function(){};Dr.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Dr.prototype.read=function(n,t,e){for(var r=0;r<e;){var i=this.readByte();if(i<0)return r===0?-1:r;n[t++]=i,r++}return r},Dr.prototype.seek=function(n){throw Error("abstract method seek() not implemented")},Dr.prototype.writeByte=function(n){throw Error("abstract method readByte() not implemented")},Dr.prototype.write=function(n,t,e){var r;for(r=0;r<e;r++)this.writeByte(n[t++]);return e},Dr.prototype.flush=function(){};var qs,ih=Dr,sh=(qs=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var n=4294967295;this.getCRC=function(){return~n>>>0},this.updateCRC=function(t){n=n<<8^qs[255&(n>>>24^t)]},this.updateCRCRun=function(t,e){for(;e-- >0;)n=n<<8^qs[255&(n>>>24^t)]}}),ah=nh,Gn=ih,zc=sh,F1=function(n,t){var e,r=n[t];for(e=t;e>0;e--)n[e]=n[e-1];return n[0]=r,r},pt={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},ur={};ur[pt.LAST_BLOCK]="Bad file checksum",ur[pt.NOT_BZIP_DATA]="Not bzip data",ur[pt.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",ur[pt.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",ur[pt.DATA_ERROR]="Data error",ur[pt.OUT_OF_MEMORY]="Out of memory",ur[pt.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var Rt=function(n,t){var e=ur[n]||"unknown error";t&&(e+=": "+t);var r=new TypeError(e);throw r.errorCode=n,r},Ar=function(n,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(n,t)};Ar.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new zc,!0):(this.writeCount=-1,!1)},Ar.prototype._start_bunzip=function(n,t){var e=new Uint8Array(4);n.read(e,0,4)===4&&String.fromCharCode(e[0],e[1],e[2])==="BZh"||Rt(pt.NOT_BZIP_DATA,"bad magic");var r=e[3]-48;(r<1||r>9)&&Rt(pt.NOT_BZIP_DATA,"level out of range"),this.reader=new ah(n),this.dbufSize=1e5*r,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},Ar.prototype._get_next_block=function(){var n,t,e,r=this.reader,i=r.pi();if(i==="177245385090")return!1;i!=="314159265359"&&Rt(pt.NOT_BZIP_DATA),this.targetBlockCRC=r.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,r.read(1)&&Rt(pt.OBSOLETE_INPUT);var s=r.read(24);s>this.dbufSize&&Rt(pt.DATA_ERROR,"initial position out of bounds");var a=r.read(16),o=new Uint8Array(256),c=0;for(n=0;n<16;n++)if(a&1<<15-n){var h=16*n;for(e=r.read(16),t=0;t<16;t++)e&1<<15-t&&(o[c++]=h+t)}var l=r.read(3);(l<2||l>6)&&Rt(pt.DATA_ERROR);var u=r.read(15);u===0&&Rt(pt.DATA_ERROR);var g=new Uint8Array(256);for(n=0;n<l;n++)g[n]=n;var y=new Uint8Array(u);for(n=0;n<u;n++){for(t=0;r.read(1);t++)t>=l&&Rt(pt.DATA_ERROR);y[n]=F1(g,t)}var A,p=c+2,w=[];for(t=0;t<l;t++){var k,v,m=new Uint8Array(p),E=new Uint16Array(21);for(a=r.read(5),n=0;n<p;n++){for(;(a<1||a>20)&&Rt(pt.DATA_ERROR),r.read(1);)r.read(1)?a--:a++;m[n]=a}for(k=v=m[0],n=1;n<p;n++)m[n]>v?v=m[n]:m[n]<k&&(k=m[n]);A={},w.push(A),A.permute=new Uint16Array(258),A.limit=new Uint32Array(22),A.base=new Uint32Array(21),A.minLen=k,A.maxLen=v;var U=0;for(n=k;n<=v;n++)for(E[n]=A.limit[n]=0,a=0;a<p;a++)m[a]===n&&(A.permute[U++]=a);for(n=0;n<p;n++)E[m[n]]++;for(U=a=0,n=k;n<v;n++)U+=E[n],A.limit[n]=U-1,U<<=1,a+=E[n],A.base[n+1]=U-a;A.limit[v+1]=Number.MAX_VALUE,A.limit[v]=U+E[v]-1,A.base[k]=0}var K=new Uint32Array(256);for(n=0;n<256;n++)g[n]=n;var P,B=0,b=0,x=0,C=this.dbuf=new Uint32Array(this.dbufSize);for(p=0;;){for(p--||(p=49,x>=u&&Rt(pt.DATA_ERROR),A=w[y[x++]]),n=A.minLen,t=r.read(n);n>A.maxLen&&Rt(pt.DATA_ERROR),!(t<=A.limit[n]);n++)t=t<<1|r.read(1);((t-=A.base[n])<0||t>=258)&&Rt(pt.DATA_ERROR);var S=A.permute[t];if(S!==0&&S!==1){if(B)for(B=0,b+a>this.dbufSize&&Rt(pt.DATA_ERROR),K[P=o[g[0]]]+=a;a--;)C[b++]=P;if(S>c)break;b>=this.dbufSize&&Rt(pt.DATA_ERROR),K[P=o[P=F1(g,n=S-1)]]++,C[b++]=P}else B||(B=1,a=0),a+=S===0?B:2*B,B<<=1}for((s<0||s>=b)&&Rt(pt.DATA_ERROR),t=0,n=0;n<256;n++)e=t+K[n],K[n]=t,t=e;for(n=0;n<b;n++)C[K[P=255&C[n]]]|=n<<8,K[P]++;var I=0,D=0,Q=0;return b&&(D=255&(I=C[s]),I>>=8,Q=-1),this.writePos=I,this.writeCurrent=D,this.writeCount=b,this.writeRun=Q,!0},Ar.prototype._read_bunzip=function(n,t){var e,r,i;if(this.writeCount<0)return 0;var s=this.dbuf,a=this.writePos,o=this.writeCurrent,c=this.writeCount;this.outputsize;for(var h=this.writeRun;c;){for(c--,r=o,o=255&(a=s[a]),a>>=8,h++==3?(e=o,i=r,o=-1):(e=1,i=o),this.blockCRC.updateCRCRun(i,e);e--;)this.outputStream.writeByte(i),this.nextoutput++;o!=r&&(h=0)}return this.writeCount=c,this.blockCRC.getCRC()!==this.targetBlockCRC&&Rt(pt.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var $s=function(n){if("readByte"in n)return n;var t=new Gn;return t.pos=0,t.readByte=function(){return n[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=n.length},t},G1=function(n){var t=new Gn,e=!0;if(n)if(typeof n=="number")t.buffer=new Uint8Array(n),e=!1;else{if("writeByte"in n)return n;t.buffer=n,e=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(r){if(e&&this.pos>=this.buffer.length){var i=new Uint8Array(2*this.buffer.length);i.set(this.buffer),this.buffer=i}this.buffer[this.pos++]=r},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!e)throw new TypeError("outputsize does not match decoded input");var r=new Uint8Array(this.pos);r.set(this.buffer.subarray(0,this.pos)),this.buffer=r}return this.buffer},t._coerced=!0,t},oh={Bunzip:Ar,Stream:Gn,Err:pt,decode:function(n,t,e){for(var r=$s(n),i=G1(t),s=new Ar(r,i);!("eof"in r)||!r.eof();)if(s._init_block())s._read_bunzip();else{var a=s.reader.read(32)>>>0;if(a!==s.streamCRC&&Rt(pt.DATA_ERROR,"Bad stream CRC (got "+s.streamCRC.toString(16)+" expected "+a.toString(16)+")"),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,i)}if("getBuffer"in i)return i.getBuffer()},decodeBlock:function(n,t,e){var r=$s(n),i=G1(e),s=new Ar(r,i);if(s.reader.seek(t),s._get_next_block()&&(s.blockCRC=new zc,s.writeCopies=0,s._read_bunzip()),"getBuffer"in i)return i.getBuffer()},table:function(n,t,e){var r=new Gn;r.delegate=$s(n),r.pos=0,r.readByte=function(){return this.pos++,this.delegate.readByte()},r.delegate.eof&&(r.eof=r.delegate.eof.bind(r.delegate));var i=new Gn;i.pos=0,i.writeByte=function(){this.pos++};for(var s=new Ar(r,i),a=s.dbufSize;!("eof"in r)||!r.eof();){var o=8*r.pos+s.reader.bitOffset;if(s.reader.hasByte&&(o-=8),s._init_block()){var c=i.pos;s._read_bunzip(),t(o,i.pos-c)}else{if(s.reader.read(32),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,i),console.assert(s.dbufSize===a,"shouldn't change block size within multistream file")}}}},ch=G0({__proto__:null},[oh]);function Za(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let jr=Za();function Hc(n){jr=n}const Oc=/[&<>"']/,lh=new RegExp(Oc.source,"g"),Fc=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,hh=new RegExp(Fc.source,"g"),uh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},q1=n=>uh[n];function ae(n,t){if(t){if(Oc.test(n))return n.replace(lh,q1)}else if(Fc.test(n))return n.replace(hh,q1);return n}const fh=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function gh(n){return n.replace(fh,(t,e)=>(e=e.toLowerCase(),e==="colon"?":":e.charAt(0)==="#"?e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const yh=/(^|[^\[])\^/g;function at(n,t){n=typeof n=="string"?n:n.source,t=t||"";const e={replace:(r,i)=>(i=typeof i=="object"&&"source"in i?i.source:i,i=i.replace(yh,"$1"),n=n.replace(r,i),e),getRegex:()=>new RegExp(n,t)};return e}function $1(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Yi={exec:()=>null};function j1(n,t){const e=n.replace(/\|/g,(s,a,o)=>{let c=!1,h=a;for(;--h>=0&&o[h]==="\\";)c=!c;return c?"|":" |"}),r=e.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function bi(n,t,e){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===t;)i++;return n.slice(0,r-i)}function ph(n,t){if(n.indexOf(t[1])===-1)return-1;let e=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===t[0])e++;else if(n[r]===t[1]&&(e--,e<0))return r;return-1}function V1(n,t,e,r){const i=t.href,s=t.title?ae(t.title):null,a=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const o={type:"link",raw:e,href:i,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,o}return{type:"image",raw:e,href:i,title:s,text:ae(a)}}function dh(n,t){const e=n.match(/^(\s+)(?:```)/);if(e===null)return t;const r=e[1];return t.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[a]=s;return a.length>=r.length?i.slice(r.length):i}).join(`
`)}class Ji{options;rules;lexer;constructor(t){this.options=t||jr}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const r=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:bi(r,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const r=e[0],i=dh(r,e[3]||"");return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(/#$/.test(r)){const i=bi(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const r=bi(e[0].replace(/^ *>[ \t]?/gm,""),`
`),i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:e[0],tokens:s,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let r=e[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const a=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o="",c="",h=!1;for(;t;){let l=!1;if(!(e=a.exec(t))||this.rules.block.hr.test(t))break;o=e[0],t=t.substring(o.length);let u=e[2].split(`
`,1)[0].replace(/^\t+/,k=>" ".repeat(3*k.length)),g=t.split(`
`,1)[0],y=0;this.options.pedantic?(y=2,c=u.trimStart()):(y=e[2].search(/[^ ]/),y=y>4?1:y,c=u.slice(y),y+=e[1].length);let A=!1;if(!u&&/^ *$/.test(g)&&(o+=g+`
`,t=t.substring(g.length+1),l=!0),!l){const k=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),v=new RegExp(`^ {0,${Math.min(3,y-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),m=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:\`\`\`|~~~)`),E=new RegExp(`^ {0,${Math.min(3,y-1)}}#`);for(;t;){const U=t.split(`
`,1)[0];if(g=U,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),m.test(g)||E.test(g)||k.test(g)||v.test(t))break;if(g.search(/[^ ]/)>=y||!g.trim())c+=`
`+g.slice(y);else{if(A||u.search(/[^ ]/)>=4||m.test(u)||E.test(u)||v.test(u))break;c+=`
`+g}!A&&!g.trim()&&(A=!0),o+=U+`
`,t=t.substring(U.length+1),u=g.slice(y)}}s.loose||(h?s.loose=!0:/\n *\n *$/.test(o)&&(h=!0));let p=null,w;this.options.gfm&&(p=/^\[[ xX]\] /.exec(c),p&&(w=p[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:o,task:!!p,checked:w,loose:!1,text:c,tokens:[]}),s.raw+=o}s.items[s.items.length-1].raw=o.trimEnd(),s.items[s.items.length-1].text=c.trimEnd(),s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const u=s.items[l].tokens.filter(y=>y.type==="space"),g=u.length>0&&u.some(y=>/\n.*\n/.test(y.raw));s.loose=g}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(t){const e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){const e=this.rules.block.def.exec(t);if(e){const r=e[1].toLowerCase().replace(/\s+/g," "),i=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:i,title:s}}}table(t){const e=this.rules.block.table.exec(t);if(e){if(!/[:|]/.test(e[2]))return;const r={type:"table",raw:e[0],header:j1(e[1]).map(i=>({text:i,tokens:[]})),align:e[2].replace(/^\||\| *$/g,"").split("|"),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){let i=r.align.length,s,a,o,c;for(s=0;s<i;s++){const h=r.align[s];h&&(/^ *-+: *$/.test(h)?r.align[s]="right":/^ *:-+: *$/.test(h)?r.align[s]="center":/^ *:-+ *$/.test(h)?r.align[s]="left":r.align[s]=null)}for(i=r.rows.length,s=0;s<i;s++)r.rows[s]=j1(r.rows[s],r.header.length).map(h=>({text:h,tokens:[]}));for(i=r.header.length,a=0;a<i;a++)r.header[a].tokens=this.lexer.inline(r.header[a].text);for(i=r.rows.length,a=0;a<i;a++)for(c=r.rows[a],o=0;o<c.length;o++)c[o].tokens=this.lexer.inline(c[o].text);return r}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:ae(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const r=e[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=bi(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{const a=ph(e[2],"()");if(a>-1){const c=(e[0].indexOf("!")===0?5:4)+e[1].length+a;e[2]=e[2].substring(0,a),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let i=e[2],s="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);a&&(i=a[1],s=a[3])}else s=e[3]?e[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),V1(e,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let i=(r[2]||r[1]).replace(/\s+/g," ");if(i=e[i.toLowerCase()],!i){const s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return V1(r,i,r[0],this.lexer)}}emStrong(t,e,r=""){let i=this.rules.inline.emStrong.lDelim.exec(t);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const a=[...i[0]].length-1;let o,c,h=a,l=0;const u=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(u.lastIndex=0,e=e.slice(-1*t.length+a);(i=u.exec(e))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(c=[...o].length,i[3]||i[4]){h+=c;continue}else if((i[5]||i[6])&&a%3&&!((a+c)%3)){l+=c;continue}if(h-=c,h>0)continue;c=Math.min(c,c+h+l);const g=[...i[0]][0].length,y=t.slice(0,a+i.index+g+c);if(Math.min(a,c)%2){const p=y.slice(1,-1);return{type:"em",raw:y,text:p,tokens:this.lexer.inlineTokens(p)}}const A=y.slice(2,-2);return{type:"strong",raw:y,text:A,tokens:this.lexer.inlineTokens(A)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=ae(r,!0),{type:"codespan",raw:e[0],text:r}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let r,i;return e[2]==="@"?(r=ae(e[1]),i="mailto:"+r):(r=ae(e[1]),i=r),{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let r,i;if(e[2]==="@")r=ae(e[0]),i="mailto:"+r;else{let s;do s=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])[0];while(s!==e[0]);r=ae(e[0]),e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){let r;return this.lexer.state.inRawBlock?r=e[0]:r=ae(e[0]),{type:"text",raw:e[0],text:r}}}}const Z={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Yi,lheading:/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Z._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Z._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Z.def=at(Z.def).replace("label",Z._label).replace("title",Z._title).getRegex();Z.bullet=/(?:[*+-]|\d{1,9}[.)])/;Z.listItemStart=at(/^( *)(bull) */).replace("bull",Z.bullet).getRegex();Z.list=at(Z.list).replace(/bull/g,Z.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Z.def.source+")").getRegex();Z._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Z._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Z.html=at(Z.html,"i").replace("comment",Z._comment).replace("tag",Z._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Z.lheading=at(Z.lheading).replace(/bull/g,Z.bullet).getRegex();Z.paragraph=at(Z._paragraph).replace("hr",Z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Z._tag).getRegex();Z.blockquote=at(Z.blockquote).replace("paragraph",Z.paragraph).getRegex();Z.normal={...Z};Z.gfm={...Z.normal,table:"^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};Z.gfm.table=at(Z.gfm.table).replace("hr",Z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Z._tag).getRegex();Z.gfm.paragraph=at(Z._paragraph).replace("hr",Z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Z.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Z._tag).getRegex();Z.pedantic={...Z.normal,html:at(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Z._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yi,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:at(Z.normal._paragraph).replace("hr",Z.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Z.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const F={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Yi,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Yi,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};F._punctuation="\\p{P}$+<=>`^|~";F.punctuation=at(F.punctuation,"u").replace(/punctuation/g,F._punctuation).getRegex();F.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;F.anyPunctuation=/\\[punct]/g;F._escapes=/\\([punct])/g;F._comment=at(Z._comment).replace("(?:-->|$)","-->").getRegex();F.emStrong.lDelim=at(F.emStrong.lDelim,"u").replace(/punct/g,F._punctuation).getRegex();F.emStrong.rDelimAst=at(F.emStrong.rDelimAst,"gu").replace(/punct/g,F._punctuation).getRegex();F.emStrong.rDelimUnd=at(F.emStrong.rDelimUnd,"gu").replace(/punct/g,F._punctuation).getRegex();F.anyPunctuation=at(F.anyPunctuation,"gu").replace(/punct/g,F._punctuation).getRegex();F._escapes=at(F._escapes,"gu").replace(/punct/g,F._punctuation).getRegex();F._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;F._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;F.autolink=at(F.autolink).replace("scheme",F._scheme).replace("email",F._email).getRegex();F._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;F.tag=at(F.tag).replace("comment",F._comment).replace("attribute",F._attribute).getRegex();F._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;F._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;F._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;F.link=at(F.link).replace("label",F._label).replace("href",F._href).replace("title",F._title).getRegex();F.reflink=at(F.reflink).replace("label",F._label).replace("ref",Z._label).getRegex();F.nolink=at(F.nolink).replace("ref",Z._label).getRegex();F.reflinkSearch=at(F.reflinkSearch,"g").replace("reflink",F.reflink).replace("nolink",F.nolink).getRegex();F.normal={...F};F.pedantic={...F.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:at(/^!?\[(label)\]\((.*?)\)/).replace("label",F._label).getRegex(),reflink:at(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",F._label).getRegex()};F.gfm={...F.normal,escape:at(F.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};F.gfm.url=at(F.gfm.url,"i").replace("email",F.gfm._extended_email).getRegex();F.breaks={...F.gfm,br:at(F.br).replace("{2,}","*").getRegex(),text:at(F.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class De{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||jr,this.options.tokenizer=this.options.tokenizer||new Ji,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:Z.normal,inline:F.normal};this.options.pedantic?(e.block=Z.pedantic,e.inline=F.pedantic):this.options.gfm&&(e.block=Z.gfm,this.options.breaks?e.inline=F.breaks:e.inline=F.gfm),this.tokenizer.rules=e}static get rules(){return{block:Z,inline:F}}static lex(t,e){return new De(e).lex(t)}static lexInline(t,e){return new De(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let e;for(;e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(o,c,h)=>c+"    ".repeat(h.length));let r,i,s,a;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(o=>(r=o.call({lexer:this},t,e))?(t=t.substring(r.raw.length),e.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),e.push(r);continue}if(s=t,this.options.extensions&&this.options.extensions.startBlock){let o=1/0;const c=t.slice(1);let h;this.options.extensions.startBlock.forEach(l=>{h=l.call({lexer:this},c),typeof h=="number"&&h>=0&&(o=Math.min(o,h))}),o<1/0&&o>=0&&(s=t.substring(0,o+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=e[e.length-1],a&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r),a=s.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(r);continue}if(t){const o="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let r,i,s,a=t,o,c,h;if(this.tokens.links){const l=Object.keys(this.tokens.links);if(l.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)l.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,o.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(c||(h=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(l=>(r=l.call({lexer:this},t,e))?(t=t.substring(r.raw.length),e.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),i=e[e.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),i=e[e.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(r=this.tokenizer.emStrong(t,a,h)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.autolink(t)){t=t.substring(r.raw.length),e.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t))){t=t.substring(r.raw.length),e.push(r);continue}if(s=t,this.options.extensions&&this.options.extensions.startInline){let l=1/0;const u=t.slice(1);let g;this.options.extensions.startInline.forEach(y=>{g=y.call({lexer:this},u),typeof g=="number"&&g>=0&&(l=Math.min(l,g))}),l<1/0&&l>=0&&(s=t.substring(0,l+1))}if(r=this.tokenizer.inlineText(s)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(h=r.raw.slice(-1)),c=!0,i=e[e.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):e.push(r);continue}if(t){const l="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return e}}class Wi{options;constructor(t){this.options=t||jr}code(t,e,r){const i=(e||"").match(/^\S*/)?.[0];return t=t.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+ae(i)+'">'+(r?t:ae(t,!0))+`</code></pre>
`:"<pre><code>"+(r?t:ae(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,e){return t}heading(t,e,r){return`<h${e}>${t}</h${e}>
`}hr(){return`<hr>
`}list(t,e,r){const i=e?"ol":"ul",s=e&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+t+"</"+i+`>
`}listitem(t,e,r){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(t){return`<p>${t}</p>
`}table(t,e){return e&&(e=`<tbody>${e}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+e+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,e){const r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return"<br>"}del(t){return`<del>${t}</del>`}link(t,e,r){const i=$1(t);if(i===null)return r;t=i;let s='<a href="'+t+'"';return e&&(s+=' title="'+e+'"'),s+=">"+r+"</a>",s}image(t,e,r){const i=$1(t);if(i===null)return r;t=i;let s=`<img src="${t}" alt="${r}"`;return e&&(s+=` title="${e}"`),s+=">",s}text(t){return t}}class Ya{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,r){return""+r}image(t,e,r){return""+r}br(){return""}}class Qe{options;renderer;textRenderer;constructor(t){this.options=t||jr,this.options.renderer=this.options.renderer||new Wi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ya}static parse(t,e){return new Qe(e).parse(t)}static parseInline(t,e){return new Qe(e).parseInline(t)}parse(t,e=!0){let r="";for(let i=0;i<t.length;i++){const s=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=s,o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=o||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const a=s;r+=this.renderer.heading(this.parseInline(a.tokens),a.depth,gh(this.parseInline(a.tokens,this.textRenderer)));continue}case"code":{const a=s;r+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=s;let o="",c="";for(let l=0;l<a.header.length;l++)c+=this.renderer.tablecell(this.parseInline(a.header[l].tokens),{header:!0,align:a.align[l]});o+=this.renderer.tablerow(c);let h="";for(let l=0;l<a.rows.length;l++){const u=a.rows[l];c="";for(let g=0;g<u.length;g++)c+=this.renderer.tablecell(this.parseInline(u[g].tokens),{header:!1,align:a.align[g]});h+=this.renderer.tablerow(c)}r+=this.renderer.table(o,h);continue}case"blockquote":{const a=s,o=this.parse(a.tokens);r+=this.renderer.blockquote(o);continue}case"list":{const a=s,o=a.ordered,c=a.start,h=a.loose;let l="";for(let u=0;u<a.items.length;u++){const g=a.items[u],y=g.checked,A=g.task;let p="";if(g.task){const w=this.renderer.checkbox(!!y);h?g.tokens.length>0&&g.tokens[0].type==="paragraph"?(g.tokens[0].text=w+" "+g.tokens[0].text,g.tokens[0].tokens&&g.tokens[0].tokens.length>0&&g.tokens[0].tokens[0].type==="text"&&(g.tokens[0].tokens[0].text=w+" "+g.tokens[0].tokens[0].text)):g.tokens.unshift({type:"text",text:w+" "}):p+=w+" "}p+=this.parse(g.tokens,h),l+=this.renderer.listitem(p,A,!!y)}r+=this.renderer.list(l,o,c);continue}case"html":{const a=s;r+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=s;r+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=s,o=a.tokens?this.parseInline(a.tokens):a.text;for(;i+1<t.length&&t[i+1].type==="text";)a=t[++i],o+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);r+=e?this.renderer.paragraph(o):o;continue}default:{const a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(t,e){e=e||this.renderer;let r="";for(let i=0;i<t.length;i++){const s=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=a||"";continue}}switch(s.type){case"escape":{const a=s;r+=e.text(a.text);break}case"html":{const a=s;r+=e.html(a.text);break}case"link":{const a=s;r+=e.link(a.href,a.title,this.parseInline(a.tokens,e));break}case"image":{const a=s;r+=e.image(a.href,a.title,a.text);break}case"strong":{const a=s;r+=e.strong(this.parseInline(a.tokens,e));break}case"em":{const a=s;r+=e.em(this.parseInline(a.tokens,e));break}case"codespan":{const a=s;r+=e.codespan(a.text);break}case"br":{r+=e.br();break}case"del":{const a=s;r+=e.del(this.parseInline(a.tokens,e));break}case"text":{const a=s;r+=e.text(a.text);break}default:{const a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}}class Ui{options;constructor(t){this.options=t||jr}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(t){return t}postprocess(t){return t}}class Ah{defaults=Za();options=this.setOptions;parse=this.#t(De.lex,Qe.parse);parseInline=this.#t(De.lexInline,Qe.parseInline);Parser=Qe;Renderer=Wi;TextRenderer=Ya;Lexer=De;Tokenizer=Ji;Hooks=Ui;constructor(...t){this.use(...t)}walkTokens(t,e){let r=[];for(const i of t)switch(r=r.concat(e.call(this,i)),i.type){case"table":{const s=i;for(const a of s.header)r=r.concat(this.walkTokens(a.tokens,e));for(const a of s.rows)for(const o of a)r=r.concat(this.walkTokens(o.tokens,e));break}case"list":{const s=i;r=r.concat(this.walkTokens(s.items,e));break}default:{const s=i;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{r=r.concat(this.walkTokens(s[a],e))}):s.tokens&&(r=r.concat(this.walkTokens(s.tokens,e)))}}return r}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const a=e.renderers[s.name];a?e.renderers[s.name]=function(...o){let c=s.renderer.apply(this,o);return c===!1&&(c=a.apply(this,o)),c}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=e[s.level];a?a.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),i.extensions=e),r.renderer){const s=this.defaults.renderer||new Wi(this.defaults);for(const a in r.renderer){const o=r.renderer[a],c=a,h=s[c];s[c]=(...l)=>{let u=o.apply(s,l);return u===!1&&(u=h.apply(s,l)),u||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new Ji(this.defaults);for(const a in r.tokenizer){const o=r.tokenizer[a],c=a,h=s[c];s[c]=(...l)=>{let u=o.apply(s,l);return u===!1&&(u=h.apply(s,l)),u}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new Ui;for(const a in r.hooks){const o=r.hooks[a],c=a,h=s[c];Ui.passThroughHooks.has(a)?s[c]=l=>{if(this.defaults.async)return Promise.resolve(o.call(s,l)).then(g=>h.call(s,g));const u=o.call(s,l);return h.call(s,u)}:s[c]=(...l)=>{let u=o.apply(s,l);return u===!1&&(u=h.apply(s,l)),u}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,a=r.walkTokens;i.walkTokens=function(o){let c=[];return c.push(a.call(this,o)),s&&(c=c.concat(s.call(this,o))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return De.lex(t,e??this.defaults)}parser(t,e){return Qe.parse(t,e??this.defaults)}#t(t,e){return(r,i)=>{const s={...i},a={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(a.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),a.async=!0);const o=this.#e(!!a.silent,!!a.async);if(typeof r>"u"||r===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(r):r).then(c=>t(c,a)).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(o);try{a.hooks&&(r=a.hooks.preprocess(r));const c=t(r,a);a.walkTokens&&this.walkTokens(c,a.walkTokens);let h=e(c,a);return a.hooks&&(h=a.hooks.postprocess(h)),h}catch(c){return o(c)}}}#e(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+ae(r.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(r);throw r}}}const Gr=new Ah;function lt(n,t){return Gr.parse(n,t)}lt.options=lt.setOptions=function(n){return Gr.setOptions(n),lt.defaults=Gr.defaults,Hc(lt.defaults),lt};lt.getDefaults=Za;lt.defaults=jr;lt.use=function(...n){return Gr.use(...n),lt.defaults=Gr.defaults,Hc(lt.defaults),lt};lt.walkTokens=function(n,t){return Gr.walkTokens(n,t)};lt.parseInline=Gr.parseInline;lt.Parser=Qe;lt.parser=Qe.parse;lt.Renderer=Wi;lt.TextRenderer=Ya;lt.Lexer=De;lt.lexer=De.lex;lt.Tokenizer=Ji;lt.Hooks=Ui;lt.parse=lt;lt.options;lt.setOptions;lt.use;lt.walkTokens;lt.parseInline;Qe.parse;De.lex;var wh=e3('<div class="input-wrapper svelte-1nvm3d9"><input class="input svelte-1nvm3d9" id="text" required> <label class="input-label svelte-1nvm3d9" for="text"> </label></div>');function bh(n,t){let e=Hn(t,"label",8,""),r=Hn(t,"value",12,""),i=Hn(t,"type",8,"text");var s=wh(),a=Pi(s);T0(a);var o=W1(a,2),c=Pi(o,!0);Di(o),Di(s),X1(()=>{L0(a,r()),Ws(a,"type",i()),r3(c,e())}),t3("input",a,h=>r(h.target.value)),Ei(n,s)}var mh=e3('<form class="flex justify-center gap-4" style="text-align: center;"><!> <button type="submit">解密</button> <noscript></noscript></form> <pre style="text-align: center"> </pre>',1);function Bh(n,t){x0(t,!1);let e=Hn(t,"content",8),r=Hn(t,"slug",8),i=ys(!1),s=ys(),a=ys("");H0(()=>{localStorage.getItem(r())&&(en(a,localStorage.getItem(r())),en(a,window.atob(oe(a))),o())});const o=async()=>{const g=await El({armoredMessage:e()});try{const y=await kl({message:g,passwords:[oe(a)]});en(s,lt.parse(y.data)),en(i,!0),localStorage.setItem(r(),window.btoa(oe(a)))}catch(y){alert(y)}};z0();var c=lo(),h=gs(c);{var l=g=>{var y=lo(),A=gs(y);_0(A,()=>oe(s)),Ei(g,y)},u=g=>{var y=mh(),A=gs(y),p=Pi(A);bh(p,{type:"password",label:"Password",get value(){return oe(a)},set value(v){en(a,v)},$$legacy:!0}),K0(4),Di(A);var w=W1(A,2),k=Pi(w,!0);Di(w),X1(()=>r3(k,e())),t3("submit",A,N0(o)),Ei(g,y)};R0(h,g=>{oe(i)?g(l):g(u,!1)})}Ei(n,c),U0()}export{Bh as default};
